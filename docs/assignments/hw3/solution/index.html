<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.449">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Brynjólfur Gauti Guðrúnar Jónsson">
<meta name="description" content="Assigned: Friday, September 8th, 2023   Due: Friday, September 15th, 2023">

<title>STÆ529M - Homework #3 (Solution)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/quarto-contrib/downloadthis-1.9.1/downloadthis.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../assignments/hw1/solution/index.html">Solutions</a></li><li class="breadcrumb-item"><a href="../../../assignments/hw3/solution/index.html">Homework #3 (Solution)</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../assignments/hw1/solution/index.html">Solutions</a></li><li class="breadcrumb-item"><a href="../../../assignments/hw3/solution/index.html">Homework #3 (Solution)</a></li></ol></nav>
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Homework #3 (Solution)</h1>
            <p class="subtitle lead">Chapters 2.1, 2.2, 2.3 and 2.4</p>
                  <div>
        <div class="description">
          <p><strong>Assigned:</strong> Friday, September 8th, 2023 <br> <strong>Due:</strong> Friday, September 15th, 2023</p>
        </div>
      </div>
                </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://www.hi.is/staff/brynjolfur">Brynjólfur Gauti Guðrúnar Jónsson</a> <a href="mailto:brynjolfur@hi.is" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              <a href="https://english.hi.is/school_of_engineering_and_natural_sciences">
              School of Engineering and Natural Sciences, University of Iceland
              </a>
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../../">STÆ529M</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assignments/hw1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework #1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assignments/hw2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework #2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assignments/hw3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework #3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assignments/hw4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework #4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assignments/hw5/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework #5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assignments/hw6/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework #6</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assignments/hw7/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework #7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assignments/hw8/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework #8</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Solutions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assignments/hw1/solution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework #1 (Solution)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assignments/hw2/solution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework #2 (Solution)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assignments/hw3/solution/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Homework #3 (Solution)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assignments/hw4/solution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework #4 (Solution)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assignments/hw5/solution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework #5 (Solution)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assignments/hw6/solution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework #6 (Solution)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assignments/hw7/solution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework #7 (Solution)</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><a href="#dnldts35799" onclick="fetch('data:text/plain;base64,LS0tCnRpdGxlOiAiSG9tZXdvcmsgIzMgKFNvbHV0aW9uKSIKc3VidGl0bGU6IENoYXB0ZXJzIDIuMSwgMi4yLCAyLjMgYW5kIDIuNApkZXNjcmlwdGlvbjogfAogICAgKipBc3NpZ25lZDoqKiBGcmlkYXksIFNlcHRlbWJlciA4dGgsIDIwMjMgPGJyPgogICAgKipEdWU6KiogRnJpZGF5LCBTZXB0ZW1iZXIgMTV0aCwgMjAyMwphdXRob3I6IAogICAgLSAgIG5hbWU6IEJyeW5qw7NsZnVyIEdhdXRpIEd1w7Byw7puYXIgSsOzbnNzb24KICAgICAgICBlbWFpbDogYnJ5bmpvbGZ1ckBoaS5pcwogICAgICAgIHVybDogaHR0cHM6Ly93d3cuaGkuaXMvc3RhZmYvYnJ5bmpvbGZ1cgogICAgICAgIGFmZmlsaWF0aW9uOiAKICAgICAgICAtICAgbmFtZTogU2Nob29sIG9mIEVuZ2luZWVyaW5nIGFuZCBOYXR1cmFsIFNjaWVuY2VzLCBVbml2ZXJzaXR5IG9mIEljZWxhbmQKICAgICAgICAgICAgY2l0eTogUmV5a2phdsOtawogICAgICAgICAgICB1cmw6IGh0dHBzOi8vZW5nbGlzaC5oaS5pcy9zY2hvb2xfb2ZfZW5naW5lZXJpbmdfYW5kX25hdHVyYWxfc2NpZW5jZXMKIyBDaGFuZ2UgdGhpcyB0byBwZGYgaWYgeW91J2QgcmF0aGVyIHdvcmsgaW4gdGhhdCBmb3JtYXQKZm9ybWF0OiBodG1sIAplZGl0b3I6IHNvdXJjZQp0aXRsZS1ibG9jay1iYW5uZXI6IHRydWUKIyMjIyBUaGUgc2V0dGluZyBiZWxvdyBtYWtlcyBvdXIgSFRNTCBkb2N1bWVudCBzZWxmLWNvbnRhaW5lZCBzbyB0aGF0IHdlIGNhbiB0dXJuIGl0IGluICMjIyMKIyMjIyBVTkNPTU1FTlQgVEhFIExPTkUgQkVMT1cgU08gVEhBVCBZT1UgQ0FOIFRVUk4gSU4gWU9VUiBIVE1MIERPQ1VNRU5UICMjIyMjIyMjIyMjIyMjIyMjIyMKIyBlbWJlZC1yZXNvdXJjZXM6IHRydWUgCi0tLQoKe3s8IGRvd25sb2FkdGhpcyBpbmRleC5xbWQgZG5hbWU9Imh3M19zb2x1dGlvbiIgbGFiZWw9IkRvd25sb2FkIHRoZSBRdWFydG8gZG9jdW1lbnQgdXNlZCB0byByZW5kZXIgdGhpcyBmaWxlIiB0eXBlPXByaW1hcnkgY2xhc3M9ZG93bmxvYWRidXR0b24gPn19CgpgYGB7cn0KI3wgZWNobzogZmVuY2VkCiN8IG91dHB1dDogaGlkZQoKbGlicmFyeSh0aWR5cikKbGlicmFyeShkcGx5ciwgd2Fybi5jb25mbGljdHMgPSBGQUxTRSkKbGlicmFyeShnZ3Bsb3QyKQpsaWJyYXJ5KHBhdGNod29yaykKbGlicmFyeShndCkKbGlicmFyeShpbnZnYW1tYSkKdGhlbWVfc2V0KHRoZW1lX2NsYXNzaWMoKSkKYGBgCgojIENoYXB0ZXIgMi40CgojIyBFeGVyY2lzZSA2CgpBbiBhc3NlbWJseSBsaW5lIHJlbGllcyBvbiBhY2N1cmF0ZSBtZWFzdXJlbWVudHMgZnJvbSBhbiBpbWFnZS1yZWNvZ25pdGlvbiBhbGdvcml0aG0gYXQgdGhlIGZpcnN0IHN0YWdlIG9mIHRoZSBwcm9jZXNzLiBJdCBpcyBrbm93biB0aGF0IHRoZSBhbGdvcml0aG0gaXMgdW5iaWFzZWQsIHNvIGFzc3VtZSB0aGF0IG1lYXN1cmVtZW50cyBmb2xsb3cgYSBub3JtYWwgZGlzdHJpYnV0aW9uIHdpdGggbWVhbiB6ZXJvLCAKCiQkCllfaVx2ZXJ0IFxzaWdtYV4yXG92ZXJzZXR7XG1hdGhybXtpaWR9fXtcc2ltfVxtYXRocm17Tm9ybWFsfSgwLCBcc2lnbWFeMikuCiQkCgpTb21lIGVycm9ycyBhcmUgcGVybWlzc2libGUsIGJ1dCBpZiAkXHNpZ21hJCBleGNlZWRzIHRoZSB0aHJlc2hvbGQgJGMkIHRoZW4gdGhlIGFsZ29yaXRobSBtdXN0IGJlIHJlcGxhY2VkLiAKCllvdSBtYWtlICRuID0gMjAkIG1lYXN1cmVtZW50cyBhbmQgb2JzZXJ2ZSAKCiQkClxzdW1fe2k9MX1ebiBZX2kgPSAtMiBccXVhZCBcbWF0aHJte2FuZH0gXHF1YWQgXHN1bV97aT0xfV5uIFlfaV4yID0gMTUsCiQkIAoKYW5kIGNvbmR1Y3QgYSBCYXllc2lhbiBhbmFseXNpcyB3aXRoICRcbWF0aHJte0ludkdhbW1hfShhLGIpJCBwcmlvci4gY29tcHV0ZSB0aGUgcG9zdGVyaW9yIHByb2JhYmlsaXR5IHRoYXQgJFxzaWdtYSA+IGMkIGZvcjoKCmEuICRjPTEkIGFuZCAkYT1iPTAuMSQKCi0tLS0tCgoqKlNvbHV0aW9uOioqCgpPdXIgbGlrZWxpaG9vZCBpcwoKJCQKXGJlZ2lue2FsaWduZWR9CmYoXG1hdGhiZiBZXHZlcnQgXHNpZ21hXjIpICZccHJvcHRvIFxwcm9kX3tpPTF9Xm4gXGZyYWMxXHNpZ21hIFxleHBcbGVmdFstXGZyYWN7KFlfaSAtIFxtdSleMn17MlxzaWdtYV4yfVxyaWdodF0gXFwKJlxwcm9wdG8gKFxzaWdtYV4yKV57LW4vMn1cZXhwXGxlZnQoLVxmcmFje1xtYXRocm17U1NFfX17MlxzaWdtYV4yfQpccmlnaHQpLgpcZW5ke2FsaWduZWR9CiQkCgpJbiBvdXIgY2FzZSwgd2UgY2FuIHdyaXRlIG91dCBTU0UgYXMKCiQkClxiZWdpbnthbGlnbmVkfQpcbWF0aHJte1NTRX0gJj0gXHN1bV97aT0xfV5uIChZX2kgLSBcbXUpXjIgXFwKJj0gXHN1bV97aT0xfV5uIFlfaV4yIC0gMiBZX2lcbXUgKyBcbXVeMiBcXAomPSBcc3VtX3tpPTF9Xm4gWV9pXjIsIFxxdWFkXHF1YWQgXG11ID0gMC4KXGVuZHthbGlnbmVkfQokJAoKT3VyIGludmVyc2UgZ2FtbWEgcHJpb3IgaXMKCiQkClxwaShcc2lnbWFeMikgXHByb3B0byAoXHNpZ21hXjIpXnstKGErMSl9XGV4cFxsZWZ0KC0gXGZyYWN7Yn17XHNpZ21hXjJ9XHJpZ2h0KS4KJCQKCkNvbWJpbmluZyBvdXIgbGlrZWxpaG9vZCBhbmQgcHJpb3Igd2UgZ2V0IHRoZSBwb3N0ZXJpb3IKCiQkClxiZWdpbnthbGlnbmVkfQpwKFxzaWdtYV4yXHZlcnRcbWF0aGJmIFkpICZccHJvcHRvIGYoXG1hdGhiZiBZXHZlcnQgXHNpZ21hXjIpXHBpKFxzaWdtYV4yKSBcXAomXHByb3B0byAoXHNpZ21hXjIpXnstKEErMSl9XGV4cFxsZWZ0KC0gXGZyYWN7Qn17XHNpZ21hXjJ9XHJpZ2h0KSwKXGVuZHthbGlnbmVkfQokJAoKd2hlcmUgJEEgPSBuLzIgKyBhJCBhbmQgJEIgPSBcbWF0aHJte1NTRX0vMiArIGIkLCBhbmQgd2UgdGhlcmVmb3JlIHNlZSB0aGF0CgokJApcc2lnbWFeMiBcdmVydCBcbWF0aGJmIFkgXHNpbSBcbWF0aHJte0ludkdhbW1hfShBLCBCKS4KJCQKCkJ5IHVzaW5nIHRoZSByaWdodCB2YWx1ZXMgZm9yICRuJCwgU1NFLCAkYSQsICRiJCwgYW5kICRjJCB3ZSBjYW4gZWFzaWx5IHVzZSBgUmAncyBpbmJ1aWx0IGBwZ2FtbWFgIGZ1bmN0aW9uIHRvIGFuc3dlciB0aGUgcXVlc3Rpb24uIFRvIHVzZSB0aGUgYHBnYW1tYWAgZnVuY3Rpb24sIHdlIGp1c3QgbmVlZCB0byByZW1lbWJlciB0aGF0IGlmIAoKJCQKWCBcc2ltIFxtYXRocm17R2FtbWF9KFxhbHBoYSwgXGJldGEpLAokJAoKdGhlbiAKCiQkClxmcmFjMVggXHNpbSBcbWF0aHJte0ludkdhbW1hfShcYWxwaGEsIFxiZXRhKS4KJCQKClRodXMsIHNpbmNlICRcc2lnbWFeMiQgaXMgYXNzdW1lZCB0byBmb2xsb3cgYW4gaW52ZXJzZSBnYW1tYSBkaXN0cmlidXRpb24gd2UgY2FuIGFuc3dlciB0aGUgcXVlc3Rpb24gYnkgY2FsY3VsYXRpbmcKCiQkClBcbGVmdChcZnJhYzF7XHNpZ21hXjJ9IDwgXGZyYWMgMXtjXjJ9XHJpZ2h0KS4KJCQKCgpgYGB7cn0KI3wgZWNobzogZmVuY2VkCm4gPC0gMjAKU1NFIDwtIDE1CmMgPC0gMQphIDwtIDAuMQpiIDwtIDAuMQoKQSA8LSBuLzIgKyBhCkIgPC0gU1NFLzIgKyBiCgpwZ2FtbWEoMS9jXjIsIHNoYXBlID0gQSwgcmF0ZSA9IEIpCmBgYAoKV2UgY291bGQgYWxzbyB1c2UgdGhlIGBwaW52Z2FtbWFgIGZ1bmN0aW9uIGZyb20gdGhlIGBpbnZnYW1tYWAgcGFja2FnZQoKYGBge3J9CjEgLSBwaW52Z2FtbWEoY14yLCBzaGFwZSA9IEEsIHJhdGUgPSBCKQpgYGAKCmBgYHtyfQojfCBjb2RlLWZvbGQ6IHRydWUKI3wgbWVzc2FnZTogZmFsc2UKI3wgd2FybmluZzogZmFsc2UKCnBsb3Rfc29sdXRpb24gPC0gZnVuY3Rpb24oQSwgQiwgYykgewogICAgcDEgPC0gZ2dwbG90KCkgKwogICAgICAgIHN0YXRfZnVuY3Rpb24oCiAgICAgICAgICAgIGdlb20gPSAiYXJlYSIsCiAgICAgICAgICAgIGZ1biA9IGRpbnZnYW1tYSwKICAgICAgICAgICAgeGxpbSA9IGMoMCwgY14yKSwKICAgICAgICAgICAgYXJncyA9IGxpc3Qoc2hhcGUgPSBBLCByYXRlID0gQiksCiAgICAgICAgICAgIGFscGhhID0gMC40CiAgICAgICAgKSArCiAgICAgICAgc3RhdF9mdW5jdGlvbigKICAgICAgICAgICAgZ2VvbSA9ICJhcmVhIiwKICAgICAgICAgICAgZnVuID0gZGludmdhbW1hLAogICAgICAgICAgICB4bGltID0gYyhjXjIsIHFpbnZnYW1tYSgwLjk5OTk5LCBzaGFwZSA9IEEsIHJhdGUgPSBCKSksCiAgICAgICAgICAgIGFyZ3MgPSBsaXN0KHNoYXBlID0gQSwgcmF0ZSA9IEIpCiAgICAgICAgKSArCiAgICAgICAgYW5ub3RhdGUoCiAgICAgICAgICAgIGdlb20gPSAidGV4dCIsCiAgICAgICAgICAgIHggPSAxLjEgKiBjXjIgKyAwLjEsCiAgICAgICAgICAgIHkgPSBkZ2FtbWEoMS9jXjIsIHNoYXBlID0gQSwgcmF0ZSA9IEIpICsgMC4wNSwKICAgICAgICAgICAgbGFiZWwgPSBleHByZXNzaW9uKHNpZ21hXjI+Y14yKQogICAgICAgICkgKwogICAgICAgIGNvb3JkX2NhcnRlc2lhbihleHBhbmQgPSBGQUxTRSkgKwogICAgICAgIGxhYnMoCiAgICAgICAgICAgIHN1YnRpdGxlID0gIkludmVyc2UgZ2FtbWEiLAogICAgICAgICAgICB4ID0gZXhwcmVzc2lvbihzaWdtYV4yKQogICAgICAgICkKICAgIAogICAgcDIgPC0gZ2dwbG90KCkgKwogICAgICAgIHN0YXRfZnVuY3Rpb24oCiAgICAgICAgICAgIGdlb20gPSAiYXJlYSIsCiAgICAgICAgICAgIGZ1biA9IGRnYW1tYSwKICAgICAgICAgICAgeGxpbSA9IGMoMCwgMS9jXjIpLAogICAgICAgICAgICBhcmdzID0gbGlzdChzaGFwZSA9IEEsIHJhdGUgPSBCKQogICAgICAgICkgKwogICAgICAgIHN0YXRfZnVuY3Rpb24oCiAgICAgICAgICAgIGdlb20gPSAiYXJlYSIsCiAgICAgICAgICAgIGZ1biA9IGRnYW1tYSwKICAgICAgICAgICAgeGxpbSA9IGMoMS9jXjIsIHFnYW1tYSgwLjk5OTk5LCBzaGFwZSA9IEEgLCByYXRlID0gQikpLAogICAgICAgICAgICBhcmdzID0gbGlzdChzaGFwZSA9IEEsIHJhdGUgPSBCKSwKICAgICAgICAgICAgYWxwaGEgPSAwLjQKICAgICAgICApICsKICAgICAgICBhbm5vdGF0ZSgKICAgICAgICAgICAgZ2VvbSA9ICJ0ZXh0IiwKICAgICAgICAgICAgeCA9IDEvIChjXjIgKiAxLjMpIC0gMC4xLAogICAgICAgICAgICB5ID0gZGdhbW1hKDEvY14yLCBzaGFwZSA9IEEsIHJhdGUgPSBCKSArIDAuMDUsCiAgICAgICAgICAgIGxhYmVsID0gZXhwcmVzc2lvbihmcmFjKDEsc2lnbWFeMik8ZnJhYygxLGNeMikpCiAgICAgICAgKSArCiAgICAgICAgY29vcmRfY2FydGVzaWFuKGV4cGFuZCA9IEZBTFNFLCBjbGlwID0gIm9mZiIpICsKICAgICAgICBsYWJzKAogICAgICAgICAgICBzdWJ0aXRsZSA9ICJHYW1tYSIsCiAgICAgICAgICAgIHggPSBleHByZXNzaW9uKGZyYWMoMSxzaWdtYV4yKSkKICAgICAgICApCiAgICAKICAgIHAxICsgcDIgKwogICAgICAgIHBsb3RfYW5ub3RhdGlvbigKICAgICAgICAgICAgdGl0bGUgPSAiQ29tcGFyaW5nIHNvbHV0aW9ucyB1c2luZyB0aGUgR2FtbWEgb3IgSW52ZXJzZSBHYW1tYSIKICAgICAgICApICYKICAgICAgICB0aGVtZSgKICAgICAgICAgICAgYXhpcy50ZXh0LnkgPSBlbGVtZW50X2JsYW5rKCksCiAgICAgICAgICAgIGF4aXMudGlja3MueSA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICAgICAgYXhpcy50aXRsZS55ID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgICAgICBheGlzLmxpbmUueSA9IGVsZW1lbnRfYmxhbmsoKQogICAgICAgICkKICAgIAp9CgpwbG90X3NvbHV0aW9uKEEsIEIsIGMpCmBgYAoKCi0tLS0tCgpiLiAkYz0xJCBhbmQgJGE9Yj0xLjAkCgotLS0tLQoKKipTb2x1dGlvbjoqKiAKCmBgYHtyfQojfCBlY2hvOiBmZW5jZWQKbiA8LSAyMApTU0UgPC0gMTUKYyA8LSAxCmEgPC0gMQpiIDwtIDEKCkEgPC0gbi8yICsgYQpCIDwtIFNTRS8yICsgYgoKcGdhbW1hKDEvY14yLCBzaGFwZSA9IEEsIHJhdGUgPSBCKQpgYGAKCmBgYHtyfQoxIC0gcGludmdhbW1hKGNeMiwgc2hhcGUgPSBBLCByYXRlID0gQikKYGBgCgoKYGBge3J9CiN8IGNvZGUtZm9sZDogdHJ1ZQojfCBtZXNzYWdlOiBmYWxzZQojfCB3YXJuaW5nOiBmYWxzZQoKcGxvdF9zb2x1dGlvbihBLCBCLCBjKQpgYGAKCi0tLS0tCgpjLiAkYz0yJCBhbmQgJGE9Yj0wLjEkCgotLS0tLQoKKipTb2x1dGlvbjoqKgoKYGBge3J9CiN8IGVjaG86IGZlbmNlZApuIDwtIDIwClNTRSA8LSAxNQpjIDwtIDIKYSA8LSAwLjEKYiA8LSAwLjEKCkEgPC0gbi8yICsgYQpCIDwtIFNTRS8yICsgYgoKcGdhbW1hKDEvY14yLCBzaGFwZSA9IEEsIHJhdGUgPSBCKQpgYGAKCmBgYHtyfQoxIC0gcGludmdhbW1hKGNeMiwgc2hhcGUgPSBBLCByYXRlID0gQikKYGBgCgoKYGBge3J9CiN8IGNvZGUtZm9sZDogdHJ1ZQojfCBtZXNzYWdlOiBmYWxzZQojfCB3YXJuaW5nOiBmYWxzZQoKcGxvdF9zb2x1dGlvbihBLCBCLCBjKQpgYGAKCi0tLS0tCgpkLiAkYz0yJCBhbmQgJGE9Yj0xLjAkCgotLS0tLQoKKipTb2x1dGlvbjoqKgoKYGBge3J9CiN8IGVjaG86IGZlbmNlZApuIDwtIDIwClNTRSA8LSAxNQpjIDwtIDIKYSA8LSAxCmIgPC0gMQoKQSA8LSBuLzIgKyBhCkIgPC0gU1NFLzIgKyBiCgpwZ2FtbWEoMS9jXjIsIHNoYXBlID0gQSwgcmF0ZSA9IEIpCmBgYAoKYGBge3J9CjEgLSBwaW52Z2FtbWEoY14yLCBzaGFwZSA9IEEsIHJhdGUgPSBCKQpgYGAKCmBgYHtyfQojfCBjb2RlLWZvbGQ6IHRydWUKI3wgbWVzc2FnZTogZmFsc2UKI3wgd2FybmluZzogZmFsc2UKCnBsb3Rfc29sdXRpb24oQSwgQiwgYykKYGBgCgotLS0tLQoKRm9yIGVhY2ggJGMkLCBjb21wdXRlIHRoZSByYXRpbyBvZiBwcm9iYWJpbGl0aWVzIGZvciB0aGUgdHdvIHByaW9ycy4gV2hpY2gsIGlmIGFueSBvZiB0aGUgcmVzdWx0cyBhcmUgc2Vuc2l0aXZlIHRvIHRoZSBwcmlvcj8KCi0tLS0tCgoqKlNvbHV0aW9uOioqIEluIHRoZSB0YWJsZSBiZWxvdywgd2UgY29tcGFyZSB0aGUgdHdvIGNob2ljZXMgb2YgcHJpb3JzIGZvciBlYWNoIHZhbHVlIG9mICRjJC4gV2Ugc2VlIHRoYXQgdGhlIHJhdGlvbiBiZXR3ZWVuIHRoZSB0d28gcHJvYmFiaWxpdGllcyBpcyBjbG9zZSB0byAkMSQgZm9yICRjPTEkLCBzbyBpdCBpcyByZWxhdGl2ZWx5IGluc2Vuc2l0aXZlIHRvIHRoZSBwcmlvcnMuIE9uIHRoZSBvdGhlciBoYW5kIHRoZSByYXRpbyBpcyAkMC41NiQgZm9yICRjPTIkIHdoaWNoIHRlbGxzIHVzIHRoYXQgb3VyIGluZmVyZW5jZSBpcyBzZW5zaXRpdmUgdG8gdGhlIGNob2ljZSBvZiBwcmlvciBkaXN0cmlidXRpb24gd2hlbiAkYz0yJC4KCmBgYHtyfQojfCBjb2RlLWZvbGQ6IHRydWUKCmNyb3NzaW5nKAogICAgYyA9IGMoMSwgMiksCiAgICBhYiA9IGMoMC4xLCAxKQopIHw+IAogICAgbXV0YXRlKAogICAgICAgIEEgPSBuLzIgKyBhYiwKICAgICAgICBCID0gU1NFLzIgKyBhYiwKICAgICAgICBwcm9iID0gMSAtIHBpbnZnYW1tYShjXjIsIHNoYXBlID0gQSwgcmF0ZSA9IEIpCiAgICApIHw+IAogICAgc2VsZWN0KGMsIGFiLCBwcm9iKSB8PiAKICAgIHBpdm90X3dpZGVyKG5hbWVzX2Zyb20gPSBhYiwgdmFsdWVzX2Zyb20gPSBwcm9iKSB8PiAKICAgIG11dGF0ZSgKICAgICAgICByYXRpbyA9IGAxYCAvIGAwLjFgCiAgICApIHw+IAogICAgZ3QoKSB8PiAKICAgIHRhYl9zcGFubmVyKAogICAgICAgIGxhYmVsID0gIlByb2JhYmlsaXR5IGZvciBlYWNoIHByaW9yIiwKICAgICAgICBjb2x1bW5zID0gYyhgMC4xYCwgYDFgKQogICAgKSB8PiAKICAgIGNvbHNfbGFiZWwoCiAgICAgICAgYDAuMWAgPSAiYSxiPTAuMSIsCiAgICAgICAgYDFgID0gImEsYj0xIgogICAgKSB8PiAKICAgIGZtdF9udW1iZXIoCiAgICAgICAgZGVjaW1hbHMgPSA1LCByb3dzID0gMgogICAgKSB8PiAKICAgIGZtdF9udW1iZXIoCiAgICAgICAgZGVjaW1hbHMgPSAzLCByb3dzID0gMQogICAgKSB8PiAKICAgIGZtdF9udW1iZXIoZGVjaW1hbHMgPSAwLCBjb2x1bW5zID0gMSkKYGBgCgotLS0KCiMjIEV4ZXJjaXNlIDE2CgpTYXkgJFlcdmVydFxsYW1iZGEgXHNpbSBcbWF0aHJte0dhbW1hfSgxLCBcbGFtYmRhKS4kCgphLiBEZXJpdmUgYW5kIHBsb3QgdGhlIEplZmZyZXlzJyBwcmlvciBmb3IgJFxsYW1iZGEkCgotLS0tLQoKKipTb2x1dGlvbjoqKiBKZWZmcmV5cycgcHJpb3IgaXMKCiQkClxwaShcdGhldGEpIFxwcm9wdG8gXHNxcnR7SShcdGhldGEpfSwKJCQKCndoZXJlICRJKFx0aGV0YSkkIGlzIHRoZSBleHBlY3RlZCBGaXNoZXIgaW5mb3JtYXRpb24sIGRlZmluZWQgYXMKCiQkCkkoXHRoZXRhKSA9IC1FXGxlZnQoIFxmcmFje2ReMlxsb2cgZihZXHZlcnQgXHRoZXRhKX17ZFx0aGV0YV4yfVxyaWdodCkuCiQkCgpUaGUgUERGIG9mIHRoZSBHYW1tYSBkaXN0cmlidXRpb24gY2FuIGJlIHdyaXR0ZW4KCiQkCmYoeCBcdmVydCBhLCBiKSA9IFxmcmFje2JeYX17XEdhbW1hKGEpfXhee2EtMX1cZXhwXGxlZnQoLXhiXHJpZ2h0KS4KJCQKCkluIG91ciBjYXNlLCAkYT0xJCBhbmQgJGI9XGxhbWJkYSQKCiQkClxiZWdpbnthbGlnbmVkfQpmKFlcdmVydCBcbGFtYmRhKSAmPSBcZnJhY3tcbGFtYmRhXjF9e1xHYW1tYSgxKX1ZXjBcZXhwKC1cbGFtYmRhIFkpIFxcCiY9IFxsYW1iZGEgXGV4cCgtXGxhbWJkYSBZKS4KXGVuZHthbGlnbmVkfQokJAoKVGFraW5nIHRoZSBsb2cgd2UgZ2V0CgokJApcYmVnaW57YWxpZ25lZH0KbChZXHZlcnRcdGhldGEpICY9XGxvZyBmKFlcdmVydFxsYW1iZGEpIFxcCiY9IFxsb2dcbGFtYmRhIC0gXGxhbWJkYSBZIFxcClxmcmFje2RsfXtkXGxhbWJkYX0gJj0gXGZyYWMxXGxhbWJkYSAtIFkgXFwKXGZyYWN7ZGxeMn17ZFxsYW1iZGFeMn0gJj0gLVxmcmFjezF9e1xsYW1iZGFeMn0gXFwKJj0gLUkoXGxhbWJkYSkuClxlbmR7YWxpZ25lZH0KJCQKCldlIHRodXMgc2VlIHRoYXQKCiQkClxiZWdpbnthbGlnbmVkfQpccGkoXHRoZXRhKSAmPSBcc3FydHtJKFx0aGV0YSl9IFxcCiY9IFxzcXJ0e1xmcmFjezF9e1xsYW1iZGFeMn19IFxcCiY9IFxmcmFjMVxsYW1iZGEKXGVuZHthbGlnbmVkfQokJAoKYGBge3J9CmdncGxvdCgpICsKICAgIHN0YXRfZnVuY3Rpb24oCiAgICAgICAgZ2VvbSA9ICJhcmVhIiwKICAgICAgICBmdW4gPSBmdW5jdGlvbih4KSAxIC8geCwKICAgICAgICB4bGltID0gYygwLCAyMCksCiAgICAgICAgY29sID0gImJsYWNrIiwKICAgICAgICBhbHBoYSA9IDAuNQogICAgKSArCiAgICBjb29yZF9jYXJ0ZXNpYW4oZXhwYW5kID0gRkFMU0UpICsKICAgIGxhYnMoCiAgICAgICAgeCA9IGV4cHJlc3Npb24obGFtYmRhKSwKICAgICAgICB5ID0gZXhwcmVzc2lvbihwYXN0ZShwaSwgIigiLCBsYW1iZGEsICIpIikpCiAgICApCmBgYAoKCi0tLS0tCgpiLiBJcyB0aGlzIHByaW9yIHByb3Blcj8KCi0tLS0tCgoqKlNvbHV0aW9uOioqIFRoaXMgaXMgbm90IGEgcHJvcGVyIHByaW9yIHNpbmNlIGl0IGRvZXMgbm90IGludGVncmF0ZSB0byBvbmUuCgotLS0tLQoKYy4gRGVyaXZlIHRoZSBwb3N0ZXJpb3IgYW5kIGdpdmUgY29uZGl0aW9ucyBvbiAkWSQgdG8gZW5zdXJlIGl0IGlzIHByb3Blci4KCi0tLS0tCgoqKlNvbHV0aW9uOioqCgpPdXIgcG9zdGVyaW9yIGlzCgokJApcYmVnaW57YWxpZ25lZH0KcChcbGFtYmRhXHZlcnQgWSkgJj0gXGZyYWN7ZihcbWF0aGJmIHlcdmVydCBcbGFtYmRhKVxwaShcbGFtYmRhKX17XGludF8wXlxpbmZ0eSBmKFxtYXRoYmYgeVx2ZXJ0IFxsYW1iZGEpXHBpKFxsYW1iZGEpZFxsYW1iZGF9IFxcCiY9IFxmcmFje1xsYW1iZGEgXGV4cCgtXGxhbWJkYSBZKSBcY2RvdCBcZnJhYzFcbGFtYmRhfXtcaW50XzBeXGluZnR5IFxsYW1iZGEgXGV4cCgtXGxhbWJkYSBZKSBcY2RvdCBcZnJhYzFcbGFtYmRhIGRcbGFtYmRhfSBcXAomPSBcZnJhY3tcZXhwKC1cbGFtYmRhIFkpfXtcaW50XzBeXGluZnR5IFxleHAoLVxsYW1iZGEgWSkgZFxsYW1iZGF9ClxlbmR7YWxpZ25lZH0KJCQKClRoZSBpbnRlZ3JhbCBvZiAkXGV4cCgtXGxhbWJkYSBZKSQgZnJvbSAkMCQgdG8gJFxpbmZ0eSQgaXMKCiQkClxpbnRfMF5caW5mdHkgXGV4cCgtXGxhbWJkYSBZKWRcbGFtYmRhID0gIC1cZnJhYzFZIFxsZWZ0W1xleHAoLVxsYW1iZGEgWSkgXHJpZ2h0XV8wXlxpbmZ0eS4KJCQKCklmICRZPjAkLCB0aGVuIHRoaXMgYmVjb21lcyAkXGZyYWMxWSQsIGdpdmluZyB1cyB0aGUgcG9zdGVyaW9yIGRpc3RyaWJ1dGlvbgoKJCQKcChcbGFtYmRhXHZlcnQgWSkgPSBZIFxleHAoLVlcbGFtYmRhKSwKJCQKCndoaWNoIGlzIHByb3Blciwgc2luY2Ugd2UgYXNzdW1lZCB0aGF0ICRZPjAkLgoKSWYgJFkgPSAwJCwgdGhlbiBvdXIgcG9zdGVyaW9yIGRpc3RyaWJ1dGlvbiB3aWxsIG5vdCBpbnRlZ3JhdGUgdG8gb25lIGFuZCB0aHVzIHdpbGwgbm90IGJlIHByb3Blci4gV2UgdGhlcmVmb3JlIHJlcXVpcmUgdGhhdCAkWSA+IDAkLiBMdWNraWx5ICRZPTAkIHdpdGggcHJvYmFiaWxpdHkgMCBhcyBZIGlzIGEgY29udGludW91cyB2YXJpYWJsZS4KCi0tLS0tCgojIyBFeGVyY2lzZSAxOAoKVGhlIGRhdGEgaW4gdGhlIHRhYmxlIGJlbG93IGFyZSB0aGUgcmVzdWx0IG9mIGEgc3VydmV5IG9mIGNvbW11dGVycyBpbiAxMCBjb3VudGllcyBsaWtlbHkgdG8gYmUgYWZmZWN0ZWQgYnkgYSBwcm9wb3NlZCBhZGRpdGlvbiBvZiBhIGhpZ2ggb2NjdXBhbmN5IHZlaGljbGUgKEhPVikgbGFuZS4KCmBgYHtyfQpkIDwtIHRyaWJibGUoCiAgICB+Q291bnR5LCB+QXBwcm92ZSwgfkRpc2FwcHJvdmUsCiAgICAxLCAxMiwgNTAsCiAgICAyLCA5MCwgMTUwLAogICAgMywgODAsIDYzLAogICAgNCwgNSwgMTAsCiAgICA1LCA2MywgNjMsCiAgICA2LCAxNSwgOCwKICAgIDcsIDY3LCA1NiwKICAgIDgsIDIyLCAxOSwKICAgIDksIDU2LCA2MywKICAgIDEwLCAzMywgMTkKKQoKZCB8PiAKICAgIGd0KCkKYGBgCgphLiBBbmFseXplIHRoZSBkYXRhIGluIGVhY2ggY291bnR5IHNlcGFyYXRlbHkgdXNpbmcgdGhlIEplZmZyZXlzJyBwcmlvciBkaXN0cmlidXRpb24gYW5kIHJlcG9ydCB0aGUgcG9zdGVyaW9yIDk1JSBjcmVkaWJsZSBzZXQgZm9yIGVhY2ggY291bnR5LgoKLS0tLS0KCioqU29sdXRpb246KiogV2UgYXNzdW1lIHRoZSBkYXRhIGZvbGxvdyBhIGJpbm9taWFsIGRpc3RyaWJ1dGlvbgoKJCQKZihZXHZlcnQgcCkgPSBcYmlub217Tn17WX1wXlkoMS1wKV57Ti1ZfS4KJCQKClRvIGRlcml2ZSBKZWZmcmV5cycgcHJpb3Igd2UgZmlyc3QgZmluZCB0aGUgZXhwZWN0ZWQgRmlzaGVyIGluZm9ybWF0aW9uCgokJApcYmVnaW57YWxpZ25lZH0KbChZXHZlcnQgcCkgJj0gXGxvZyBmKFlcdmVydCBwKSBcXAomPSBcbG9nXGJpbm9te059e1l9ICsgWVxsb2cgcCArIChOIC0gWSlcbG9nKDEgLSBwKSBcXApcZnJhY3tkbH17ZHB9ICY9IFxmcmFjIFlwICsgXGZyYWN7Ti1ZfXsxLXB9IFxcClxmcmFje2RsXjJ9e2RwXjJ9ICY9IC1cZnJhY3tZfXtwXjJ9IC0gXGZyYWN7TiAtIFl9eygxIC0gcCleMn0uClxlbmR7YWxpZ25lZH0KJCQKClRoZSBleHBlY3RlZCB2YWx1ZSBvZiAkWSQgaXMgJE5wJCBhbmQgdGhlIGV4cGVjdGVkIHZhbHVlIG9mICROIC0gWSQgaXMgJE4gLSBOcCQuCgokJApcYmVnaW57YWxpZ25lZH0KSShwKSAmPSBcZnJhY3tOcH17cF4yfSArIFxmcmFje04gLSBOcH17KDEgLSBwKV4yfSBcXAomPSBcZnJhY3tOfXtwfSArIFxmcmFje059ezEgLSBwfSBcXAomPSBcZnJhY3tOfXtwKDEgLSBwKX0uClxlbmR7YWxpZ25lZH0KJCQKCkplZmZyZXlzJyBwcmlvciBpcyB0aGVyZWZvcmUKCiQkClxwaShwKSBccHJvcHRvIFxzcXJ0e1xmcmFje259e3AoMSAtIHApfX0gXHByb3B0byBwXnsxLzItMX0oMS1wKV57MS8yLTF9LAokJAoKd2hpY2ggaXMgdGhlIGtlcm5lbCBvZiBhICRcbWF0aHJte0JldGF9KDAuNSwgMC41KSQgUERGLiBXZSBjYW4gdGh1cyBzZWUgdGhhdCBKZWZmcmV5cycgcHJpb3IgZm9yIGEgYmlub21pYWwgcHJvcG9ydGlvbiBpcyBhICRcbWF0aHJte0JldGF9KDAuNSwgMC41KSQgZGlzdHJpYnV0aW9uLCBhbmQgdGhlIHBvc3RlcmlvciB3aWxsIGJlIGEgJFxtYXRocm17QmV0YX0oMC41ICsgWSwgMC41ICsgKE4gLSBZKSkkIGRpc3RyaWJ1dGlvbi4KCmBgYHtyfQojfCBlY2hvOiBmZW5jZWQKamVmZnJleXNfcmVzdWx0cyA8LSBkIHw+IAogICAgbXV0YXRlKAogICAgICAgIEEgPSBBcHByb3ZlICsgMC41LAogICAgICAgIEIgPSBEaXNhcHByb3ZlICsgMC41LAogICAgICAgIExvd2VyID0gcWJldGEoMC4wMjUsIEEsIEIpLAogICAgICAgIFVwcGVyID0gcWJldGEoMC45NzUsIEEsIEIpCiAgICApIAoKamVmZnJleXNfcmVzdWx0cyB8PiAKICAgIGd0KCkgfD4gCiAgICBjb2xzX2hpZGUoCiAgICAgICAgY29sdW1ucyA9IGMoQXBwcm92ZSwgRGlzYXBwcm92ZSwgQSwgQikKICAgICkgfD4gCiAgICB0YWJfc3Bhbm5lcigKICAgICAgICBsYWJlbCA9ICI5NSUgQ3JlZGlibGUgSW50ZXJ2YWwiLCAKICAgICAgICBjb2x1bW5zID0gYyhMb3dlciwgVXBwZXIpCiAgICApIHw+IAogICAgZm10X3BlcmNlbnQoCiAgICAgICAgY29sdW1ucyA9IGMoTG93ZXIsIFVwcGVyKQogICAgKQpgYGAKCgotLS0tLQoKYi4gTGV0ICRcaGF0IHBfaSQgYmUgdGhlIHNhbXBsZSBwcm9wb3J0aW9uIG9mIGNvbW11dGVycyBpbiBjb3VudHkgJGkkIHRoYXQgYXBwcm92ZSBvZiB0aGUgSElWIGxhbmUgKGUuZy4gJFxoYXQgcF8xID0gMTIvKDEyKzUwKT0wLjE5NCQpLiBTZWxlY3QgJGEkIGFiZCAkYiQgc28gdGhhdCB0aGUgbWVhbiBhbmQgdmFyaWFuY2Ugb2YgdGhlICRcbWF0aHJte0JldGF9KGEsYikkIGRpc3RyaWJ1dGlvbiBtYXRjaCB0aGUgbWVhbiBhbmQgdmFyaWFuY2Ugb2YgdGhlIHNhbXBsZSBwcm9wb3J0aW9ucyAkXGhhdCBwXzEsIFxkb3RzLCBcaGF0IHBfezEwfSQuCgotLS0tLQoKKipTb2x1dGlvbjoqKgoKYGBge3J9CmQgfD4gCiAgICBtdXRhdGUoCiAgICAgICAgcCA9IEFwcHJvdmUgLyAoQXBwcm92ZSArIERpc2FwcHJvdmUpCiAgICApIHw+IAogICAgc3VtbWFyaXNlKAogICAgICAgIG1lYW4gPSBtZWFuKHApLAogICAgICAgIHZhciA9IHZhcihwKQogICAgKSB8PiAKICAgIGd0KCkgfD4gCiAgICBjb2xzX2xhYmVsKAogICAgICAgIG1lYW4gPSAiTWVhbiIsCiAgICAgICAgdmFyID0gIlZhcmlhbmNlIgogICAgKQpgYGAKClNvIHdlIHdhbnQgdGhlIGZvbGxvd2luZyB0byBiZSBhcHByb3hpbWF0ZWx5IHRydWUKCiQkClxmcmFje1xhbHBoYX17XGFscGhhICsgXGJldGF9ID0gMC40OCBccXF1YWQgXGZyYWN7XGFscGhhXGJldGF9eyhcYWxwaGEgKyBcYmV0YSleMihcYWxwaGEgKyBcYmV0YSArIDEpfSA9MC4wMgokJAoKV2UgY2FuIHNvbHZlIHRoaXMgc2ltcGx5IGJ5IGNyZWF0aW5nIGEgdGFyZ2V0IGZ1bmN0aW9uIGFuZCB1c2luZyBgUmAncyBidWlsdC1pbiBgb3B0aW1gIGZ1bmN0aW9uCgpgYGB7cn0KI3wgZWNobzogZmVuY2VkCm15X2Z1biA8LSBmdW5jdGlvbihwYXJzKSB7CiAgICAKICAgIGFscGhhIDwtIHBhcnNbMV0KICAgIGJldGEgPC0gcGFyc1syXQogICAgCiAgICAjIENhbGN1bGF0ZSBkaWZmZXJlbmNlIGJldHdlZW4gY3VycmVudCBtZWFuIGFuZCBkZXNpcmVkIG1lYW4KICAgIGRpZmZfbWVhbiA8LSBhbHBoYSAvIChhbHBoYSArIGJldGEpIC0gMC40OAogICAgCiAgICAjIENhbGN1bGF0ZSBkaWZmZXJlbmNlIGJldHdlZW4gY3VycmVudCB2YXJpYW5jZSBhbmQgZGVzaXJlZCB2YXJpYW5jZQogICAgZGlmZl92YXIgPC0gKGFscGhhICogYmV0YSkgLyAoKGFscGhhICsgYmV0YSleMiAqIChhbHBoYSArIGJldGEgKyAxKSkgLSAwLjAyCiAgICAKICAgICMgUmV0dXJuIHRoZSBzcXVhcmVkIGRpZmZlcmVuY2VzIG9mIGJvdGgKICAgIGRpZmZfbWVhbl4yICsgZGlmZl92YXJeMgp9CgpyZXN1bHRzIDwtIG9wdGltKGMoMSwgMSksIGZuID0gbXlfZnVuKQoKYWxwaGEgPC0gcmVzdWx0cyRwYXJbMV0KYmV0YSA8LSByZXN1bHRzJHBhclsyXQoKYWxwaGEKYmV0YQpgYGAKCi0tLS0tCgpjLiBDb25kdWN0IGFuIGVtcGlyaWNhbCBCYXllc2lhbiBhbmFseXNpcyBieSBjb21wdXRpbmcgdGhlIDk1JSBwb3N0ZXJpb3IgY3JlZGlibGUgc2V0cyB0aGF0IHJlc3VsdHMgZnJvbSBhbmFseXppbmcgZWFjaCBjb3VudHkgc2VwYXJhdGVseSB1c2luZyB0aGUgJFxtYXRocm17QmV0YX0oYSxiKSQgcHJpb3IgeW91IGNvbXB1dGVkIGluICpiLioKCi0tLS0tCgoqKlNvbHV0aW9uOioqCgpgYGB7cn0KI3wgZWNobzogZmVuY2VkCmVtcF9iYXllc19yZXN1bHRzIDwtIGQgfD4gCiAgICBtdXRhdGUoCiAgICAgICAgQSA9IEFwcHJvdmUgKyBhbHBoYSwKICAgICAgICBCID0gRGlzYXBwcm92ZSArIGJldGEsCiAgICAgICAgTG93ZXIgPSBxYmV0YSgwLjAyNSwgQSwgQiksCiAgICAgICAgVXBwZXIgPSBxYmV0YSgwLjk3NSwgQSwgQikKICAgICkgCgplbXBfYmF5ZXNfcmVzdWx0cyB8PiAKICAgIGd0KCkgfD4gCiAgICBjb2xzX2hpZGUoCiAgICAgICAgY29sdW1ucyA9IGMoQXBwcm92ZSwgRGlzYXBwcm92ZSwgQSwgQikKICAgICkgfD4gCiAgICB0YWJfc3Bhbm5lcigKICAgICAgICBsYWJlbCA9ICI5NSUgQ3JlZGlibGUgSW50ZXJ2YWwiLCAKICAgICAgICBjb2x1bW5zID0gYyhMb3dlciwgVXBwZXIpCiAgICApIHw+IAogICAgZm10X3BlcmNlbnQoCiAgICAgICAgY29sdW1ucyA9IGMoTG93ZXIsIFVwcGVyKQogICAgKQpgYGAKCi0tLS0tCgpkLiBIb3cgZG8gdGhlIHJlc3VsdHMgZnJvbSAqYS4qIGFuZCAqYy4qIGRpZmZlcj8gV2hhdCBhcmUgdGhlIGFkdmFudGFnZXMgYW5kIGRpc2FkdmFudGFnZXMgb2YgdGhlc2UgdHdvIGFuYWx5c2VzPwoKCi0tLS0tCgoqKlNvbHV0aW9uOioqIFRoZSBFbXBpcmljYWwgQmF5ZXMgKEVCKSBwcmlvciBwdWxscyBlYWNoIGluZGl2aWR1YWwgcHJvcG9ydGlvbiBzbGlnaHRseSB0b3dhcmRzIHRoZSBvdmVyYWxsIG1lYW4uIFNpbmNlIGVhY2ggY291bnR5IGdldHMgdGhlIHNhbWUgRUIgcHJpb3IgdGhlIGVmZmVjdCBpcyB0aGF0IGNvdW50aWVzIHdpdGggZmV3ZXIgdm90ZXMgZ2V0IHB1bGxlZCBtb3JlIHRvd2FyZHMgdGhlIG92ZXJhbGwgbWVhbiwgdGh1cyBzdGFiaWxpemluZyB0aGUgaW5mZXJlbmNlcyBpbiBzbWFsbGVyIGNvdW50aWVzIGJ5ICoiYm9ycm93aW5nIiogaW5mb3JtYXRpb24gZnJvbSBvdGhlciBjb3VudGllcy4gCgpUaGUgZG93bnNpZGUgdG8gdXNpbmcgdGhlIEVCIHByaW9yIGlzIHRoYXQgdGhlIGluZmVyZW5jZSBmb3IgZWFjaCBjb3VudHkgaXMgc2xpZ2h0bHkgYmlhc2VkIHRvIHdhcmRzIHRoZSBvdmVyYWxsIG1lYW4uIAoKVGhpcyBpcyBhbiBleGFtcGxlIG9mIHRoZSBiaWFzL3ZhcmlhbmNlIHRyYWRlLW9mZiBpbiBzdGF0aXN0aWNzLiBXZSBvZnRlbiB3YW50IHRvIHJlZHVjZSB0aGUgdmFyaWFuY2UgaW4gb3VyIHN0YXRpc3RpY2FsIGluZmVyZW5jZSBhdCB0aGUgY29zdCBvZiBpbmNyZWFzaW5nIHRoZSBiaWFzIGluIG91ciBpbmZlcmVuY2VzLgoKYGBge3J9CiN8IGVjaG86IGZlbmNlZAojfCBjb2RlLWZvbGQ6IHRydWUKCgplbXBfYmF5ZXNfcmVzdWx0cyB8PiAKICAgIG11dGF0ZSgKICAgICAgICB0eXBlID0gIkVtcGlyaWNhbCBCYXllcyIKICAgICkgfD4gCiAgICBiaW5kX3Jvd3MoCiAgICAgICAgamVmZnJleXNfcmVzdWx0cyB8PiAKICAgICAgICAgICAgbXV0YXRlKAogICAgICAgICAgICAgICAgdHlwZSA9ICJKZWZmcmV5cyIKICAgICAgICAgICAgKQogICAgKSB8PiAKICAgIGdncGxvdChhZXMoeCA9IENvdW50eSwgeW1pbiA9IExvd2VyLCB5bWF4ID0gVXBwZXIsIGNvbCA9IHR5cGUpKSArCiAgICBnZW9tX2hsaW5lKAogICAgICAgIHlpbnRlcmNlcHQgPSAwLjQ4LAogICAgICAgIGx0eSA9IDIsCiAgICAgICAgbGluZXdpZHRoID0gMC41CiAgICApICsKICAgIGdlb21fbGluZXJhbmdlKAogICAgICAgIGxpbmV3aWR0aCA9IDEsCiAgICAgICAgcG9zaXRpb24gPSBwb3NpdGlvbl9kb2RnZSh3aWR0aCA9IDAuMykKICAgICAgICApICsKICAgIHNjYWxlX3hfY29udGludW91cygKICAgICAgICBicmVha3MgPSAxOjEwCiAgICApICsKICAgIHNjYWxlX3lfY29udGludW91cygKICAgICAgICBsaW1pdHMgPSBjKDAsIDEpLAogICAgICAgIGxhYmVscyA9IHNjYWxlczo6bGFiZWxfcGVyY2VudCgpLAogICAgICAgIGV4cGFuZCA9IGV4cGFuc2lvbigpCiAgICApICsKICAgIGFubm90YXRlKAogICAgICAgIGdlb20gPSAidGV4dCIsCiAgICAgICAgeCA9IDEuNSwKICAgICAgICB5ID0gMC41MSwKICAgICAgICBsYWJlbCA9ICJPdmVyYWxsIE1lYW4iCiAgICApICsKICAgIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9IGMoMC4xNSwgMC45KSkgKwogICAgbGFicygKICAgICAgICB4ID0gIkNvdW50eSIsCiAgICAgICAgeSA9IGV4cHJlc3Npb24oaGF0KHApKSwKICAgICAgICBjb2wgPSBOVUxMLAogICAgICAgIHRpdGxlID0gIkNvbXBhcmluZyB0aGUgSmVmZnJleXMgYW5kIEVtcGlyaWNhbCBCYXllcyBpbnRlcnZhbHMiLAogICAgICAgIHN1YnRpdGxlID0gIkVtcGlyaWNhbCBCYXllcyBwdWxscyB0aGUgaW50ZXJ2YWxscyBzbGlnaHRseSB0b3dhcmRzIHRoZSBvdmVyYWxsIG1lYW4iCiAgICApCmBgYAoKLS0tLS0KCg==').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'hw3_solution.qmd'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
        });"><button class="btn btn-primary downloadthis  downloadbutton" id="dnldts35799"><i class="bi bi-download"></i> Download the Quarto document used to render this file </button></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: hide</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyr)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr, warn.conflicts = FALSE)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="in">library(patchwork)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="in">library(gt)</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="in">library(invgamma)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="in">theme_set(theme_classic())</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="chapter-2.4" class="level1">
<h1>Chapter 2.4</h1>
<section id="exercise-6" class="level2">
<h2 class="anchored" data-anchor-id="exercise-6">Exercise 6</h2>
<p>An assembly line relies on accurate measurements from an image-recognition algorithm at the first stage of the process. It is known that the algorithm is unbiased, so assume that measurements follow a normal distribution with mean zero,</p>
<p><span class="math display">\[
Y_i\vert \sigma^2\overset{\mathrm{iid}}{\sim}\mathrm{Normal}(0, \sigma^2).
\]</span></p>
<p>Some errors are permissible, but if <span class="math inline">\(\sigma\)</span> exceeds the threshold <span class="math inline">\(c\)</span> then the algorithm must be replaced.</p>
<p>You make <span class="math inline">\(n = 20\)</span> measurements and observe</p>
<p><span class="math display">\[
\sum_{i=1}^n Y_i = -2 \quad \mathrm{and} \quad \sum_{i=1}^n Y_i^2 = 15,
\]</span></p>
<p>and conduct a Bayesian analysis with <span class="math inline">\(\mathrm{InvGamma}(a,b)\)</span> prior. compute the posterior probability that <span class="math inline">\(\sigma &gt; c\)</span> for:</p>
<ol type="a">
<li><span class="math inline">\(c=1\)</span> and <span class="math inline">\(a=b=0.1\)</span></li>
</ol>
<hr>
<p><strong>Solution:</strong></p>
<p>Our likelihood is</p>
<p><span class="math display">\[
\begin{aligned}
f(\mathbf Y\vert \sigma^2) &amp;\propto \prod_{i=1}^n \frac1\sigma \exp\left[-\frac{(Y_i - \mu)^2}{2\sigma^2}\right] \\
&amp;\propto (\sigma^2)^{-n/2}\exp\left(-\frac{\mathrm{SSE}}{2\sigma^2}
\right).
\end{aligned}
\]</span></p>
<p>In our case, we can write out SSE as</p>
<p><span class="math display">\[
\begin{aligned}
\mathrm{SSE} &amp;= \sum_{i=1}^n (Y_i - \mu)^2 \\
&amp;= \sum_{i=1}^n Y_i^2 - 2 Y_i\mu + \mu^2 \\
&amp;= \sum_{i=1}^n Y_i^2, \quad\quad \mu = 0.
\end{aligned}
\]</span></p>
<p>Our inverse gamma prior is</p>
<p><span class="math display">\[
\pi(\sigma^2) \propto (\sigma^2)^{-(a+1)}\exp\left(- \frac{b}{\sigma^2}\right).
\]</span></p>
<p>Combining our likelihood and prior we get the posterior</p>
<p><span class="math display">\[
\begin{aligned}
p(\sigma^2\vert\mathbf Y) &amp;\propto f(\mathbf Y\vert \sigma^2)\pi(\sigma^2) \\
&amp;\propto (\sigma^2)^{-(A+1)}\exp\left(- \frac{B}{\sigma^2}\right),
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(A = n/2 + a\)</span> and <span class="math inline">\(B = \mathrm{SSE}/2 + b\)</span>, and we therefore see that</p>
<p><span class="math display">\[
\sigma^2 \vert \mathbf Y \sim \mathrm{InvGamma}(A, B).
\]</span></p>
<p>By using the right values for <span class="math inline">\(n\)</span>, SSE, <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(c\)</span> we can easily use <code>R</code>’s inbuilt <code>pgamma</code> function to answer the question. To use the <code>pgamma</code> function, we just need to remember that if</p>
<p><span class="math display">\[
X \sim \mathrm{Gamma}(\alpha, \beta),
\]</span></p>
<p>then</p>
<p><span class="math display">\[
\frac1X \sim \mathrm{InvGamma}(\alpha, \beta).
\]</span></p>
<p>Thus, since <span class="math inline">\(\sigma^2\)</span> is assumed to follow an inverse gamma distribution we can answer the question by calculating</p>
<p><span class="math display">\[
P\left(\frac1{\sigma^2} &lt; \frac 1{c^2}\right).
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="in">n &lt;- 20</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="in">SSE &lt;- 15</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="in">c &lt;- 1</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="in">a &lt;- 0.1</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="in">b &lt;- 0.1</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="in">A &lt;- n/2 + a</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="in">B &lt;- SSE/2 + b</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="in">pgamma(1/c^2, shape = A, rate = B)</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2249838</code></pre>
</div>
</div>
<p>We could also use the <code>pinvgamma</code> function from the <code>invgamma</code> package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pinvgamma</span>(c<span class="sc">^</span><span class="dv">2</span>, <span class="at">shape =</span> A, <span class="at">rate =</span> B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2249838</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>plot_solution <span class="ot">&lt;-</span> <span class="cf">function</span>(A, B, c) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_function</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom =</span> <span class="st">"area"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">fun =</span> dinvgamma,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, c<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> A, <span class="at">rate =</span> B),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_function</span>(</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom =</span> <span class="st">"area"</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">fun =</span> dinvgamma,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlim =</span> <span class="fu">c</span>(c<span class="sc">^</span><span class="dv">2</span>, <span class="fu">qinvgamma</span>(<span class="fl">0.99999</span>, <span class="at">shape =</span> A, <span class="at">rate =</span> B)),</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> A, <span class="at">rate =</span> B)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">annotate</span>(</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="fl">1.1</span> <span class="sc">*</span> c<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.1</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> <span class="fu">dgamma</span>(<span class="dv">1</span><span class="sc">/</span>c<span class="sc">^</span><span class="dv">2</span>, <span class="at">shape =</span> A, <span class="at">rate =</span> B) <span class="sc">+</span> <span class="fl">0.05</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="fu">expression</span>(sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">&gt;</span>c<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">subtitle =</span> <span class="st">"Inverse gamma"</span>,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="fu">expression</span>(sigma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_function</span>(</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom =</span> <span class="st">"area"</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">fun =</span> dgamma,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span>c<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> A, <span class="at">rate =</span> B)</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_function</span>(</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom =</span> <span class="st">"area"</span>,</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">fun =</span> dgamma,</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span>c<span class="sc">^</span><span class="dv">2</span>, <span class="fu">qgamma</span>(<span class="fl">0.99999</span>, <span class="at">shape =</span> A , <span class="at">rate =</span> B)),</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> A, <span class="at">rate =</span> B),</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>        <span class="fu">annotate</span>(</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="dv">1</span><span class="sc">/</span> (c<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fl">1.3</span>) <span class="sc">-</span> <span class="fl">0.1</span>,</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> <span class="fu">dgamma</span>(<span class="dv">1</span><span class="sc">/</span>c<span class="sc">^</span><span class="dv">2</span>, <span class="at">shape =</span> A, <span class="at">rate =</span> B) <span class="sc">+</span> <span class="fl">0.05</span>,</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">frac</span>(<span class="dv">1</span>,sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">&lt;</span><span class="fu">frac</span>(<span class="dv">1</span>,c<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>, <span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>            <span class="at">subtitle =</span> <span class="st">"Gamma"</span>,</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">frac</span>(<span class="dv">1</span>,sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>    p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot_annotation</span>(</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">"Comparing solutions using the Gamma or Inverse Gamma"</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">&amp;</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.line.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_solution</span>(A, B, c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<ol start="2" type="a">
<li><span class="math inline">\(c=1\)</span> and <span class="math inline">\(a=b=1.0\)</span></li>
</ol>
<hr>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="in">n &lt;- 20</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="in">SSE &lt;- 15</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="in">c &lt;- 1</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="in">a &lt;- 1</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="in">b &lt;- 1</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="in">A &lt;- n/2 + a</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="in">B &lt;- SSE/2 + b</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="in">pgamma(1/c^2, shape = A, rate = B)</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.236638</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pinvgamma</span>(c<span class="sc">^</span><span class="dv">2</span>, <span class="at">shape =</span> A, <span class="at">rate =</span> B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.236638</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_solution</span>(A, B, c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<ol start="3" type="a">
<li><span class="math inline">\(c=2\)</span> and <span class="math inline">\(a=b=0.1\)</span></li>
</ol>
<hr>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="in">n &lt;- 20</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="in">SSE &lt;- 15</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="in">c &lt;- 2</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="in">a &lt;- 0.1</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="in">b &lt;- 0.1</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="in">A &lt;- n/2 + a</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="in">B &lt;- SSE/2 + b</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="in">pgamma(1/c^2, shape = A, rate = B)</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.560058e-05</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pinvgamma</span>(c<span class="sc">^</span><span class="dv">2</span>, <span class="at">shape =</span> A, <span class="at">rate =</span> B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.560058e-05</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_solution</span>(A, B, c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<ol start="4" type="a">
<li><span class="math inline">\(c=2\)</span> and <span class="math inline">\(a=b=1.0\)</span></li>
</ol>
<hr>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="in">n &lt;- 20</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="in">SSE &lt;- 15</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="in">c &lt;- 2</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="in">a &lt;- 1</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="in">b &lt;- 1</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="in">A &lt;- n/2 + a</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="in">B &lt;- SSE/2 + b</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="in">pgamma(1/c^2, shape = A, rate = B)</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.44581e-05</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pinvgamma</span>(c<span class="sc">^</span><span class="dv">2</span>, <span class="at">shape =</span> A, <span class="at">rate =</span> B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.44581e-05</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_solution</span>(A, B, c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<p>For each <span class="math inline">\(c\)</span>, compute the ratio of probabilities for the two priors. Which, if any of the results are sensitive to the prior?</p>
<hr>
<p><strong>Solution:</strong> In the table below, we compare the two choices of priors for each value of <span class="math inline">\(c\)</span>. We see that the ration between the two probabilities is close to <span class="math inline">\(1\)</span> for <span class="math inline">\(c=1\)</span>, so it is relatively insensitive to the priors. On the other hand the ratio is <span class="math inline">\(0.56\)</span> for <span class="math inline">\(c=2\)</span> which tells us that our inference is sensitive to the choice of prior distribution when <span class="math inline">\(c=2\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">c =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ab =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">A =</span> n<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> ab,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">B =</span> SSE<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> ab,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">prob =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pinvgamma</span>(c<span class="sc">^</span><span class="dv">2</span>, <span class="at">shape =</span> A, <span class="at">rate =</span> B)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(c, ab, prob) <span class="sc">|&gt;</span> </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> ab, <span class="at">values_from =</span> prob) <span class="sc">|&gt;</span> </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">ratio =</span> <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="sc">/</span> <span class="st">`</span><span class="at">0.1</span><span class="st">`</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Probability for each prior"</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">0.1</span><span class="st">`</span>, <span class="st">`</span><span class="at">1</span><span class="st">`</span>)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_label</span>(</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">0.1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"a,b=0.1"</span>,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"a,b=1"</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">decimals =</span> <span class="dv">5</span>, <span class="at">rows =</span> <span class="dv">2</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">decimals =</span> <span class="dv">3</span>, <span class="at">rows =</span> <span class="dv">1</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">0</span>, <span class="at">columns =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tywivibahr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tywivibahr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tywivibahr thead, #tywivibahr tbody, #tywivibahr tfoot, #tywivibahr tr, #tywivibahr td, #tywivibahr th {
  border-style: none;
}

#tywivibahr p {
  margin: 0;
  padding: 0;
}

#tywivibahr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tywivibahr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tywivibahr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tywivibahr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tywivibahr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tywivibahr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tywivibahr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tywivibahr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tywivibahr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tywivibahr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tywivibahr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tywivibahr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tywivibahr .gt_spanner_row {
  border-bottom-style: hidden;
}

#tywivibahr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tywivibahr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tywivibahr .gt_from_md > :first-child {
  margin-top: 0;
}

#tywivibahr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tywivibahr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tywivibahr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tywivibahr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tywivibahr .gt_row_group_first td {
  border-top-width: 2px;
}

#tywivibahr .gt_row_group_first th {
  border-top-width: 2px;
}

#tywivibahr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tywivibahr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tywivibahr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tywivibahr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tywivibahr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tywivibahr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tywivibahr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tywivibahr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tywivibahr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tywivibahr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tywivibahr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tywivibahr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tywivibahr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tywivibahr .gt_left {
  text-align: left;
}

#tywivibahr .gt_center {
  text-align: center;
}

#tywivibahr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tywivibahr .gt_font_normal {
  font-weight: normal;
}

#tywivibahr .gt_font_bold {
  font-weight: bold;
}

#tywivibahr .gt_font_italic {
  font-style: italic;
}

#tywivibahr .gt_super {
  font-size: 65%;
}

#tywivibahr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tywivibahr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tywivibahr .gt_indent_1 {
  text-indent: 5px;
}

#tywivibahr .gt_indent_2 {
  text-indent: 10px;
}

#tywivibahr .gt_indent_3 {
  text-indent: 15px;
}

#tywivibahr .gt_indent_4 {
  text-indent: 20px;
}

#tywivibahr .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" id="c" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">c</th>
<th colspan="2" id="Probability for each prior" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">Probability for each prior</span></th>
<th rowspan="2" id="ratio" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">ratio</th>
</tr>
<tr class="odd gt_col_headings">
<th id="a,b=0.1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">a,b=0.1</th>
<th id="a,b=1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">a,b=1</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="c">1</td>
<td class="gt_row gt_right" headers="0.1">0.225</td>
<td class="gt_row gt_right" headers="1">0.237</td>
<td class="gt_row gt_right" headers="ratio">1.052</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="c">2</td>
<td class="gt_row gt_right" headers="0.1">0.00003</td>
<td class="gt_row gt_right" headers="1">0.00001</td>
<td class="gt_row gt_right" headers="ratio">0.56476</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
</section>
<section id="exercise-16" class="level2">
<h2 class="anchored" data-anchor-id="exercise-16">Exercise 16</h2>
<p>Say <span class="math inline">\(Y\vert\lambda \sim \mathrm{Gamma}(1, \lambda).\)</span></p>
<ol type="a">
<li>Derive and plot the Jeffreys’ prior for <span class="math inline">\(\lambda\)</span></li>
</ol>
<hr>
<p><strong>Solution:</strong> Jeffreys’ prior is</p>
<p><span class="math display">\[
\pi(\theta) \propto \sqrt{I(\theta)},
\]</span></p>
<p>where <span class="math inline">\(I(\theta)\)</span> is the expected Fisher information, defined as</p>
<p><span class="math display">\[
I(\theta) = -E\left( \frac{d^2\log f(Y\vert \theta)}{d\theta^2}\right).
\]</span></p>
<p>The PDF of the Gamma distribution can be written</p>
<p><span class="math display">\[
f(x \vert a, b) = \frac{b^a}{\Gamma(a)}x^{a-1}\exp\left(-xb\right).
\]</span></p>
<p>In our case, <span class="math inline">\(a=1\)</span> and <span class="math inline">\(b=\lambda\)</span></p>
<p><span class="math display">\[
\begin{aligned}
f(Y\vert \lambda) &amp;= \frac{\lambda^1}{\Gamma(1)}Y^0\exp(-\lambda Y) \\
&amp;= \lambda \exp(-\lambda Y).
\end{aligned}
\]</span></p>
<p>Taking the log we get</p>
<p><span class="math display">\[
\begin{aligned}
l(Y\vert\theta) &amp;=\log f(Y\vert\lambda) \\
&amp;= \log\lambda - \lambda Y \\
\frac{dl}{d\lambda} &amp;= \frac1\lambda - Y \\
\frac{dl^2}{d\lambda^2} &amp;= -\frac{1}{\lambda^2} \\
&amp;= -I(\lambda).
\end{aligned}
\]</span></p>
<p>We thus see that</p>
<p><span class="math display">\[
\begin{aligned}
\pi(\theta) &amp;= \sqrt{I(\theta)} \\
&amp;= \sqrt{\frac{1}{\lambda^2}} \\
&amp;= \frac1\lambda
\end{aligned}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">geom =</span> <span class="st">"area"</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun =</span> <span class="cf">function</span>(x) <span class="dv">1</span> <span class="sc">/</span> x,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">expression</span>(lambda),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(pi, <span class="st">"("</span>, lambda, <span class="st">")"</span>))</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<ol start="2" type="a">
<li>Is this prior proper?</li>
</ol>
<hr>
<p><strong>Solution:</strong> This is not a proper prior since it does not integrate to one.</p>
<hr>
<ol start="3" type="a">
<li>Derive the posterior and give conditions on <span class="math inline">\(Y\)</span> to ensure it is proper.</li>
</ol>
<hr>
<p><strong>Solution:</strong></p>
<p>Our posterior is</p>
<p><span class="math display">\[
\begin{aligned}
p(\lambda\vert Y) &amp;= \frac{f(\mathbf y\vert \lambda)\pi(\lambda)}{\int_0^\infty f(\mathbf y\vert \lambda)\pi(\lambda)d\lambda} \\
&amp;= \frac{\lambda \exp(-\lambda Y) \cdot \frac1\lambda}{\int_0^\infty \lambda \exp(-\lambda Y) \cdot \frac1\lambda d\lambda} \\
&amp;= \frac{\exp(-\lambda Y)}{\int_0^\infty \exp(-\lambda Y) d\lambda}
\end{aligned}
\]</span></p>
<p>The integral of <span class="math inline">\(\exp(-\lambda Y)\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(\infty\)</span> is</p>
<p><span class="math display">\[
\int_0^\infty \exp(-\lambda Y)d\lambda =  -\frac1Y \left[\exp(-\lambda Y) \right]_0^\infty.
\]</span></p>
<p>If <span class="math inline">\(Y&gt;0\)</span>, then this becomes <span class="math inline">\(\frac1Y\)</span>, giving us the posterior distribution</p>
<p><span class="math display">\[
p(\lambda\vert Y) = Y \exp(-Y\lambda),
\]</span></p>
<p>which is proper, since we assumed that <span class="math inline">\(Y&gt;0\)</span>.</p>
<p>If <span class="math inline">\(Y = 0\)</span>, then our posterior distribution will not integrate to one and thus will not be proper. We therefore require that <span class="math inline">\(Y &gt; 0\)</span>. Luckily <span class="math inline">\(Y=0\)</span> with probability 0 as Y is a continuous variable.</p>
<hr>
</section>
<section id="exercise-18" class="level2">
<h2 class="anchored" data-anchor-id="exercise-18">Exercise 18</h2>
<p>The data in the table below are the result of a survey of commuters in 10 counties likely to be affected by a proposed addition of a high occupancy vehicle (HOV) lane.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>County, <span class="sc">~</span>Approve, <span class="sc">~</span>Disapprove,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">12</span>, <span class="dv">50</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>, <span class="dv">90</span>, <span class="dv">150</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>, <span class="dv">80</span>, <span class="dv">63</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">10</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>, <span class="dv">63</span>, <span class="dv">63</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>, <span class="dv">15</span>, <span class="dv">8</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>, <span class="dv">67</span>, <span class="dv">56</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">8</span>, <span class="dv">22</span>, <span class="dv">19</span>,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">9</span>, <span class="dv">56</span>, <span class="dv">63</span>,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span>, <span class="dv">33</span>, <span class="dv">19</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="sgbfqngxal" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#sgbfqngxal table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sgbfqngxal thead, #sgbfqngxal tbody, #sgbfqngxal tfoot, #sgbfqngxal tr, #sgbfqngxal td, #sgbfqngxal th {
  border-style: none;
}

#sgbfqngxal p {
  margin: 0;
  padding: 0;
}

#sgbfqngxal .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sgbfqngxal .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sgbfqngxal .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sgbfqngxal .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sgbfqngxal .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sgbfqngxal .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sgbfqngxal .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sgbfqngxal .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sgbfqngxal .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sgbfqngxal .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sgbfqngxal .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sgbfqngxal .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sgbfqngxal .gt_spanner_row {
  border-bottom-style: hidden;
}

#sgbfqngxal .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sgbfqngxal .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sgbfqngxal .gt_from_md > :first-child {
  margin-top: 0;
}

#sgbfqngxal .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sgbfqngxal .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sgbfqngxal .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sgbfqngxal .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sgbfqngxal .gt_row_group_first td {
  border-top-width: 2px;
}

#sgbfqngxal .gt_row_group_first th {
  border-top-width: 2px;
}

#sgbfqngxal .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sgbfqngxal .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sgbfqngxal .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sgbfqngxal .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sgbfqngxal .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sgbfqngxal .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sgbfqngxal .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sgbfqngxal .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sgbfqngxal .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sgbfqngxal .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sgbfqngxal .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sgbfqngxal .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sgbfqngxal .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sgbfqngxal .gt_left {
  text-align: left;
}

#sgbfqngxal .gt_center {
  text-align: center;
}

#sgbfqngxal .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sgbfqngxal .gt_font_normal {
  font-weight: normal;
}

#sgbfqngxal .gt_font_bold {
  font-weight: bold;
}

#sgbfqngxal .gt_font_italic {
  font-style: italic;
}

#sgbfqngxal .gt_super {
  font-size: 65%;
}

#sgbfqngxal .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sgbfqngxal .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sgbfqngxal .gt_indent_1 {
  text-indent: 5px;
}

#sgbfqngxal .gt_indent_2 {
  text-indent: 10px;
}

#sgbfqngxal .gt_indent_3 {
  text-indent: 15px;
}

#sgbfqngxal .gt_indent_4 {
  text-indent: 20px;
}

#sgbfqngxal .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="County" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">County</th>
<th id="Approve" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Approve</th>
<th id="Disapprove" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Disapprove</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="County">1</td>
<td class="gt_row gt_right" headers="Approve">12</td>
<td class="gt_row gt_right" headers="Disapprove">50</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="County">2</td>
<td class="gt_row gt_right" headers="Approve">90</td>
<td class="gt_row gt_right" headers="Disapprove">150</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="County">3</td>
<td class="gt_row gt_right" headers="Approve">80</td>
<td class="gt_row gt_right" headers="Disapprove">63</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="County">4</td>
<td class="gt_row gt_right" headers="Approve">5</td>
<td class="gt_row gt_right" headers="Disapprove">10</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="County">5</td>
<td class="gt_row gt_right" headers="Approve">63</td>
<td class="gt_row gt_right" headers="Disapprove">63</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="County">6</td>
<td class="gt_row gt_right" headers="Approve">15</td>
<td class="gt_row gt_right" headers="Disapprove">8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="County">7</td>
<td class="gt_row gt_right" headers="Approve">67</td>
<td class="gt_row gt_right" headers="Disapprove">56</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="County">8</td>
<td class="gt_row gt_right" headers="Approve">22</td>
<td class="gt_row gt_right" headers="Disapprove">19</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="County">9</td>
<td class="gt_row gt_right" headers="Approve">56</td>
<td class="gt_row gt_right" headers="Disapprove">63</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="County">10</td>
<td class="gt_row gt_right" headers="Approve">33</td>
<td class="gt_row gt_right" headers="Disapprove">19</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ol type="a">
<li>Analyze the data in each county separately using the Jeffreys’ prior distribution and report the posterior 95% credible set for each county.</li>
</ol>
<hr>
<p><strong>Solution:</strong> We assume the data follow a binomial distribution</p>
<p><span class="math display">\[
f(Y\vert p) = \binom{N}{Y}p^Y(1-p)^{N-Y}.
\]</span></p>
<p>To derive Jeffreys’ prior we first find the expected Fisher information</p>
<p><span class="math display">\[
\begin{aligned}
l(Y\vert p) &amp;= \log f(Y\vert p) \\
&amp;= \log\binom{N}{Y} + Y\log p + (N - Y)\log(1 - p) \\
\frac{dl}{dp} &amp;= \frac Yp + \frac{N-Y}{1-p} \\
\frac{dl^2}{dp^2} &amp;= -\frac{Y}{p^2} - \frac{N - Y}{(1 - p)^2}.
\end{aligned}
\]</span></p>
<p>The expected value of <span class="math inline">\(Y\)</span> is <span class="math inline">\(Np\)</span> and the expected value of <span class="math inline">\(N - Y\)</span> is <span class="math inline">\(N - Np\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
I(p) &amp;= \frac{Np}{p^2} + \frac{N - Np}{(1 - p)^2} \\
&amp;= \frac{N}{p} + \frac{N}{1 - p} \\
&amp;= \frac{N}{p(1 - p)}.
\end{aligned}
\]</span></p>
<p>Jeffreys’ prior is therefore</p>
<p><span class="math display">\[
\pi(p) \propto \sqrt{\frac{n}{p(1 - p)}} \propto p^{1/2-1}(1-p)^{1/2-1},
\]</span></p>
<p>which is the kernel of a <span class="math inline">\(\mathrm{Beta}(0.5, 0.5)\)</span> PDF. We can thus see that Jeffreys’ prior for a binomial proportion is a <span class="math inline">\(\mathrm{Beta}(0.5, 0.5)\)</span> distribution, and the posterior will be a <span class="math inline">\(\mathrm{Beta}(0.5 + Y, 0.5 + (N - Y))\)</span> distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="in">jeffreys_results &lt;- d |&gt; </span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="in">        A = Approve + 0.5,</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="in">        B = Disapprove + 0.5,</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="in">        Lower = qbeta(0.025, A, B),</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="in">        Upper = qbeta(0.975, A, B)</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="in">    ) </span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="in">jeffreys_results |&gt; </span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="in">    gt() |&gt; </span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="in">    cols_hide(</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="in">        columns = c(Approve, Disapprove, A, B)</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="in">    ) |&gt; </span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="in">    tab_spanner(</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="in">        label = "95% Credible Interval", </span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="in">        columns = c(Lower, Upper)</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="in">    ) |&gt; </span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="in">    fmt_percent(</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="in">        columns = c(Lower, Upper)</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="uspklzfimr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uspklzfimr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#uspklzfimr thead, #uspklzfimr tbody, #uspklzfimr tfoot, #uspklzfimr tr, #uspklzfimr td, #uspklzfimr th {
  border-style: none;
}

#uspklzfimr p {
  margin: 0;
  padding: 0;
}

#uspklzfimr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uspklzfimr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#uspklzfimr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uspklzfimr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uspklzfimr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uspklzfimr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uspklzfimr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uspklzfimr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uspklzfimr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uspklzfimr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uspklzfimr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uspklzfimr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uspklzfimr .gt_spanner_row {
  border-bottom-style: hidden;
}

#uspklzfimr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#uspklzfimr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uspklzfimr .gt_from_md > :first-child {
  margin-top: 0;
}

#uspklzfimr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uspklzfimr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uspklzfimr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#uspklzfimr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uspklzfimr .gt_row_group_first td {
  border-top-width: 2px;
}

#uspklzfimr .gt_row_group_first th {
  border-top-width: 2px;
}

#uspklzfimr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uspklzfimr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uspklzfimr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uspklzfimr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uspklzfimr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uspklzfimr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uspklzfimr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#uspklzfimr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uspklzfimr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uspklzfimr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uspklzfimr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uspklzfimr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uspklzfimr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uspklzfimr .gt_left {
  text-align: left;
}

#uspklzfimr .gt_center {
  text-align: center;
}

#uspklzfimr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uspklzfimr .gt_font_normal {
  font-weight: normal;
}

#uspklzfimr .gt_font_bold {
  font-weight: bold;
}

#uspklzfimr .gt_font_italic {
  font-style: italic;
}

#uspklzfimr .gt_super {
  font-size: 65%;
}

#uspklzfimr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#uspklzfimr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uspklzfimr .gt_indent_1 {
  text-indent: 5px;
}

#uspklzfimr .gt_indent_2 {
  text-indent: 10px;
}

#uspklzfimr .gt_indent_3 {
  text-indent: 15px;
}

#uspklzfimr .gt_indent_4 {
  text-indent: 20px;
}

#uspklzfimr .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" id="County" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">County</th>
<th colspan="2" id="95% Credible Interval" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">95% Credible Interval</span></th>
</tr>
<tr class="odd gt_col_headings">
<th id="Lower" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Lower</th>
<th id="Upper" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Upper</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="County">1</td>
<td class="gt_row gt_right" headers="Lower">11.04%</td>
<td class="gt_row gt_right" headers="Upper">30.45%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="County">2</td>
<td class="gt_row gt_right" headers="Lower">31.55%</td>
<td class="gt_row gt_right" headers="Upper">43.74%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="County">3</td>
<td class="gt_row gt_right" headers="Lower">47.76%</td>
<td class="gt_row gt_right" headers="Upper">63.89%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="County">4</td>
<td class="gt_row gt_right" headers="Lower">14.03%</td>
<td class="gt_row gt_right" headers="Upper">58.42%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="County">5</td>
<td class="gt_row gt_right" headers="Lower">41.35%</td>
<td class="gt_row gt_right" headers="Upper">58.65%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="County">6</td>
<td class="gt_row gt_right" headers="Lower">44.89%</td>
<td class="gt_row gt_right" headers="Upper">81.98%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="County">7</td>
<td class="gt_row gt_right" headers="Lower">45.65%</td>
<td class="gt_row gt_right" headers="Upper">63.08%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="County">8</td>
<td class="gt_row gt_right" headers="Lower">38.58%</td>
<td class="gt_row gt_right" headers="Upper">68.24%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="County">9</td>
<td class="gt_row gt_right" headers="Lower">38.25%</td>
<td class="gt_row gt_right" headers="Upper">56.01%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="County">10</td>
<td class="gt_row gt_right" headers="Lower">49.93%</td>
<td class="gt_row gt_right" headers="Upper">75.54%</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
<ol start="2" type="a">
<li>Let <span class="math inline">\(\hat p_i\)</span> be the sample proportion of commuters in county <span class="math inline">\(i\)</span> that approve of the HIV lane (e.g.&nbsp;<span class="math inline">\(\hat p_1 = 12/(12+50)=0.194\)</span>). Select <span class="math inline">\(a\)</span> abd <span class="math inline">\(b\)</span> so that the mean and variance of the <span class="math inline">\(\mathrm{Beta}(a,b)\)</span> distribution match the mean and variance of the sample proportions <span class="math inline">\(\hat p_1, \dots, \hat p_{10}\)</span>.</li>
</ol>
<hr>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">p =</span> Approve <span class="sc">/</span> (Approve <span class="sc">+</span> Disapprove)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean =</span> <span class="fu">mean</span>(p),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">var =</span> <span class="fu">var</span>(p)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_label</span>(</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean =</span> <span class="st">"Mean"</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">var =</span> <span class="st">"Variance"</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="gkgnzwtomd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gkgnzwtomd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gkgnzwtomd thead, #gkgnzwtomd tbody, #gkgnzwtomd tfoot, #gkgnzwtomd tr, #gkgnzwtomd td, #gkgnzwtomd th {
  border-style: none;
}

#gkgnzwtomd p {
  margin: 0;
  padding: 0;
}

#gkgnzwtomd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gkgnzwtomd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gkgnzwtomd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gkgnzwtomd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gkgnzwtomd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gkgnzwtomd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gkgnzwtomd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gkgnzwtomd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gkgnzwtomd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gkgnzwtomd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gkgnzwtomd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gkgnzwtomd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gkgnzwtomd .gt_spanner_row {
  border-bottom-style: hidden;
}

#gkgnzwtomd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gkgnzwtomd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gkgnzwtomd .gt_from_md > :first-child {
  margin-top: 0;
}

#gkgnzwtomd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gkgnzwtomd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gkgnzwtomd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gkgnzwtomd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gkgnzwtomd .gt_row_group_first td {
  border-top-width: 2px;
}

#gkgnzwtomd .gt_row_group_first th {
  border-top-width: 2px;
}

#gkgnzwtomd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gkgnzwtomd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gkgnzwtomd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gkgnzwtomd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gkgnzwtomd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gkgnzwtomd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gkgnzwtomd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gkgnzwtomd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gkgnzwtomd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gkgnzwtomd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gkgnzwtomd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gkgnzwtomd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gkgnzwtomd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gkgnzwtomd .gt_left {
  text-align: left;
}

#gkgnzwtomd .gt_center {
  text-align: center;
}

#gkgnzwtomd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gkgnzwtomd .gt_font_normal {
  font-weight: normal;
}

#gkgnzwtomd .gt_font_bold {
  font-weight: bold;
}

#gkgnzwtomd .gt_font_italic {
  font-style: italic;
}

#gkgnzwtomd .gt_super {
  font-size: 65%;
}

#gkgnzwtomd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gkgnzwtomd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gkgnzwtomd .gt_indent_1 {
  text-indent: 5px;
}

#gkgnzwtomd .gt_indent_2 {
  text-indent: 10px;
}

#gkgnzwtomd .gt_indent_3 {
  text-indent: 15px;
}

#gkgnzwtomd .gt_indent_4 {
  text-indent: 20px;
}

#gkgnzwtomd .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mean</th>
<th id="Variance" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Variance</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="mean">0.4800001</td>
<td class="gt_row gt_right" headers="var">0.02025887</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>So we want the following to be approximately true</p>
<p><span class="math display">\[
\frac{\alpha}{\alpha + \beta} = 0.48 \qquad \frac{\alpha\beta}{(\alpha + \beta)^2(\alpha + \beta + 1)} =0.02
\]</span></p>
<p>We can solve this simply by creating a target function and using <code>R</code>’s built-in <code>optim</code> function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="in">my_fun &lt;- function(pars) {</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha &lt;- pars[1]</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="in">    beta &lt;- pars[2]</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="in">    # Calculate difference between current mean and desired mean</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="in">    diff_mean &lt;- alpha / (alpha + beta) - 0.48</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="in">    # Calculate difference between current variance and desired variance</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="in">    diff_var &lt;- (alpha * beta) / ((alpha + beta)^2 * (alpha + beta + 1)) - 0.02</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="in">    # Return the squared differences of both</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="in">    diff_mean^2 + diff_var^2</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="in">results &lt;- optim(c(1, 1), fn = my_fun)</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="in">alpha &lt;- results$par[1]</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="in">beta &lt;- results$par[2]</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="in">alpha</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="in">beta</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.51061
[1] 5.96976</code></pre>
</div>
</div>
<hr>
<ol start="3" type="a">
<li>Conduct an empirical Bayesian analysis by computing the 95% posterior credible sets that results from analyzing each county separately using the <span class="math inline">\(\mathrm{Beta}(a,b)\)</span> prior you computed in <em>b.</em></li>
</ol>
<hr>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="in">emp_bayes_results &lt;- d |&gt; </span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="in">        A = Approve + alpha,</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="in">        B = Disapprove + beta,</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="in">        Lower = qbeta(0.025, A, B),</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="in">        Upper = qbeta(0.975, A, B)</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="in">    ) </span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="in">emp_bayes_results |&gt; </span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="in">    gt() |&gt; </span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="in">    cols_hide(</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="in">        columns = c(Approve, Disapprove, A, B)</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="in">    ) |&gt; </span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="in">    tab_spanner(</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="in">        label = "95% Credible Interval", </span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="in">        columns = c(Lower, Upper)</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="in">    ) |&gt; </span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="in">    fmt_percent(</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="in">        columns = c(Lower, Upper)</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tjmcmtsmld" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tjmcmtsmld table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tjmcmtsmld thead, #tjmcmtsmld tbody, #tjmcmtsmld tfoot, #tjmcmtsmld tr, #tjmcmtsmld td, #tjmcmtsmld th {
  border-style: none;
}

#tjmcmtsmld p {
  margin: 0;
  padding: 0;
}

#tjmcmtsmld .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tjmcmtsmld .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tjmcmtsmld .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tjmcmtsmld .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tjmcmtsmld .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tjmcmtsmld .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tjmcmtsmld .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tjmcmtsmld .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tjmcmtsmld .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tjmcmtsmld .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tjmcmtsmld .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tjmcmtsmld .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tjmcmtsmld .gt_spanner_row {
  border-bottom-style: hidden;
}

#tjmcmtsmld .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tjmcmtsmld .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tjmcmtsmld .gt_from_md > :first-child {
  margin-top: 0;
}

#tjmcmtsmld .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tjmcmtsmld .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tjmcmtsmld .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tjmcmtsmld .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tjmcmtsmld .gt_row_group_first td {
  border-top-width: 2px;
}

#tjmcmtsmld .gt_row_group_first th {
  border-top-width: 2px;
}

#tjmcmtsmld .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tjmcmtsmld .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tjmcmtsmld .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tjmcmtsmld .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tjmcmtsmld .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tjmcmtsmld .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tjmcmtsmld .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tjmcmtsmld .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tjmcmtsmld .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tjmcmtsmld .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tjmcmtsmld .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tjmcmtsmld .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tjmcmtsmld .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tjmcmtsmld .gt_left {
  text-align: left;
}

#tjmcmtsmld .gt_center {
  text-align: center;
}

#tjmcmtsmld .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tjmcmtsmld .gt_font_normal {
  font-weight: normal;
}

#tjmcmtsmld .gt_font_bold {
  font-weight: bold;
}

#tjmcmtsmld .gt_font_italic {
  font-style: italic;
}

#tjmcmtsmld .gt_super {
  font-size: 65%;
}

#tjmcmtsmld .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tjmcmtsmld .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tjmcmtsmld .gt_indent_1 {
  text-indent: 5px;
}

#tjmcmtsmld .gt_indent_2 {
  text-indent: 10px;
}

#tjmcmtsmld .gt_indent_3 {
  text-indent: 15px;
}

#tjmcmtsmld .gt_indent_4 {
  text-indent: 20px;
}

#tjmcmtsmld .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" id="County" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">County</th>
<th colspan="2" id="95% Credible Interval" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">95% Credible Interval</span></th>
</tr>
<tr class="odd gt_col_headings">
<th id="Lower" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Lower</th>
<th id="Upper" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Upper</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="County">1</td>
<td class="gt_row gt_right" headers="Lower">14.87%</td>
<td class="gt_row gt_right" headers="Upper">34.13%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="County">2</td>
<td class="gt_row gt_right" headers="Lower">32.09%</td>
<td class="gt_row gt_right" headers="Upper">44.05%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="County">3</td>
<td class="gt_row gt_right" headers="Lower">47.48%</td>
<td class="gt_row gt_right" headers="Upper">63.09%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="County">4</td>
<td class="gt_row gt_right" headers="Lower">22.30%</td>
<td class="gt_row gt_right" headers="Upper">58.56%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="County">5</td>
<td class="gt_row gt_right" headers="Lower">41.52%</td>
<td class="gt_row gt_right" headers="Upper">58.15%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="County">6</td>
<td class="gt_row gt_right" headers="Lower">42.92%</td>
<td class="gt_row gt_right" headers="Upper">75.01%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="County">7</td>
<td class="gt_row gt_right" headers="Lower">45.48%</td>
<td class="gt_row gt_right" headers="Upper">62.24%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="County">8</td>
<td class="gt_row gt_right" headers="Lower">39.00%</td>
<td class="gt_row gt_right" headers="Upper">65.66%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="County">9</td>
<td class="gt_row gt_right" headers="Lower">38.66%</td>
<td class="gt_row gt_right" headers="Upper">55.70%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="County">10</td>
<td class="gt_row gt_right" headers="Lower">48.47%</td>
<td class="gt_row gt_right" headers="Upper">72.23%</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
<ol start="4" type="a">
<li>How do the results from <em>a.</em> and <em>c.</em> differ? What are the advantages and disadvantages of these two analyses?</li>
</ol>
<hr>
<p><strong>Solution:</strong> The Empirical Bayes (EB) prior pulls each individual proportion slightly towards the overall mean. Since each county gets the same EB prior the effect is that counties with fewer votes get pulled more towards the overall mean, thus stabilizing the inferences in smaller counties by <em>“borrowing”</em> information from other counties.</p>
<p>The downside to using the EB prior is that the inference for each county is slightly biased to wards the overall mean.</p>
<p>This is an example of the bias/variance trade-off in statistics. We often want to reduce the variance in our statistical inference at the cost of increasing the bias in our inferences.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="in">emp_bayes_results |&gt; </span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="in">        type = "Empirical Bayes"</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="in">    ) |&gt; </span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="in">    bind_rows(</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="in">        jeffreys_results |&gt; </span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="in">            mutate(</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="in">                type = "Jeffreys"</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="in">            )</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="in">    ) |&gt; </span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = County, ymin = Lower, ymax = Upper, col = type)) +</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_hline(</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="in">        yintercept = 0.48,</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="in">        lty = 2,</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="in">        linewidth = 0.5</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_linerange(</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="in">        linewidth = 1,</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="in">        position = position_dodge(width = 0.3)</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="in">        ) +</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_x_continuous(</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="in">        breaks = 1:10</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="in">        limits = c(0, 1),</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="in">        labels = scales::label_percent(),</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a><span class="in">        expand = expansion()</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="in">    annotate(</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a><span class="in">        geom = "text",</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a><span class="in">        x = 1.5,</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a><span class="in">        y = 0.51,</span></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a><span class="in">        label = "Overall Mean"</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(legend.position = c(0.15, 0.9)) +</span></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a><span class="in">        x = "County",</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a><span class="in">        y = expression(hat(p)),</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a><span class="in">        col = NULL,</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a><span class="in">        title = "Comparing the Jeffreys and Empirical Bayes intervals",</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a><span class="in">        subtitle = "Empirical Bayes pulls the intervalls slightly towards the overall mean"</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>