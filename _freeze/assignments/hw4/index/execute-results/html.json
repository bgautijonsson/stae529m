{
  "hash": "4963262c94959ccce3b4052801d9d670",
  "result": {
    "markdown": "---\ntitle: \"Homework #4\"\nsubtitle: \"Exercises from Chapter 3.5: 2, 4, 5 and 10\"\ndescription: |\n    **Assigned:** Friday, September 15th, 2023 <br>\n    **Due:** Friday, September 29th, 2023\nauthor: \n    -   name: Brynjólfur Gauti Guðrúnar Jónsson\n        email: brynjolfur@hi.is\n        url: https://www.hi.is/staff/brynjolfur\n        affiliation: \n        -   name: School of Engineering and Natural Sciences, University of Iceland\n            city: Reykjavík\n            url: https://english.hi.is/school_of_engineering_and_natural_sciences\n# Change this to pdf if you'd rather work in that format\nformat: html \neditor: source\ntheme: flatly\ntitle-block-banner: true\n# The setting below makes our HTML document self-contained so that we can turn it in\nembed-resources: true \n---\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| output: hide\n\nlibrary(tidyr)\nlibrary(dplyr, warn.conflicts = FALSE)\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(invgamma)\ntheme_set(theme_classic())\n```\n````\n:::\n\n\n# 2\n\nAssume that $Y_i\\vert\\mu\\overset{\\mathrm{indep}}{\\sim} \\mathrm{Normal}(\\mu,\\sigma_i^2)$ for $i \\in \\{1, \\dots, n\\}$, with $\\sigma_i$ known and improper prior distribution $\\pi(\\mu)=1$ for all $\\mu$.\n\na. Give a formula for the MAP estimator for $\\mu$\n\n-----\n\n**Solution:**\n\n-----\n\nb. We observe $n=3, Y_1=12, Y_2=10, Y_3=22, \\sigma_2=\\sigma_2=3$ and $\\sigma_3=10$, compute the MAP estimate of $\\mu$.\n\n-----\n\n**Solution:**\n\n-----\n\nc. Use numerical integration to compute the posterior mean of $\\mu$.\n\n-----\n\n**Solution:**\n\n-----\n\nd. Plot the posterior distribution of $\\mu$ and indicate the MAP and the posterior mean estimates on the plot.\n\n-----\n\n**Solution:**\n\n-----\n\n# 4\n\nConsider the model \n\n$$\nY_i\\vert\\mu\\overset{\\mathrm{indep}}{\\sim} \\mathrm{Normal}(\\mu,\\sigma_i^2),\n$$ \n\nfor $i \\in \\{1, \\dots, n\\}$ where \n\n$$\n\\sigma_i^2\\vert b \\sim \\mathrm{InvGamma}(a,b) \\\\ b\\sim\\mathrm{Gamma}(1,1)\n$$\n\na. Derive the full conditional posterior distributions for $\\sigma^2_2$ and $b$.\n\n-----\n\n**Solution:**\n\n-----\n\nb. Write pseudocode for Gibbs sampling, i.e. describe in detail each step of the Gibbs sampling algorithm.\n\n-----\n\n**Solution:**\n\n-----\n\nc. Write your own Gibbs sampling code (not in `JAGS`) and plot the marginal posterior density of each parameter. Assume $n=10$, $a=10$ and $Y_i=i$ for $i=1, \\dots, 10$.\n\n-----\n\n**Solution:**\n\n-----\n\nd. Repeat the analysis with $a=1$ and comment on the convergence of the MCMC chain.\n\n-----\n\n**Solution:**\n\n-----\n\n# 5\n\nConsider the model\n\n$$\nY_i\\vert\\mu, \\sigma^2 \\sim \\mathrm{Normal}(\\mu,\\sigma^2),\\quad i=1,\\dots,n,\n$$\n\nand\n\n$$\nY_i\\vert\\mu,\\delta, \\sigma^2 \\sim \\mathrm{Normal}(\\mu+\\delta,\\sigma^2),\\quad i=n+1,\\dots,n+m,\n$$\n\nwhere\n\n$$\n\\mu,\\delta\\sim\\mathrm{Normal}(0, 100^2) \\\\\n\\sigma^2\\sim\\mathrm{InvGamma}(0.01, 0.01).\n$$\n\na. Give an example of a real experiment for which this would be an appropriate model.\n\n-----\n\n**Solution:**\n\n-----\n\nb. Derive the full conditional posterior distributions for $\\mu$, $\\delta$, and $\\sigma^2$.\n\n-----\n\n**Solution:**\n\n-----\n\nc. Simulate a dataset from this model with $n=m=50$, $\\mu=10$, $\\delta=1$ and $\\sigma=2$. Write your own Gibbs sampling code (not in `JAGS`) to fit the model above to the simulated data and plot the marginal posterior density for each parameter. Are you able to recover the true values reasonably well?\n\n-----\n\n**Solution:**\n\n-----\n\nd. Implement this model using `JAGS` and compare the results with the results in **.c**.\n\n-----\n\n**Solution:**\n\n-----\n\n# 10\n\nAs discussed in section 1.6, [24] report that the number of marine bivalve species discovered each year from 2010-2015 was 64, 13, 33, 18, 30 and 20. Denote $Y_t$ as the number of species discovered in year $2009+t$ (so that $Y_1=64$ is the count for 2010). Use `JAGS` to fit the model \n\n$$\nY_t\\vert \\alpha, \\beta \\overset{\\mathrm{indep}}{\\sim} \\mathrm{Poisson}(\\lambda_t)\\\\\n\\lambda_t = \\exp(\\alpha + \\beta t) \\text{ or equivalently } \\log(\\lambda_t) = \\alpha + \\beta t \\\\\n\\alpha,\\beta \\overset{\\mathrm{indep}}{\\sim} \\mathrm{Normal}(0,10^2).\n$$\n\nSummarize the posterior of $\\alpha$ and $\\beta$ and verify that the MCMC sampler has converged. Does this analysis provide evidence that the rate of discovery is changing over time?\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}