{
  "hash": "15530d60e4ef647b384acfd6dcc5d836",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Homework #4 (Solution)\"\nsubtitle: \"Exercises from Chapter 3.5: 2, 4, 5 and 10\"\ndescription: |\n    **Assigned:** Friday, September 15th, 2023 <br>\n    **Due:** Friday, September 29th, 2023\nauthor: \n    -   name: Brynjólfur Gauti Guðrúnar Jónsson\n        email: brynjolfur@hi.is\n        url: https://www.hi.is/staff/brynjolfur\n        affiliation: \n        -   name: School of Engineering and Natural Sciences, University of Iceland\n            city: Reykjavík\n            url: https://english.hi.is/school_of_engineering_and_natural_sciences\n# Change this to pdf if you'd rather work in that format\nformat: html \neditor: source\ntitle-block-banner: true\n#### The setting below makes our HTML document self-contained so that we can turn it in ####\n#### UNCOMMENT THE LONE BELOW SO THAT YOU CAN TURN IN YOUR HTML DOCUMENT ###################\n# embed-resources: true \nbibliography: references.bib\ncitation-location: margin\n---\n\n<!-- REMOVE THIS PART SO THAT YOU CAN RENDER YOUR DOCUMENT BEFORE TURNING IN YOUR ASSIGNMENT -->\n\n{{< downloadthis index.qmd dname=\"hw4_solution\" label=\"Download the Quarto document used to render this file\" type=primary class=downloadbutton >}}\n\n\n<!-- --------------------------------------------------------------------------------------- -->\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| output: hide\n\nlibrary(tidyr)\nlibrary(dplyr, warn.conflicts = FALSE)\nlibrary(stringr)\nlibrary(forcats)\nlibrary(ggplot2)\nlibrary(readr)\nlibrary(patchwork)\nlibrary(gt)\nlibrary(cubature)\nlibrary(purrr)\nlibrary(scales)\nlibrary(glue)\nlibrary(rjags)\nlibrary(posterior)\nlibrary(bayesplot)\ntheme_set(theme_classic())\n```\n````\n:::\n\n\n\n# 2\n\nAssume that $Y_i\\vert\\mu\\overset{\\mathrm{indep}}{\\sim} \\mathrm{Normal}(\\mu,\\sigma_i^2)$ for $i \\in \\{1, \\dots, n\\}$, with $\\sigma_i$ known and improper prior distribution $\\pi(\\mu)=1$ for all $\\mu$.\n\na.  Give a formula for the MAP estimator for $\\mu$\n\n------------------------------------------------------------------------\n\n**Solution:**\n\nWith a flat prior, our posterior distribution is simply equal to our likelihood.\n\n$$\n\\begin{aligned}\np(\\mu \\vert \\mathbf Y) &= f(\\mathbf Y \\vert \\mu, \\mathbf \\sigma) \\\\\n&= \\prod_{i = 1}^n\\sigma_i^{-1} (2\\pi)^{-1/2}\\exp\\left[-\\frac{(Y_i - \\mu)^2}{2\\sigma_i^2}\\right] \\\\\n&\\propto \\prod_{i = 1}^n\\sigma_i^{-1} \\exp\\left[-\\frac{(Y_i - \\mu)^2}{2\\sigma_i^2}\\right] \\\\\n&= G(\\mu)\n\\end{aligned}\n$$\n\nTake the log on both sides\n\n$$\n\\begin{aligned}\n\\log G(\\mu) &= g(\\mu) \\\\\n&=\\sum_{i=1}^n-\\log\\sigma_i - \\frac{1}{2\\sigma_i^2}(Y_i - \\mu)^2 \\\\\n&= -\\sum_{i=1}^n n_i\\log\\sigma_i - \\frac{1}{2\\sigma_i^2}(Y_i^2 - 2Y_i\\mu + \\mu^2) \\\\\n\\frac{dg}{d\\mu} &= \\sum_{i=1}^n\\frac{1}{2\\sigma_i^2}(2\\mu - 2Y_i) \\\\\n&= \\sum_{i=1}^n\\frac{1}{\\sigma_i^2}(\\mu - Y_i)\n\\end{aligned}\n$$\n\nTo find the MAP estimator, we find where this is equal to zero, i.e. $dg/d\\mu = 0$.\n\n$$\n\\begin{aligned}\n\\sum_{i=1}^n\\frac{1}{\\sigma_i^2}\\mu &= \\sum_{i=1}^n\\frac{1}{\\sigma_i^2}Y_i \\\\\n\\rightarrow \\mu &= \\frac{\\sum_{i=1}^n\\frac{1}{\\sigma_i^2}Y_i}{\\sum_{i=1}^n\\frac{1}{\\sigma_i^2}}.\n\\end{aligned}\n$$\n\nWe see that the MAP estimator is simply a weighted average of the $Y_i$'s, where each observations contribution to the mean is inversely proportional to its variance. If all $Y_i$ have the same variance, then this simplifies to the usual mean.\n\n\n------------------------------------------------------------------------\n\nb.  We observe $n=3, Y_1=12, Y_2=10, Y_3=22, \\sigma_1=\\sigma_2=3$ and $\\sigma_3=10$, compute the MAP estimate of $\\mu$.\n\n------------------------------------------------------------------------\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_MAP <- function(n, Y, sigma) {\n    if (length(Y) != n) stop(\"Y should have length equal to n\")\n    if (length(sigma) != n) stop(\"sigma should have length equal to n\")\n    \n    sum(Y / sigma^2) / sum(1/sigma^2)\n}\n\nn <- 3\nY <- c(12, 10, 22)\nsigma <- c(3, 3, 10)\n\nmu_MAP <- my_MAP(n, Y, sigma)\n\nmu_MAP\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 11.47368\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nc.  Use numerical integration to compute the posterior mean of $\\mu$.\n\n------------------------------------------------------------------------\n\n**Solution:**\n\nThe posterior distribution, being equal to the likelihood, is normalized with respect to $Y$, but not necessarily with respect to $\\mu$. Therefore we first integrate over $\\mu$ to calculate the normalizing constant and then we can calculate the posterior mean.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunnormalized_posterior <- function(mu) {\n    logpost_unnormalized <- 0\n    for (i in seq_along(Y)) {\n        logpost_unnormalized <- logpost_unnormalized + dnorm(Y[i], mean = mu, sd = sigma[i], log = TRUE)\n    }\n    exp(logpost_unnormalized)\n}\n\nmarginal <- integrate(unnormalized_posterior, lower = -Inf, upper = Inf)$value\nmarginal\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.001840506\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nunnormalized_posterior_mean <- function(mu) {\n    logpost_unnormalized <- 0\n    for (i in seq_along(Y)) {\n        logpost_unnormalized <- logpost_unnormalized + dnorm(Y[i], mean = mu, sd = sigma[i], log = TRUE)\n    }\n    mu * exp(logpost_unnormalized)\n}\n\npost_mean_unnorm <- integrate(unnormalized_posterior_mean, lower = -Inf, upper = Inf)$value\n\nmu_MEAN <- post_mean_unnorm / marginal\nmu_MEAN\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 11.47368\n```\n\n\n:::\n:::\n\n\n\n------------------------------------------------------------------------\n\nd.  Plot the posterior distribution of $\\mu$ and indicate the MAP and the posterior mean estimates on the plot.\n\n------------------------------------------------------------------------\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(\n    mu = 11.47 + 7 * seq(-1, 1, length.out = 1e2)\n) |> \n    mutate(\n        post = unnormalized_posterior(mu) / marginal\n    ) |> \n    ggplot(aes(mu, post)) +\n    geom_area(\n        alpha = 0.5\n    ) +\n    geom_vline(xintercept = mu_MAP, lty = 4, col = \"red\") +\n    geom_vline(xintercept = mu_MEAN, lty = 2, col = \"blue\") +\n    scale_x_continuous(\n        breaks = c(mu_MEAN, seq(7, 16, by = 3)),\n        labels = label_number(accuracy = 0.01)\n    ) +\n    coord_cartesian(expand = FALSE) +\n    labs(\n        x = expression(mu),\n        y = expression(paste(p, \"(\", mu, \"|\", Y, \")\")),\n        title = expression(paste(\"Posterior distribution of \", mu)),\n        subtitle = \"The MAP and posterior mean are equal (expected result since posterior is symmetrical)\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n------------------------------------------------------------------------\n\n# 4\n\nConsider the model\n\n$$\nY_i\\vert\\sigma^2_i\\overset{\\mathrm{indep}}{\\sim} \\mathrm{Normal}(0,\\sigma_i^2),\n$$\n\nfor $i \\in \\{1, \\dots, n\\}$ where \n\n$$\n\\begin{gathered}\n\\sigma_i^2\\vert b \\sim \\mathrm{InvGamma}(a,b) \\\\ b\\sim\\mathrm{Gamma}(1,1)\n\\end{gathered}\n$$\n\na.  Derive the full conditional posterior distributions for $\\sigma^2_1$ and $b$.\n\n------------------------------------------------------------------------\n\n**Solution:**\n\n\n\n$$\n\\begin{aligned}\np(\\sigma^2_1\\vert Y, b) &\\propto f(Y \\vert \\sigma_1^2) \\pi(\\sigma_1^2\\vert b) \\\\\n&= \\mathrm{Normal}(Y\\vert \\sigma_1^2) \\cdot \\mathrm{InvGamma}(\\sigma_1^2\\vert a,b)\\\\\n&= {\\sigma_1}^{-1}(2\\pi)^{-1/2}\\exp\\left[-\\frac{{Y_1}^2}{2{\\sigma_1^2}}\\right] \\frac{{b}^{a}}{\\Gamma(a)}{(\\sigma_1^2)}^{-{a}-1}\\exp\\left(-{b}/{\\sigma_1^2}\\right) \\\\\n&\\propto {(\\sigma_1^2)}^{-1/2}\\exp\\left[-\\frac{{Y_1}^2}{2{\\sigma_1^2}}\\right] {(\\sigma_1^2)}^{-{a}-1}\\exp\\left(-{b}/{\\sigma_1^2}\\right) \\\\\n&= (\\sigma_1^2)^{-(a+1/2) - 1} \\exp\\left[-\\left(\\frac{Y_1^2}{2} + b\\right)/\\sigma_1^2\\right].\n\\end{aligned}\n$$\n\nWe see that the full conditional posterior for $\\sigma_1^2$ is an $\\mathrm{InvGamma}(a + 1/2, b + Y_1^2/2)$ distribution.\n\n$$\n\\begin{aligned}\np(b\\vert \\sigma_1, \\dots, \\sigma_n) &\\propto \\pi(b) \\prod_{i=1}^n\\pi(\\sigma_i^2\\vert b) \\\\\n&= \\exp\\left(-b\\right)\\prod_{i=1}^n \\frac{{b}^{a}}{\\Gamma(a)}{(\\sigma_i^2)}^{-{a}-1}\\exp\\left(-{b}/{\\sigma_i^2}\\right) \\\\\n&\\propto  \\exp\\left(-b\\right)\\prod_{i=1}^n {b}^{a}\\exp\\left(-{b}/{\\sigma_i^2}\\right) \\\\\n&= \\exp\\left(-b\\right)b^{na} \\exp\\left( \\sum_{i=1}^{n}{-b/\\sigma_i^2}\\right) \\\\\n&= b^{(1+na)-1}\\exp\\left(-b - \\sum_{i=1}^{n}{}\\frac{1}{ \\sigma_i^2}b\\right) \\\\\n&= b^{(1+na)-1} \\exp\\left(-\\left(1 + \\sum_{i=1}^{n}{}\\frac{1}{\\sigma_i^2}\\right)b\\right).\n\\end{aligned}\n$$\n\nWe also see that the full conditional posterior for $b$ is an $\\mathrm{Gamma}(1 + na, 1 + \\sum_{i=1}^{n}{}\\frac{1}{\\sigma_i^2})$ distribution.\n\n------------------------------------------------------------------------\n\nb.  Write pseudocode for Gibbs sampling, i.e. describe in detail each step of the Gibbs sampling algorithm.\n\n------------------------------------------------------------------------\n\n**Solution:** In Gibbs sampling we iterate over each unknown parameter and sample from its full conditional posterior distribution. In our case the unknown parameters are the $\\sigma_i^2$'s and $b$. To perform Gibbs sampling we would therefore do the following:\n\n\n::: {.cell}\n\n```{.default .cell-code}\nset a large value for N_samples\nset a value for a\nread in data Y as length n vector\n\ninitialize b by sampling from prior\ninitialize sigma2 as a length n vector by sampling from prior\n\nfor i from 1 to N_samples:\n    for j from 1 to n:\n    sample sigma2[i] from InvGamma(a + 1/2, b + Y[i]^2/2) \nend for\nsample b from InvGamma(n*a, 1 + sum(1/sigma2))\n```\n:::\n\n\n\n\n------------------------------------------------------------------------\n\nc.  Write your own Gibbs sampling code (not in `JAGS`) and plot the marginal posterior density of each parameter. Assume $n=10$, $a=10$ and $Y_i=i$ for $i=1, \\dots, 10$.\n\n------------------------------------------------------------------------\n\n**Solution:**\n\nWe're going to use the [posterior package](https://mc-stan.org/posterior/index.html) to easily analyze our posterior distribution after we've run our Gibbs sampler. The `posterior` package gives us acces to a `draws_df` data type that we can create using the `as_draws_df()` function. To be able to convert our posterior into a `draws_df`, we want to save our results in an array with dimensions $\\mathrm{N_{sample}\\times N_{chain} \\times N_{variable}}$. I am planning on performing 10000 samples in each of 4 chains and there are 11 total variables, so our array will have the shape $10000 \\times 4 \\times 11$. We then have to keep track of which dimension we are indexing at each time.\n\n\nFirst we define functions for sampling from each parameter's full conditional distribution. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsample_sigma2 <- function(a, b, Y) {\n    1/rgamma(length(Y), shape = a + 1/2, rate = b + Y^2/2)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsample_b <- function(n, a, sigma2) {\n    rgamma(1, shape = n * a + 1, rate = 1 + sum(1/sigma2))\n}\n```\n:::\n\n\nWe then write a function for Gibbs sampling that wraps around these two functions defined above. The `gibbs_sampler` function needs five inputs:\n\n* `n_samples`: The number of samples we want from our posterior within each chain\n* `n_chain`: The number of chains we want to run\n* `n_variables`: The number of variables in our posterior\n* `Y`: Our observed data\n* `a`: For our inverse gamma prior\n* `n_burnin`: The number of samples we want to draw as part of our burn-in. This is by default equal to `n_samples`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngibbs_sampler <- function(n_samples, n_chains, n_variables, Y, a, n_burnin = n_samples) {\n    \n    posterior <- array(dim = c(n_samples, n_chains, n_variables))\n    dimnames(posterior)[[3]] <- c(\"b\", glue(\"sigma2[{1:10}]\"))\n    \n    for (chain in seq_len(n_chains)) {\n        # Initial values for the Gibbs sampler\n        b_value <- 1\n        sigma2_value <- sample_sigma2(a, b_value, Y)\n        \n        # Burn-in period\n        # Run the sampler without saving our values\n        for (i in seq_len(n_burnin)) {\n            b_value <- sample_b(n, a, sigma2_value)\n            sigma2_value <- sample_sigma2(a, b_value, Y)\n        }\n        \n        # Running the Gibbs sampler for n_samples iterations\n        for (i in seq_len(n_samples)) {\n            # Here we perform the sampling\n            b_value <- sample_b(n, a, sigma2_value)\n            sigma2_value <- sample_sigma2(a, b_value, Y)\n            \n            # Here we store the samples in our array\n            # Pay close attention to the indexing\n            posterior[i, chain, 1] <- b_value\n            posterior[i, chain, -1] <- sigma2_value\n        }\n    }\n    # Convert our array into a draws_df\n    posterior |> \n        as_draws_df()\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 10\na <- 10\nY <- 1:10\n\n# 10xsigma2 + b = 11\nn_variables <- n + 1\nn_chains <- 4\nn_samples <- 1e4\n\nposterior <- gibbs_sampler(n_samples, n_chains, n_variables, Y, a)\n```\n:::\n\n\nHaving done the preparatory work of converting our results into a `draws_df` object, we are rewarded with access the great `bayesplot` package for plotting our posterior.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior |> \n    mcmc_dens()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummarised_results_gibbs <- posterior |> \n    summarise_draws()\n\nsummarised_results_gibbs |> \n    gt() |> \n    fmt_number(\n        decimals = 2,\n        columns = mean:rhat\n    ) |> \n    fmt_number(\n        decimals = 0,\n        columns = starts_with(\"ess\")\n    ) |> \n    tab_header(\n        title = \"Summarizing the posterior distribution of our model\"\n    )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"kzmgwioqnh\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#kzmgwioqnh table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#kzmgwioqnh thead, #kzmgwioqnh tbody, #kzmgwioqnh tfoot, #kzmgwioqnh tr, #kzmgwioqnh td, #kzmgwioqnh th {\n  border-style: none;\n}\n\n#kzmgwioqnh p {\n  margin: 0;\n  padding: 0;\n}\n\n#kzmgwioqnh .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#kzmgwioqnh .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#kzmgwioqnh .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#kzmgwioqnh .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#kzmgwioqnh .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kzmgwioqnh .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kzmgwioqnh .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kzmgwioqnh .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#kzmgwioqnh .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#kzmgwioqnh .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#kzmgwioqnh .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#kzmgwioqnh .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#kzmgwioqnh .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#kzmgwioqnh .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#kzmgwioqnh .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#kzmgwioqnh .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#kzmgwioqnh .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#kzmgwioqnh .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#kzmgwioqnh .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kzmgwioqnh .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#kzmgwioqnh .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#kzmgwioqnh .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#kzmgwioqnh .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kzmgwioqnh .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#kzmgwioqnh .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#kzmgwioqnh .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kzmgwioqnh .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kzmgwioqnh .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#kzmgwioqnh .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kzmgwioqnh .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#kzmgwioqnh .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kzmgwioqnh .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kzmgwioqnh .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kzmgwioqnh .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kzmgwioqnh .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kzmgwioqnh .gt_left {\n  text-align: left;\n}\n\n#kzmgwioqnh .gt_center {\n  text-align: center;\n}\n\n#kzmgwioqnh .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#kzmgwioqnh .gt_font_normal {\n  font-weight: normal;\n}\n\n#kzmgwioqnh .gt_font_bold {\n  font-weight: bold;\n}\n\n#kzmgwioqnh .gt_font_italic {\n  font-style: italic;\n}\n\n#kzmgwioqnh .gt_super {\n  font-size: 65%;\n}\n\n#kzmgwioqnh .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#kzmgwioqnh .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#kzmgwioqnh .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#kzmgwioqnh .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#kzmgwioqnh .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#kzmgwioqnh .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#kzmgwioqnh .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"10\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Summarizing the posterior distribution of our model</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mad\">mad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q5\">q5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q95\">q95</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rhat\">rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_bulk\">ess_bulk</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_tail\">ess_tail</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">b</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">30.27</td>\n<td headers=\"median\" class=\"gt_row gt_right\">29.99</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">4.32</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">4.28</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">23.62</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">37.80</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">13,202</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">21,798</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[1]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">3.24</td>\n<td headers=\"median\" class=\"gt_row gt_right\">3.01</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1.20</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">1.77</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">5.49</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">23,158</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">30,834</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[2]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">3.40</td>\n<td headers=\"median\" class=\"gt_row gt_right\">3.16</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1.27</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.05</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">1.86</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">5.75</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">24,415</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">33,422</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[3]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">3.67</td>\n<td headers=\"median\" class=\"gt_row gt_right\">3.41</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1.35</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.12</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">2.02</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">6.19</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">26,382</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">33,365</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[4]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">4.03</td>\n<td headers=\"median\" class=\"gt_row gt_right\">3.75</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1.47</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.22</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">2.25</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">6.76</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">27,234</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">35,340</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[5]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">4.50</td>\n<td headers=\"median\" class=\"gt_row gt_right\">4.19</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1.62</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.34</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">2.54</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">7.47</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">29,581</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">36,526</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[6]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">5.06</td>\n<td headers=\"median\" class=\"gt_row gt_right\">4.72</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1.79</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.49</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">2.88</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">8.41</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">29,017</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">36,539</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[7]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">5.76</td>\n<td headers=\"median\" class=\"gt_row gt_right\">5.37</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.05</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.69</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">3.27</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">9.56</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">32,461</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">36,761</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[8]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">6.54</td>\n<td headers=\"median\" class=\"gt_row gt_right\">6.08</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.30</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.90</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">3.74</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">10.82</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">31,719</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">37,147</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[9]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">7.44</td>\n<td headers=\"median\" class=\"gt_row gt_right\">6.97</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.59</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.19</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">4.26</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">12.23</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">33,021</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">38,109</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[10]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">8.43</td>\n<td headers=\"median\" class=\"gt_row gt_right\">7.89</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.93</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.46</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">4.85</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">13.87</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">34,668</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">39,265</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nd.  Repeat the analysis with $a=1$ and comment on the convergence of the MCMC chain.\n\n------------------------------------------------------------------------\n\n**Solution:** We can now reuse our code from above, only having to change the value of `a`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\na <- 1\n\nposterior <- gibbs_sampler(n_samples, n_chains, n_variables, Y, a)\n```\n:::\n\n\nHaving done the preparatory work of converting our results into a `draws_df` object, we are rewarded with the great functions available in the `posterior` package. The `summarise_draws()` function is a great way to easily obtain summarized results about our posterior.\n\nThe table below shows us that $\\hat R$ and our effective sample size *(ESS)* are both acceptable, so it seems our sampler has converged. \n\nThe $\\hat R$ is not the same as in the book, since the `posterior` package has implemented  the proposed updates from @vehtariRankNormalizationFoldingLocalization2021 that increase its ability to find faulty convergence. Have a look at the article to learn more about convergence. You can also read about $\\mathrm{ESS_{bulk}}$ and $\\mathrm{ESS_{tail}}$ there, but in simple terms, they calculate the ESS for the center and the tails of the posterior distributions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummarised_results_gibbs <- posterior |> \n    summarise_draws()\n\nsummarised_results_gibbs |> \n    gt() |> \n    fmt_number(\n        decimals = 2,\n        columns = mean:rhat\n    ) |> \n    fmt_number(\n        decimals = 0,\n        columns = starts_with(\"ess\")\n    ) |> \n    tab_header(\n        title = \"Summarizing the posterior distribution of our model\"\n    )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"qzrjdnlffu\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#qzrjdnlffu table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#qzrjdnlffu thead, #qzrjdnlffu tbody, #qzrjdnlffu tfoot, #qzrjdnlffu tr, #qzrjdnlffu td, #qzrjdnlffu th {\n  border-style: none;\n}\n\n#qzrjdnlffu p {\n  margin: 0;\n  padding: 0;\n}\n\n#qzrjdnlffu .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#qzrjdnlffu .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#qzrjdnlffu .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#qzrjdnlffu .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#qzrjdnlffu .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qzrjdnlffu .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qzrjdnlffu .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qzrjdnlffu .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#qzrjdnlffu .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#qzrjdnlffu .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#qzrjdnlffu .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#qzrjdnlffu .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#qzrjdnlffu .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#qzrjdnlffu .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#qzrjdnlffu .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#qzrjdnlffu .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#qzrjdnlffu .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#qzrjdnlffu .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#qzrjdnlffu .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qzrjdnlffu .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#qzrjdnlffu .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#qzrjdnlffu .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#qzrjdnlffu .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qzrjdnlffu .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#qzrjdnlffu .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#qzrjdnlffu .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qzrjdnlffu .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qzrjdnlffu .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#qzrjdnlffu .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qzrjdnlffu .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#qzrjdnlffu .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qzrjdnlffu .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qzrjdnlffu .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qzrjdnlffu .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qzrjdnlffu .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qzrjdnlffu .gt_left {\n  text-align: left;\n}\n\n#qzrjdnlffu .gt_center {\n  text-align: center;\n}\n\n#qzrjdnlffu .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#qzrjdnlffu .gt_font_normal {\n  font-weight: normal;\n}\n\n#qzrjdnlffu .gt_font_bold {\n  font-weight: bold;\n}\n\n#qzrjdnlffu .gt_font_italic {\n  font-style: italic;\n}\n\n#qzrjdnlffu .gt_super {\n  font-size: 65%;\n}\n\n#qzrjdnlffu .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#qzrjdnlffu .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#qzrjdnlffu .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#qzrjdnlffu .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#qzrjdnlffu .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#qzrjdnlffu .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#qzrjdnlffu .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"10\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Summarizing the posterior distribution of our model</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mad\">mad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q5\">q5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q95\">q95</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rhat\">rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_bulk\">ess_bulk</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_tail\">ess_tail</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">b</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">5.54</td>\n<td headers=\"median\" class=\"gt_row gt_right\">5.29</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1.98</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.87</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">2.78</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">9.18</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">22,778</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">31,315</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[1]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">11.94</td>\n<td headers=\"median\" class=\"gt_row gt_right\">4.91</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">77.80</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">4.07</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">1.29</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">34.32</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">28,978</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">32,847</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[2]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">15.05</td>\n<td headers=\"median\" class=\"gt_row gt_right\">6.18</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">116.19</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">5.00</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">1.72</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">43.32</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">32,136</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">35,394</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[3]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">19.12</td>\n<td headers=\"median\" class=\"gt_row gt_right\">8.39</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">71.30</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">6.70</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">2.43</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">58.11</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">35,603</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">38,314</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[4]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">26.91</td>\n<td headers=\"median\" class=\"gt_row gt_right\">11.36</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">158.25</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">9.03</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">3.36</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">79.20</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">37,190</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">39,013</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[5]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">47.99</td>\n<td headers=\"median\" class=\"gt_row gt_right\">15.31</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2,191.15</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">12.04</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">4.53</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">105.45</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">38,626</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">38,810</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[6]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">46.65</td>\n<td headers=\"median\" class=\"gt_row gt_right\">19.81</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">237.04</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">15.55</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">5.91</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">136.49</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">39,356</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">38,963</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[7]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">57.73</td>\n<td headers=\"median\" class=\"gt_row gt_right\">25.41</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">370.00</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">19.80</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">7.62</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">169.80</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">39,748</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">40,117</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[8]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">73.08</td>\n<td headers=\"median\" class=\"gt_row gt_right\">31.55</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">371.65</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">24.81</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">9.59</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">214.45</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">38,877</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">39,718</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[9]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">90.52</td>\n<td headers=\"median\" class=\"gt_row gt_right\">38.77</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">556.12</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">30.41</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">11.68</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">256.58</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">39,099</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">39,389</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[10]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">117.48</td>\n<td headers=\"median\" class=\"gt_row gt_right\">46.73</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1,640.49</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">36.44</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">14.18</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">323.50</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">39,349</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">39,506</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nWe also look at trace plots below. It is a good habit to visually inspect our chains even though calculated statistics tell us that the sampler has converged. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior |> \n    mcmc_trace(\n        regex_pars = \"sigma\",\n        transformations = \"log\"\n    ) +\n    labs(\n        title = expression(paste(\"Trace plots of log(\", sigma^2, \")\")),\n        subtitle = \"The trace plots show us that the Markov chain is stationary and the chains have converged\\nto the same value\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior |> \n    mcmc_trace(\n        regex_pars = \"b\"\n    ) +\n    labs(\n        title = expression(paste(\"Trace plot of \", b)),\n        subtitle = \"The trace plots show us that the Markov chain is stationary and the chains have converged\\nto the same value\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\ne.  Implement the model in *c.* using `JAGS` and compare the results with the results in *c.*\n\n------------------------------------------------------------------------\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata = list(\n    Y = 1:10\n)\nmodel_string <- textConnection(\"model{\n    # Likelihood\n    for (i in 1:10) {\n        Y[i] ~ dnorm(0, tau[i])\n    }\n    # Priors\n    for (i in 1:10) {\n        tau[i] ~ dgamma(10, b)\n        sigma2[i] <- 1 / tau[i]\n    }\n    b ~ dgamma(1, 1)\n}\")\n\ninits <- list(\n    b = 1,\n    tau = rep(1, 10)\n)\n\nmodel <- jags.model(\n    model_string,\n    data = data,\n    inits = inits,\n    n.chains = 4\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCompiling model graph\n   Resolving undeclared variables\n   Allocating nodes\nGraph information:\n   Observed stochastic nodes: 10\n   Unobserved stochastic nodes: 11\n   Total graph size: 34\n\nInitializing model\n```\n\n\n:::\n\n```{.r .cell-code}\nupdate(model, 10000)\n\nparams <- names(inits)\nsamples <- coda.samples(\n    model,\n    variable.names = c(\"b\", \"sigma2\"),\n    n.iter = 10000\n)\n\nposterior_jags <- samples |> \n    as_draws_df()\n```\n:::\n\n\n\nThe `posterior` package allows us to take our `samples` object that was output by `coda.samples()` and use `as_draws_df()` to convert it into a comfortable data type.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummarised_results_jags <- posterior_jags |> \n    summarise_draws()\n\nsummarised_results_jags |> \n    gt() |> \n    fmt_number(\n        decimals = 2,\n        columns = mean:rhat\n    ) |> \n    fmt_number(\n        decimals = 0,\n        columns = starts_with(\"ess\")\n    ) |> \n    tab_header(\n        title = \"Summarizing the posterior distribution of our model\"\n    )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"xkxkqixnul\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xkxkqixnul table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xkxkqixnul thead, #xkxkqixnul tbody, #xkxkqixnul tfoot, #xkxkqixnul tr, #xkxkqixnul td, #xkxkqixnul th {\n  border-style: none;\n}\n\n#xkxkqixnul p {\n  margin: 0;\n  padding: 0;\n}\n\n#xkxkqixnul .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xkxkqixnul .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xkxkqixnul .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xkxkqixnul .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xkxkqixnul .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xkxkqixnul .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xkxkqixnul .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xkxkqixnul .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xkxkqixnul .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xkxkqixnul .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xkxkqixnul .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xkxkqixnul .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xkxkqixnul .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xkxkqixnul .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xkxkqixnul .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xkxkqixnul .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xkxkqixnul .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xkxkqixnul .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xkxkqixnul .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xkxkqixnul .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xkxkqixnul .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xkxkqixnul .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xkxkqixnul .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xkxkqixnul .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xkxkqixnul .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xkxkqixnul .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xkxkqixnul .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xkxkqixnul .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xkxkqixnul .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xkxkqixnul .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xkxkqixnul .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xkxkqixnul .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xkxkqixnul .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xkxkqixnul .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xkxkqixnul .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xkxkqixnul .gt_left {\n  text-align: left;\n}\n\n#xkxkqixnul .gt_center {\n  text-align: center;\n}\n\n#xkxkqixnul .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xkxkqixnul .gt_font_normal {\n  font-weight: normal;\n}\n\n#xkxkqixnul .gt_font_bold {\n  font-weight: bold;\n}\n\n#xkxkqixnul .gt_font_italic {\n  font-style: italic;\n}\n\n#xkxkqixnul .gt_super {\n  font-size: 65%;\n}\n\n#xkxkqixnul .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xkxkqixnul .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xkxkqixnul .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xkxkqixnul .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xkxkqixnul .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xkxkqixnul .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xkxkqixnul .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"10\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Summarizing the posterior distribution of our model</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mad\">mad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q5\">q5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q95\">q95</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rhat\">rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_bulk\">ess_bulk</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_tail\">ess_tail</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">b</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">30.22</td>\n<td headers=\"median\" class=\"gt_row gt_right\">29.93</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">4.35</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">4.30</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">23.56</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">37.81</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">12,681</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">23,013</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[1]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">3.24</td>\n<td headers=\"median\" class=\"gt_row gt_right\">3.00</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1.22</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.02</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">1.76</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">5.51</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">24,648</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">32,746</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[2]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">3.39</td>\n<td headers=\"median\" class=\"gt_row gt_right\">3.15</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1.26</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.05</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">1.86</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">5.75</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">24,955</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">34,952</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[3]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">3.66</td>\n<td headers=\"median\" class=\"gt_row gt_right\">3.41</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1.33</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.13</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">2.02</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">6.16</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">25,124</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">33,948</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[4]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">4.01</td>\n<td headers=\"median\" class=\"gt_row gt_right\">3.74</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1.47</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.22</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">2.24</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">6.75</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">26,377</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">35,123</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[5]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">4.49</td>\n<td headers=\"median\" class=\"gt_row gt_right\">4.19</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1.61</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.35</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">2.51</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">7.51</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">28,630</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">36,117</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[6]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">5.08</td>\n<td headers=\"median\" class=\"gt_row gt_right\">4.72</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1.82</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.52</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">2.87</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">8.53</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">30,448</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">36,163</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[7]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">5.76</td>\n<td headers=\"median\" class=\"gt_row gt_right\">5.37</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.02</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.68</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">3.30</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">9.53</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">32,158</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">36,850</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[8]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">6.53</td>\n<td headers=\"median\" class=\"gt_row gt_right\">6.09</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.27</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.91</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">3.76</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">10.76</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">34,940</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">37,132</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[9]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">7.44</td>\n<td headers=\"median\" class=\"gt_row gt_right\">6.95</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.59</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.17</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">4.28</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">12.33</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">33,573</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">37,957</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2[10]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">8.42</td>\n<td headers=\"median\" class=\"gt_row gt_right\">7.86</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.94</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.43</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">4.85</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">13.91</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">35,401</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">39,639</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummarised_results_gibbs <- gibbs_sampler(n_samples, n_chains, n_variables, Y, a = 10) |> \n    summarise_draws()\n\nsummarised_results_combined <- summarised_results_gibbs |> \n    mutate(\n        type = \"Bespoke Gibbs\"\n    ) |> \n    bind_rows(\n        summarised_results_jags |> \n            mutate(\n                type = \"JAGS\"\n            )\n    )\n\n\nsummarised_results_combined |> \n    filter(str_detect(variable, \"sigma\")) |> \n    mutate(\n        variable = fct_reorder(variable, -parse_number(variable))\n    ) |> \n    ggplot(aes(\n        y = variable,\n        x = mean, xmin = q5, xmax = q95,\n        col = type\n    )) +\n    geom_pointrange(\n        position = position_dodge(width = 0.7)\n    ) +\n    scale_color_brewer(palette = \"Set1\") +\n    labs(\n        x = NULL,\n        y = NULL,\n        title = \"Comparing our bespoke Gibbs sampler to JAGS\",\n        subtitle = \"The results seem to be identical\",\n        col = \"Sampler\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nsummarised_results_combined |> \n    filter(!str_detect(variable, \"sigma\")) |> \n    ggplot(aes(\n        y = variable,\n        x = mean, xmin = q5, xmax = q95,\n        col = type\n    )) +\n    geom_pointrange(\n        position = position_dodge(width = 0.7)\n    ) +\n    scale_color_brewer(palette = \"Set1\") +\n    theme(legend.position = \"none\") +\n    labs(\n        x = NULL,\n        y = NULL,\n        title = \"Comparing our bespoke Gibbs sampler to JAGS\",\n        subtitle = \"The results seem to be identical\",\n        col = \"Sampler\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\n\n------------------------------------------------------------------------\n\n# 5\n\nConsider the model\n\n$$\nY_i\\vert\\mu, \\sigma^2 \\sim \\mathrm{Normal}(\\mu,\\sigma^2),\\quad i=1,\\dots,n,\n$$\n\nand\n\n$$\nY_i\\vert\\mu,\\delta, \\sigma^2 \\sim \\mathrm{Normal}(\\mu+\\delta,\\sigma^2),\\quad i=n+1,\\dots,n+m,\n$$\n\nwhere\n\n$$\n\\begin{gathered}\n\\mu,\\delta\\sim\\mathrm{Normal}(0, 100^2) \\\\\n\\sigma^2\\sim\\mathrm{InvGamma}(0.01, 0.01).\n\\end{gathered}\n$$\n\na.  Give an example of a real experiment for which this would be an appropriate model.\n\n------------------------------------------------------------------------\n\n**Solution:** A simple example would be a clinical trial for a pharmaceutical company wanting to know if a drug has a positive effect on patients. In this case, $\\mu$ could be the average outcome of patients in the control group *(who did not get the drug)*, and $\\mu + \\delta$ the average outcome of patients in the case group *(who did get the drug)*. The effect of the drug could then be estimated as $\\delta$.\n\n------------------------------------------------------------------------\n\nb.  Derive the full conditional posterior distributions for $\\mu$, $\\delta$, and $\\sigma^2$.\n\n------------------------------------------------------------------------\n\n**Solution:**\n\nWe have three unknown parameters: $\\mu$, $\\delta$ and $\\sigma^2$. \n\n$$\n\\begin{aligned}\np(\\mu \\vert \\mathbf Y, \\sigma^2, \\delta) &\\propto f(\\mathbf Y \\vert \\mu, \\sigma^2, \\delta)\\pi(\\mu) \\\\\n&= \\prod_{i=1}^{n}{\\mathrm{Normal}(Y_i\\vert \\mu, \\sigma^2)} \\prod_{j=n+1}^{n+m}{\\mathrm{Normal}(Y_j\\vert \\mu, \\delta, \\sigma^2)} \\mathrm{Normal}(\\mu\\vert 0, 100^2) \\\\\n&= \\prod_{i=1}^{n}\\left({ {\\sigma}^{-1}(2\\pi)^{-1/2}\\exp\\left[-\\frac{({Y_i} - {\\mu})^2}{2{\\sigma}^2}\\right]}\\right) \\prod_{j=n+1}^{n+m}\\left({ {\\sigma}^{-1}(2\\pi)^{-1/2}\\exp\\left[-\\frac{({Y_j} - {(\\mu + \\delta)})^2}{2{\\sigma}^2}\\right]}\\right) {100}^{-1}(2\\pi)^{-1/2}\\exp\\left[-\\frac{\\mu^2}{2\\cdot {100}^2}\\right] \\\\\n&\\propto \\prod_{i=1}^{n}\\left({\\exp\\left[-\\frac{({Y_i} - {\\mu})^2}{2{\\sigma}^2}\\right]}\\right) \\prod_{j=n+1}^{n+m}\\left({ \\exp\\left[-\\frac{({Y_j} - {[\\mu + \\delta\n}])^2}{2{\\sigma}^2}\\right]}\\right) \\exp\\left[-\\frac{\\mu^2}{2\\cdot {100}^2}\\right] \\\\\n&= \\exp\\left[ -\\frac{1}{2\\sigma^2}\\left( \\sum_{i=1}^{n}{(Y_i - \\mu)^2 + \\sum_{j=n+1}^{n+m}{(Y_j - \\mu - \\delta)^2}}\\right) - \\frac{1}{2\\cdot100^2}\\mu^2\\right].\n\\end{aligned}\n$$\n\nSimplifying and completing the square, we eventually end up with\n\n$$\np(\\mu \\vert \\mathbf Y, \\sigma^2, \\delta) = \\mathrm{Normal}\\left( \\frac{\\frac{1}{\\sigma^2} \\sum_{i=1}^{n}{Y_i} + \\frac{1}{\\sigma^2} \\sum_{j=n+1}^{n+m}{(Y_i- \\delta)}}{ \\frac{(n+m)}{\\sigma^2} + 1/100^2}, \\frac{1}{\\frac{(n+m)}{\\sigma^2} + 1/100^2}\\right).\n$$\n\nSimilarly, we find out that\n\n$$\np(\\delta \\vert \\mathbf Y, \\mu, \\sigma^2) = \\mathrm{Normal}\\left( \\frac{ \\frac{1}{\\sigma^2} \\sum_{j=n+1}^{n+m}{(Y_i-\\mu)}}{ \\frac{m}{\\sigma^2} + 1/100^2}, \\frac{1}{{ \\frac{m}{\\sigma^2} + 1/100^2}}\\right).\n$$\n\nThe posterior for $\\sigma^2$ is\n\n$$\np(\\sigma^2 \\vert \\mathbf Y, \\mu, \\delta) = \\mathrm{InvGamma}\\left(0.01 + (n+m)/2, 0.01 + \\sum_{i=1}^{n}{(Y_i-\\mu)^2/2} + \\sum_{j=n+1}^{n+m}{(Y_i - \\mu - \\delta)^2/2}\\right)\n$$\n\n------------------------------------------------------------------------\n\nc.  Simulate a dataset from this model with $n=m=50$, $\\mu=10$, $\\delta=1$ and $\\sigma=2$. Write your own Gibbs sampling code (not in `JAGS`) to fit the model above to the simulated data and plot the marginal posterior density for each parameter. Are you able to recover the true values reasonably well?\n\n------------------------------------------------------------------------\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 50\nm <- 50\nmu <- 10\ndelta <- 1\nsigma <- 2\n\nY1 <- rnorm(n, mu, sigma)\nY2 <- rnorm(m, mu + delta, sigma)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsample_mu <- function(Y1, Y2, sigma2, delta) {\n    n <- length(Y1)\n    m <- length(Y2)\n    numerator <- 1/sigma2 * (sum(Y1) + sum(Y2 - delta))\n    denominator <- (n + m) / (sigma2) + 1/100^2\n    rnorm(\n        n = 1,\n        mean = numerator / denominator,\n        sd = 1 / sqrt(denominator)\n    )\n}\n\nsample_delta <- function(Y2, mu, sigma2) {\n    m <- length(Y2)\n    numerator <- 1/sigma2 * sum(Y2 - mu)\n    denominator <- m/sigma2 + 1/100^2\n    rnorm(\n        n = 1,\n        mean = numerator / denominator,\n        sd = 1 / sqrt(denominator)\n    )\n}\n\nsample_sigma2 <- function(Y1, Y2, mu, delta) {\n    shape <- 0.01 + (n + m) / 2\n    rate <- 0.01 + sum((Y1 - mu)^2)/2 + sum((Y2 - mu - delta)^2)/2\n    n <- length(Y1)\n    m <- length(Y2)\n    1 / rgamma(\n        n = 1,\n        shape = shape,\n        rate = rate\n    )\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngibbs_sampler <- function(n_samples, n_chains, n_variables, Y1, Y2, n_burnin = n_samples) {\n    posterior <- array(dim = c(n_samples, n_chains, n_variables))\n    dimnames(posterior)[[3]] <- c(\"mu\", \"delta\", \"sigma2\")\n    \n    for (chain in seq_len(n_chains)) {\n        # Initial values for the Gibbs sampler\n        mu_value <- rnorm(1, 0, 100)\n        delta_value <- rnorm(1, 0, 100)\n        sigma2_value <- 1 / rgamma(1, shape = 0.01, rate = 0.01)\n        \n        # Burn-in period\n        # Run the sampler without saving our values\n        for (i in seq_len(n_burnin)) {\n            mu_value <- sample_mu(Y1, Y2, sigma2_value, delta_value)\n            delta_value <- sample_delta(Y2, mu_value, sigma2_value)\n            sigma2_value <- sample_sigma2(Y1, Y2, mu_value, delta_value)\n        }\n        \n        # Running the Gibbs sampler for n_samples iterations\n        for (i in seq_len(n_samples)) {\n            # Here we perform the sampling\n            mu_value <- sample_mu(Y1, Y2, sigma2_value, delta_value)\n            delta_value <- sample_delta(Y2, mu_value, sigma2_value)\n            sigma2_value <- sample_sigma2(Y1, Y2, mu_value, delta_value)\n            \n            # Here we store the samples in our array\n            # Pay close attention to the indexing\n            posterior[i, chain, ] <- c(mu_value, delta_value, sigma2_value)\n        }\n    }\n    # Convert our array into a draws_df\n    posterior |> \n        as_draws_df()\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nn_samples <- 1e3\nn_chains <- 4\nn_variables <- 3\n\nposterior <- gibbs_sampler(n_samples, n_chains, n_variables, Y1, Y2)\n```\n:::\n\n\n\nThe three plots below show us that out Gibbs sampler manages to adequately capture the true values of our parameters.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior |> \n    mcmc_areas(\n        pars = \"mu\",\n        prob = 0.95,\n        prob_outer = 0.99\n    ) +\n    geom_vline(xintercept = mu) +\n    labs(\n        title = expression(paste(\"Comparing the true value of \", mu, \" to our posterior distribution\")),\n        subtitle = \"The vertical line is the true value, the blue interval is the 95% interval and the white mass\\nis the 99% interval\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior |> \n    mcmc_areas(\n        pars = \"delta\",\n        prob = 0.95,\n        prob_outer = 0.99\n    ) +\n    geom_vline(xintercept = delta) +\n    labs(\n        title = expression(paste(\"Comparing the true value of \", delta, \" to our posterior distribution\")),\n        subtitle = \"The vertical line is the true value, the blue interval is the 95% interval and the white mass\\nis the 99% interval\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior |> \n    mcmc_areas(\n        pars = \"sigma2\",\n        prob = 0.95,\n        prob_outer = 0.99\n    ) +\n    geom_vline(xintercept = sigma^2) +\n    labs(\n        title = expression(paste(\"Comparing the true value of \", sigma^2, \" to our posterior distribution\")),\n        subtitle = \"The vertical line is the true value, the blue interval is the 95% interval and the white mass\\nis the 99% interval\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nd.  Implement this model using `JAGS` and compare the results with the results in **.c**.\n\n------------------------------------------------------------------------\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata = list(\n    Y1 = Y1,\n    Y2 = Y2,\n    n = n,\n    m = m\n)\nmodel_string <- textConnection(\"model{\n    # Likelihood\n    for (i in 1:n) {\n        Y1[i] ~ dnorm(mu, tau)\n    }\n    \n    for (i in 1:m) {\n        Y2[i] ~ dnorm(mu + delta, tau)\n    }\n    # Priors\n    mu ~ dnorm(0, 0.01^2)\n    delta ~ dnorm(0, 0.01^2)\n    tau ~ dgamma(0.01, 0.01)\n    sigma2 <- 1 / tau\n}\")\n\ninits <- list(\n    mu = mean(Y1),\n    delta = mean(Y2) - mean(Y1),\n    tau = 1 / var(Y1)\n)\n\nmodel <- jags.model(\n    model_string,\n    data = data,\n    inits = inits,\n    n.chains = 4\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCompiling model graph\n   Resolving undeclared variables\n   Allocating nodes\nGraph information:\n   Observed stochastic nodes: 100\n   Unobserved stochastic nodes: 3\n   Total graph size: 112\n\nInitializing model\n```\n\n\n:::\n\n```{.r .cell-code}\nupdate(model, 10000)\n\nparams <- names(inits)\nsamples <- coda.samples(\n    model,\n    variable.names = c(\"mu\", \"delta\", \"sigma2\"),\n    n.iter = 10000\n)\n\nposterior_jags <- samples |> \n    as_draws_df()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummarised_results_combined <- posterior |> \n    summarise_draws() |> \n    mutate(\n        type = \"Bespoke Gibbs\"\n    ) |> \n    bind_rows(\n        posterior_jags |> \n            summarise_draws() |> \n            mutate(\n                type = \"JAGS\"\n            )\n    ) |> \n    mutate(\n        variable = ifelse(\n            variable == \"sigma2\",\n            \"sigma^2\",\n            variable\n        )\n    )\n\n\nsummarised_results_combined |> \n    ggplot(aes(\n        y = type,\n        x = mean, xmin = q5, xmax = q95,\n        col = type\n    )) +\n    geom_pointrange(\n        position = position_dodge(width = 0.7)\n    ) +\n    scale_color_brewer(palette = \"Set1\") +\n    facet_wrap(\"variable\", scales = \"free_x\", nrow = 1, labeller = label_parsed) +\n    theme(legend.position = \"top\") +\n    labs(\n        x = NULL,\n        y = NULL,\n        title = \"Comparing our bespoke Gibbs sampler to JAGS\",\n        subtitle = \"The results seem to be identical\",\n        col = \"Sampler\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n\n------------------------------------------------------------------------\n\n# 10\n\nAs discussed in section 1.6, report that the number of marine bivalve species discovered each year from 2010-2015 was 64, 13, 33, 18, 30 and 20. Denote $Y_t$ as the number of species discovered in year $2009+t$ (so that $Y_1=64$ is the count for 2010). Use `JAGS` to fit the model\n\n$$\n\\begin{gathered}\nY_t\\vert \\alpha, \\beta \\overset{\\mathrm{indep}}{\\sim} \\mathrm{Poisson}(\\lambda_t)\\\\\n\\lambda_t = \\exp(\\alpha + \\beta t) \\text{ or equivalently } \\log(\\lambda_t) = \\alpha + \\beta t \\\\\n\\alpha,\\beta \\overset{\\mathrm{indep}}{\\sim} \\mathrm{Normal}(0,10^2).\n\\end{gathered}\n$$\n\nSummarize the posterior of $\\alpha$ and $\\beta$ and verify that the MCMC sampler has converged. Does this analysis provide evidence that the rate of discovery is changing over time?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata = list(\n    Y = c(64, 13, 33, 18, 30, 20),\n    n = 6\n)\nmodel_string <- textConnection(\"model{\n    # Likelihood\n    for (i in 1:n) {\n        Y[i] ~ dpois(lambda[i])\n        lambda[i] <- exp(alpha + beta * i)\n    }\n    \n    alpha ~ dnorm(0, 0.1^2)\n    beta ~ dnorm(0, 0.1^2)\n}\")\n\ninits <- list(\n    alpha = 0,\n    beta = 0\n)\n\nmodel <- jags.model(\n    model_string,\n    data = data,\n    inits = inits,\n    n.chains = 4\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCompiling model graph\n   Resolving undeclared variables\n   Allocating nodes\nGraph information:\n   Observed stochastic nodes: 6\n   Unobserved stochastic nodes: 2\n   Total graph size: 36\n\nInitializing model\n```\n\n\n:::\n\n```{.r .cell-code}\nupdate(model, 10000)\n\nparams <- names(inits)\nsamples <- coda.samples(\n    model,\n    variable.names = params,\n    n.iter = 10000\n)\n\nposterior_jags <- samples |> \n    as_draws_df()\n```\n:::\n\n\nThe table below shows us that that here is a high posterior probability that $\\beta < 0$. Thus we can infer that the rate is changing over time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_jags |> \n    summarise_draws() |> \n    gt() |> \n    tab_header(\n        title = \"Summary of our posterior distribution\"\n    ) |> \n    fmt_number(\n        decimals = 2\n    )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"pbgqqxoziv\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#pbgqqxoziv table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#pbgqqxoziv thead, #pbgqqxoziv tbody, #pbgqqxoziv tfoot, #pbgqqxoziv tr, #pbgqqxoziv td, #pbgqqxoziv th {\n  border-style: none;\n}\n\n#pbgqqxoziv p {\n  margin: 0;\n  padding: 0;\n}\n\n#pbgqqxoziv .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#pbgqqxoziv .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#pbgqqxoziv .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#pbgqqxoziv .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#pbgqqxoziv .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pbgqqxoziv .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pbgqqxoziv .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pbgqqxoziv .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#pbgqqxoziv .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#pbgqqxoziv .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#pbgqqxoziv .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#pbgqqxoziv .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#pbgqqxoziv .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#pbgqqxoziv .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#pbgqqxoziv .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#pbgqqxoziv .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#pbgqqxoziv .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#pbgqqxoziv .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#pbgqqxoziv .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pbgqqxoziv .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#pbgqqxoziv .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#pbgqqxoziv .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#pbgqqxoziv .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pbgqqxoziv .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#pbgqqxoziv .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#pbgqqxoziv .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pbgqqxoziv .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pbgqqxoziv .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#pbgqqxoziv .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pbgqqxoziv .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#pbgqqxoziv .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pbgqqxoziv .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pbgqqxoziv .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pbgqqxoziv .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pbgqqxoziv .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pbgqqxoziv .gt_left {\n  text-align: left;\n}\n\n#pbgqqxoziv .gt_center {\n  text-align: center;\n}\n\n#pbgqqxoziv .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#pbgqqxoziv .gt_font_normal {\n  font-weight: normal;\n}\n\n#pbgqqxoziv .gt_font_bold {\n  font-weight: bold;\n}\n\n#pbgqqxoziv .gt_font_italic {\n  font-style: italic;\n}\n\n#pbgqqxoziv .gt_super {\n  font-size: 65%;\n}\n\n#pbgqqxoziv .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#pbgqqxoziv .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#pbgqqxoziv .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#pbgqqxoziv .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#pbgqqxoziv .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#pbgqqxoziv .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#pbgqqxoziv .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"10\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Summary of our posterior distribution</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mad\">mad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q5\">q5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q95\">q95</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rhat\">rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_bulk\">ess_bulk</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_tail\">ess_tail</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">alpha</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">3.97</td>\n<td headers=\"median\" class=\"gt_row gt_right\">3.97</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.15</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.15</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">3.72</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">4.22</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">3,459.39</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">6,778.41</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−0.18</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−0.18</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.05</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.05</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.26</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−0.11</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">3,492.57</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">6,558.11</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}