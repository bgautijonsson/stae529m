{
  "hash": "5e586f6a29893b4ace6affc6048bd88d",
  "result": {
    "markdown": "---\ntitle: \"Homework #5\"\nsubtitle: \"Exercises from Chapter 4.6: 1 and 2\"\ndescription: |\n    **Assigned:** Friday, September 29th, 2023 <br>\n    **Due:** Friday, October 6th, 2023\nauthor: \n    -   name: Brynjólfur Gauti Guðrúnar Jónsson\n        email: brynjolfur@hi.is\n        url: https://www.hi.is/staff/brynjolfur\n        affiliation: \n        -   name: School of Engineering and Natural Sciences, University of Iceland\n            city: Reykjavík\n            url: https://english.hi.is/school_of_engineering_and_natural_sciences\n# Change this to pdf if you'd rather work in that format\nformat: html \neditor: source\ntitle-block-banner: true\n#### The setting below makes our HTML document self-contained so that we can turn it in ####\n#### UNCOMMENT THE LONE BELOW SO THAT YOU CAN TURN IN YOUR HTML DOCUMENT ###################\n# embed-resources: true \n---\n\n{{< downloadthis index.qmd dname=\"hw5\" label=\"Download the Quarto document used to render this file\" type=primary class=downloadbutton >}}\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| output: hide\n\nlibrary(tidyr)\nlibrary(dplyr, warn.conflicts = FALSE)\nlibrary(stringr)\nlibrary(forcats)\nlibrary(ggplot2)\nlibrary(readr)\nlibrary(patchwork)\nlibrary(gt)\nlibrary(cubature)\nlibrary(purrr)\nlibrary(scales)\nlibrary(glue)\nlibrary(rjags)\nlibrary(posterior)\nlibrary(bayesplot)\ntheme_set(theme_classic())\n```\n````\n:::\n\n\n# 1\n\nA clinical trial gave six subjects a placebo and six subjects a new weight loss medication. The response variable is the change in weight *(pounds)* from baseline *(so -2.0 means the subject lost 2 pounds)*. The data for the 12 subjects are:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- tribble(\n    ~Placebo, ~Treatment,\n    2.0, -3.5,\n    -3.1, -1.6,\n    -1.0, -4.6,\n    0.2, -0.9,\n    0.3, -5.1,\n    0.4, 0.1\n)\n\nd |> \n    gt::gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"nixxllyzjt\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#nixxllyzjt table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#nixxllyzjt thead, #nixxllyzjt tbody, #nixxllyzjt tfoot, #nixxllyzjt tr, #nixxllyzjt td, #nixxllyzjt th {\n  border-style: none;\n}\n\n#nixxllyzjt p {\n  margin: 0;\n  padding: 0;\n}\n\n#nixxllyzjt .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#nixxllyzjt .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#nixxllyzjt .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#nixxllyzjt .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#nixxllyzjt .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nixxllyzjt .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nixxllyzjt .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nixxllyzjt .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#nixxllyzjt .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#nixxllyzjt .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#nixxllyzjt .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#nixxllyzjt .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#nixxllyzjt .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#nixxllyzjt .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#nixxllyzjt .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#nixxllyzjt .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#nixxllyzjt .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#nixxllyzjt .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#nixxllyzjt .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nixxllyzjt .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#nixxllyzjt .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#nixxllyzjt .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#nixxllyzjt .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nixxllyzjt .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#nixxllyzjt .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#nixxllyzjt .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nixxllyzjt .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nixxllyzjt .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#nixxllyzjt .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nixxllyzjt .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#nixxllyzjt .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nixxllyzjt .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nixxllyzjt .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nixxllyzjt .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nixxllyzjt .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nixxllyzjt .gt_left {\n  text-align: left;\n}\n\n#nixxllyzjt .gt_center {\n  text-align: center;\n}\n\n#nixxllyzjt .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#nixxllyzjt .gt_font_normal {\n  font-weight: normal;\n}\n\n#nixxllyzjt .gt_font_bold {\n  font-weight: bold;\n}\n\n#nixxllyzjt .gt_font_italic {\n  font-style: italic;\n}\n\n#nixxllyzjt .gt_super {\n  font-size: 65%;\n}\n\n#nixxllyzjt .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#nixxllyzjt .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#nixxllyzjt .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#nixxllyzjt .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#nixxllyzjt .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#nixxllyzjt .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#nixxllyzjt .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Placebo\">Placebo</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Treatment\">Treatment</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Placebo\" class=\"gt_row gt_right\">2.0</td>\n<td headers=\"Treatment\" class=\"gt_row gt_right\">-3.5</td></tr>\n    <tr><td headers=\"Placebo\" class=\"gt_row gt_right\">-3.1</td>\n<td headers=\"Treatment\" class=\"gt_row gt_right\">-1.6</td></tr>\n    <tr><td headers=\"Placebo\" class=\"gt_row gt_right\">-1.0</td>\n<td headers=\"Treatment\" class=\"gt_row gt_right\">-4.6</td></tr>\n    <tr><td headers=\"Placebo\" class=\"gt_row gt_right\">0.2</td>\n<td headers=\"Treatment\" class=\"gt_row gt_right\">-0.9</td></tr>\n    <tr><td headers=\"Placebo\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Treatment\" class=\"gt_row gt_right\">-5.1</td></tr>\n    <tr><td headers=\"Placebo\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Treatment\" class=\"gt_row gt_right\">0.1</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nConduct a Bayesian analysis to compare the means of these two groups. Would you say the treatment is effective? Is your conclusion sensitive to the prior?\n\n---\n\n**Solution:** We can use the model we defined in last week's homework to analyse these data:\n\n$$\nY_i\\vert\\mu, \\sigma^2 \\sim \\mathrm{Normal}(\\mu,\\sigma^2),\\quad i=1,\\dots,n,\n$$\n\nand\n\n$$\nY_i\\vert\\mu,\\delta, \\sigma^2 \\sim \\mathrm{Normal}(\\mu+\\delta,\\sigma^2),\\quad i=n+1,\\dots,n+m,\n$$\n\nwhere\n\n$$\n\\begin{gathered}\n\\mu,\\delta\\sim\\mathrm{Normal}(0, 100^2) \\\\\n\\sigma^2\\sim\\mathrm{InvGamma}(0.01, 0.01).\n\\end{gathered}\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata = list(\n    Y1 = d$Placebo,\n    Y2 = d$Treatment,\n    n = nrow(d),\n    m = nrow(d)\n)\nmodel_string <- textConnection(\"model{\n    # Likelihood\n    for (i in 1:n) {\n        Y1[i] ~ dnorm(mu, tau)\n    }\n    \n    for (i in 1:m) {\n        Y2[i] ~ dnorm(mu + delta, tau)\n    }\n    # Priors\n    mu ~ dnorm(0, 0.01^2)\n    delta ~ dnorm(0, 0.01^2)\n    tau ~ dgamma(0.01, 0.01)\n    sigma2 <- 1 / tau\n}\")\n\ninits <- list(\n    mu = mean(d$Placebo),\n    delta = mean(d$Treatment) - mean(d$Placebo),\n    tau = 1 / var(d$Placebo)\n)\n\nmodel <- jags.model(\n    model_string,\n    data = data,\n    inits = inits,\n    n.chains = 4\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCompiling model graph\n   Resolving undeclared variables\n   Allocating nodes\nGraph information:\n   Observed stochastic nodes: 12\n   Unobserved stochastic nodes: 3\n   Total graph size: 24\n\nInitializing model\n```\n:::\n\n```{.r .cell-code}\nupdate(model, 10000)\n\nparams <- names(inits)\nsamples <- coda.samples(\n    model,\n    variable.names = params,\n    n.iter = 10000\n)\n\nposterior_jags <- samples |> \n    as_draws_df()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_jags |> \n    summarise_draws() |> \n    gt() |> \n    fmt_number(\n        columns = mean:rhat,\n        decimals = 3\n    ) |> \n    fmt_number(\n        columns = starts_with(\"ess\"),\n        decimals = 0\n    )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"jndvpberdg\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#jndvpberdg table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#jndvpberdg thead, #jndvpberdg tbody, #jndvpberdg tfoot, #jndvpberdg tr, #jndvpberdg td, #jndvpberdg th {\n  border-style: none;\n}\n\n#jndvpberdg p {\n  margin: 0;\n  padding: 0;\n}\n\n#jndvpberdg .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#jndvpberdg .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#jndvpberdg .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#jndvpberdg .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#jndvpberdg .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jndvpberdg .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jndvpberdg .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jndvpberdg .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#jndvpberdg .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#jndvpberdg .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#jndvpberdg .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#jndvpberdg .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#jndvpberdg .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#jndvpberdg .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#jndvpberdg .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#jndvpberdg .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#jndvpberdg .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#jndvpberdg .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#jndvpberdg .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jndvpberdg .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#jndvpberdg .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#jndvpberdg .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#jndvpberdg .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jndvpberdg .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#jndvpberdg .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#jndvpberdg .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jndvpberdg .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jndvpberdg .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#jndvpberdg .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jndvpberdg .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#jndvpberdg .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jndvpberdg .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jndvpberdg .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jndvpberdg .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jndvpberdg .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jndvpberdg .gt_left {\n  text-align: left;\n}\n\n#jndvpberdg .gt_center {\n  text-align: center;\n}\n\n#jndvpberdg .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#jndvpberdg .gt_font_normal {\n  font-weight: normal;\n}\n\n#jndvpberdg .gt_font_bold {\n  font-weight: bold;\n}\n\n#jndvpberdg .gt_font_italic {\n  font-style: italic;\n}\n\n#jndvpberdg .gt_super {\n  font-size: 65%;\n}\n\n#jndvpberdg .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#jndvpberdg .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#jndvpberdg .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#jndvpberdg .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#jndvpberdg .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#jndvpberdg .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#jndvpberdg .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mad\">mad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q5\">q5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q95\">q95</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rhat\">rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_bulk\">ess_bulk</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_tail\">ess_tail</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">delta</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−2.411</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−2.409</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1.243</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.154</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−4.432</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−0.399</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.001</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">13,160</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">21,158</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">mu</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−0.194</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−0.196</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.881</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.819</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−1.608</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">1.224</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.000</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">13,230</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">21,213</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">tau</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.273</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.255</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.122</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.115</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.108</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.500</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.000</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">25,626</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">28,448</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell fig.asp='0.5'}\n\n```{.r .cell-code}\nposterior_jags |> \n    mcmc_areas(\n        pars = \"delta\"\n    ) +\n    labs(\n        title = expression(paste(\"Posterior distribution of \", delta))\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np_lower <- posterior_jags |> \n    subset_draws(variable = \"delta\") |> \n    summarise_draws(\"P(delta < 0)\" = function(x) mean(x < 0))\n\np_lower |> \n    gt() |> \n    fmt_percent(\n        columns = 2\n    )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"jhtnhlaavz\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#jhtnhlaavz table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#jhtnhlaavz thead, #jhtnhlaavz tbody, #jhtnhlaavz tfoot, #jhtnhlaavz tr, #jhtnhlaavz td, #jhtnhlaavz th {\n  border-style: none;\n}\n\n#jhtnhlaavz p {\n  margin: 0;\n  padding: 0;\n}\n\n#jhtnhlaavz .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#jhtnhlaavz .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#jhtnhlaavz .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#jhtnhlaavz .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#jhtnhlaavz .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jhtnhlaavz .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jhtnhlaavz .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jhtnhlaavz .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#jhtnhlaavz .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#jhtnhlaavz .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#jhtnhlaavz .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#jhtnhlaavz .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#jhtnhlaavz .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#jhtnhlaavz .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#jhtnhlaavz .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#jhtnhlaavz .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#jhtnhlaavz .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#jhtnhlaavz .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#jhtnhlaavz .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jhtnhlaavz .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#jhtnhlaavz .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#jhtnhlaavz .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#jhtnhlaavz .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jhtnhlaavz .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#jhtnhlaavz .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#jhtnhlaavz .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jhtnhlaavz .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jhtnhlaavz .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#jhtnhlaavz .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jhtnhlaavz .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#jhtnhlaavz .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jhtnhlaavz .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jhtnhlaavz .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jhtnhlaavz .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jhtnhlaavz .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jhtnhlaavz .gt_left {\n  text-align: left;\n}\n\n#jhtnhlaavz .gt_center {\n  text-align: center;\n}\n\n#jhtnhlaavz .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#jhtnhlaavz .gt_font_normal {\n  font-weight: normal;\n}\n\n#jhtnhlaavz .gt_font_bold {\n  font-weight: bold;\n}\n\n#jhtnhlaavz .gt_font_italic {\n  font-style: italic;\n}\n\n#jhtnhlaavz .gt_super {\n  font-size: 65%;\n}\n\n#jhtnhlaavz .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#jhtnhlaavz .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#jhtnhlaavz .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#jhtnhlaavz .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#jhtnhlaavz .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#jhtnhlaavz .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#jhtnhlaavz .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"P(delta &amp;lt; 0)\">P(delta &lt; 0)</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">delta</td>\n<td headers=\"P(delta < 0)\" class=\"gt_row gt_right\">97.32%</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata = list(\n    Y1 = d$Placebo,\n    Y2 = d$Treatment,\n    n = nrow(d),\n    m = nrow(d)\n)\nmodel_string <- textConnection(\"model{\n    # Likelihood\n    for (i in 1:n) {\n        Y1[i] ~ dnorm(mu, tau[1])\n    }\n    \n    for (i in 1:m) {\n        Y2[i] ~ dnorm(mu + delta, tau[2])\n    }\n    # Priors\n    mu ~ dnorm(0, 0.01^2)\n    delta ~ dnorm(0, 0.01^2)\n    for (i in 1:2) {\n        tau[i] ~ dgamma(0.01, 0.01)\n        sigma2[i] <- 1 / tau[i]\n    }\n    \n}\")\n\ninits <- list(\n    mu = mean(d$Placebo),\n    delta = mean(d$Treatment) - mean(d$Placebo),\n    tau = rep(1 / var(d$Placebo), 2)\n)\n\nmodel <- jags.model(\n    model_string,\n    data = data,\n    inits = inits,\n    n.chains = 4\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCompiling model graph\n   Resolving undeclared variables\n   Allocating nodes\nGraph information:\n   Observed stochastic nodes: 12\n   Unobserved stochastic nodes: 4\n   Total graph size: 26\n\nInitializing model\n```\n:::\n\n```{.r .cell-code}\nupdate(model, 10000)\n\nparams <- names(inits)\nsamples <- coda.samples(\n    model,\n    variable.names = params,\n    n.iter = 10000\n)\n\nposterior_jags <- samples |> \n    as_draws_df()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_jags |> \n    summarise_draws() |> \n    gt() |> \n    fmt_number(\n        columns = mean:rhat,\n        decimals = 3\n    ) |> \n    fmt_number(\n        columns = starts_with(\"ess\"),\n        decimals = 0\n    )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ujoqfvuvgh\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ujoqfvuvgh table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ujoqfvuvgh thead, #ujoqfvuvgh tbody, #ujoqfvuvgh tfoot, #ujoqfvuvgh tr, #ujoqfvuvgh td, #ujoqfvuvgh th {\n  border-style: none;\n}\n\n#ujoqfvuvgh p {\n  margin: 0;\n  padding: 0;\n}\n\n#ujoqfvuvgh .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ujoqfvuvgh .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ujoqfvuvgh .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ujoqfvuvgh .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ujoqfvuvgh .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ujoqfvuvgh .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ujoqfvuvgh .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ujoqfvuvgh .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ujoqfvuvgh .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ujoqfvuvgh .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ujoqfvuvgh .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ujoqfvuvgh .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ujoqfvuvgh .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ujoqfvuvgh .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ujoqfvuvgh .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ujoqfvuvgh .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ujoqfvuvgh .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ujoqfvuvgh .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ujoqfvuvgh .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ujoqfvuvgh .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ujoqfvuvgh .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ujoqfvuvgh .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ujoqfvuvgh .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ujoqfvuvgh .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ujoqfvuvgh .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ujoqfvuvgh .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ujoqfvuvgh .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ujoqfvuvgh .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ujoqfvuvgh .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ujoqfvuvgh .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ujoqfvuvgh .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ujoqfvuvgh .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ujoqfvuvgh .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ujoqfvuvgh .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ujoqfvuvgh .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ujoqfvuvgh .gt_left {\n  text-align: left;\n}\n\n#ujoqfvuvgh .gt_center {\n  text-align: center;\n}\n\n#ujoqfvuvgh .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ujoqfvuvgh .gt_font_normal {\n  font-weight: normal;\n}\n\n#ujoqfvuvgh .gt_font_bold {\n  font-weight: bold;\n}\n\n#ujoqfvuvgh .gt_font_italic {\n  font-style: italic;\n}\n\n#ujoqfvuvgh .gt_super {\n  font-size: 65%;\n}\n\n#ujoqfvuvgh .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ujoqfvuvgh .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ujoqfvuvgh .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ujoqfvuvgh .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ujoqfvuvgh .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ujoqfvuvgh .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ujoqfvuvgh .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mad\">mad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q5\">q5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q95\">q95</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rhat\">rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_bulk\">ess_bulk</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_tail\">ess_tail</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">delta</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−2.398</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−2.388</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">1.420</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">1.268</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−4.712</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−0.135</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.000</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">13,677</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">18,588</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">mu</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−0.199</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−0.202</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.901</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.743</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−1.614</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">1.217</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.000</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">12,057</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">14,829</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">tau[1]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.341</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.298</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.216</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.191</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.078</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.760</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.000</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">22,234</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">24,083</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">tau[2]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.225</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.196</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.142</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.126</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.052</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.500</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.000</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">27,739</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">30,821</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell fig.asp='0.5'}\n\n```{.r .cell-code}\nposterior_jags |> \n    mcmc_areas(\n        pars = \"delta\"\n    ) +\n    labs(\n        title = expression(paste(\"Posterior distribution of \", delta))\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np_lower <- posterior_jags |> \n    subset_draws(variable = \"delta\") |> \n    summarise_draws(\"P(delta < 0)\" = function(x) mean(x < 0))\n\np_lower |> \n    gt() |> \n    fmt_percent(\n        columns = 2\n    )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"kfwgcrjqgs\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#kfwgcrjqgs table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#kfwgcrjqgs thead, #kfwgcrjqgs tbody, #kfwgcrjqgs tfoot, #kfwgcrjqgs tr, #kfwgcrjqgs td, #kfwgcrjqgs th {\n  border-style: none;\n}\n\n#kfwgcrjqgs p {\n  margin: 0;\n  padding: 0;\n}\n\n#kfwgcrjqgs .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#kfwgcrjqgs .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#kfwgcrjqgs .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#kfwgcrjqgs .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#kfwgcrjqgs .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kfwgcrjqgs .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kfwgcrjqgs .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kfwgcrjqgs .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#kfwgcrjqgs .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#kfwgcrjqgs .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#kfwgcrjqgs .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#kfwgcrjqgs .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#kfwgcrjqgs .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#kfwgcrjqgs .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#kfwgcrjqgs .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#kfwgcrjqgs .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#kfwgcrjqgs .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#kfwgcrjqgs .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#kfwgcrjqgs .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kfwgcrjqgs .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#kfwgcrjqgs .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#kfwgcrjqgs .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#kfwgcrjqgs .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kfwgcrjqgs .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#kfwgcrjqgs .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#kfwgcrjqgs .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kfwgcrjqgs .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kfwgcrjqgs .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#kfwgcrjqgs .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kfwgcrjqgs .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#kfwgcrjqgs .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kfwgcrjqgs .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kfwgcrjqgs .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kfwgcrjqgs .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kfwgcrjqgs .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kfwgcrjqgs .gt_left {\n  text-align: left;\n}\n\n#kfwgcrjqgs .gt_center {\n  text-align: center;\n}\n\n#kfwgcrjqgs .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#kfwgcrjqgs .gt_font_normal {\n  font-weight: normal;\n}\n\n#kfwgcrjqgs .gt_font_bold {\n  font-weight: bold;\n}\n\n#kfwgcrjqgs .gt_font_italic {\n  font-style: italic;\n}\n\n#kfwgcrjqgs .gt_super {\n  font-size: 65%;\n}\n\n#kfwgcrjqgs .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#kfwgcrjqgs .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#kfwgcrjqgs .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#kfwgcrjqgs .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#kfwgcrjqgs .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#kfwgcrjqgs .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#kfwgcrjqgs .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"P(delta &amp;lt; 0)\">P(delta &lt; 0)</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">delta</td>\n<td headers=\"P(delta < 0)\" class=\"gt_row gt_right\">95.75%</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n---\n\n# 2\n\nLoad the classic Boston Housing Data in R:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(Boston, package = \"MASS\")\n```\n:::\n\n\nThe response variable is `medv`, the median value of owner-occupied homes *(in $1,000s)*, and the other 13 variables are covariates that describe the neighborhood.\n\n\na. Fit a Bayesian linear regression model with uninformative Gaussian priors for the regression coefficients. Verify the MCMC sampler has converged, and summarize the posterior distribution of all regression coefficients.\n\n---\n\n**Solution:** We use the Jeffreys prior\n\n$$\n gamma\n$$\n\n$$\np(\\beta, \\sigma^2) \\propto \\sigma^{-2},\n$$\n\nwhich gives us the posterior distributions\n\n$$\n\\begin{aligned}\n\\beta \\vert \\sigma^2, \\mathbf Y &\\sim \\mathrm{Normal}(\\hat \\beta, V_\\beta \\sigma^2) \\\\\n\\sigma^2 \\vert \\mathbf Y &\\sim \\mathrm{}\n\\end{aligned}\n$$\n\n$$\n\\hat \\beta = \\left(X^T X\\right)^{-1}X^T y \\quad \\text{and} \\quad V_\\beta = \\left(X^TX\\right)^{-1}.\n$$\n\nThis will give us a proper posterior distribution, since we have many more data points than we have parameters in our model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nY <- Boston$medv\nX <- Boston |> select(-medv) |> as.matrix()\n\nbeta_mean <- solve(t(X) %*% X) %*% t(X) %*% Y\n```\n:::\n\n\n---\n\nb. Perform a classic least squares *(e.g. using the `lm` function in `R`)*. Compare the results numerically and conceptually with the Bayesian results.\n\n\n\n---\n\n**Solution:**\n\n\n---\n\n\nc. Refit the Bayesian model with double exponential priors for the regression coefficients, and discuss how the results differ from the analysis with uninformative priors.\n\n---\n\n**Solution:**\n\n---\n\nd. Fit a Bayesian linear regression model in *a.* using only the first 500 observations and compute the posterior predictive distribution for the final 6 observations. Plot the posterior predictive distribution versus the actual value for these 6 observations and comment on whether the predictions are reasonable.\n\n---\n\n**Solution:**\n\n---\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}