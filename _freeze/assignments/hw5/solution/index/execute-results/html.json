{
  "hash": "5cc8b2560cb1a277fc620f42becacf98",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Homework #5 (Solution)\"\nsubtitle: \"Exercises from Chapter 4.6: 1 and 2\"\ndescription: |\n    **Assigned:** Friday, September 29th, 2023 <br>\n    **Due:** Friday, October 6th, 2023\nauthor: \n    -   name: Brynjólfur Gauti Guðrúnar Jónsson\nemail: brynjolfur@hi.is\nurl: https://www.hi.is/staff/brynjolfur\naffiliation: \n    -   name: School of Engineering and Natural Sciences, University of Iceland\n        city: Reykjavík\n        url: https://english.hi.is/school_of_engineering_and_natural_sciences\n# Change this to pdf if you'd rather work in that format\nformat: html \neditor: source\ntitle-block-banner: true\n#### The setting below makes our HTML document self-contained so that we can turn it in ####\n#### UNCOMMENT THE LONE BELOW SO THAT YOU CAN TURN IN YOUR HTML DOCUMENT ###################\n# embed-resources: true \n---\n\n{{< downloadthis index.qmd dname=\"hw5_solution\" label=\"Download the Quarto document used to render this file\" type=primary class=downloadbutton >}}\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| output: hide\n\nlibrary(tidyr)\nlibrary(dplyr, warn.conflicts = FALSE)\nlibrary(stringr)\nlibrary(forcats)\nlibrary(ggplot2)\nlibrary(readr)\nlibrary(patchwork)\nlibrary(gt)\nlibrary(cubature)\nlibrary(purrr)\nlibrary(scales)\nlibrary(glue)\nlibrary(rjags)\nlibrary(posterior)\nlibrary(bayesplot)\nlibrary(broom)\ntheme_set(theme_classic())\n```\n````\n:::\n\n\n# 1\n\nA clinical trial gave six subjects a placebo and six subjects a new weight loss medication. The response variable is the change in weight *(pounds)* from baseline *(so -2.0 means the subject lost 2 pounds)*. The data for the 12 subjects are:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- tribble(\n    ~Placebo, ~Treatment,\n    2.0, -3.5,\n    -3.1, -1.6,\n    -1.0, -4.6,\n    0.2, -0.9,\n    0.3, -5.1,\n    0.4, 0.1\n)\n\nd |> \n    gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"finkwmcmli\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#finkwmcmli table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#finkwmcmli thead, #finkwmcmli tbody, #finkwmcmli tfoot, #finkwmcmli tr, #finkwmcmli td, #finkwmcmli th {\n  border-style: none;\n}\n\n#finkwmcmli p {\n  margin: 0;\n  padding: 0;\n}\n\n#finkwmcmli .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#finkwmcmli .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#finkwmcmli .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#finkwmcmli .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#finkwmcmli .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#finkwmcmli .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#finkwmcmli .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#finkwmcmli .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#finkwmcmli .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#finkwmcmli .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#finkwmcmli .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#finkwmcmli .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#finkwmcmli .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#finkwmcmli .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#finkwmcmli .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#finkwmcmli .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#finkwmcmli .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#finkwmcmli .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#finkwmcmli .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#finkwmcmli .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#finkwmcmli .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#finkwmcmli .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#finkwmcmli .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#finkwmcmli .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#finkwmcmli .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#finkwmcmli .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#finkwmcmli .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#finkwmcmli .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#finkwmcmli .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#finkwmcmli .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#finkwmcmli .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#finkwmcmli .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#finkwmcmli .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#finkwmcmli .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#finkwmcmli .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#finkwmcmli .gt_left {\n  text-align: left;\n}\n\n#finkwmcmli .gt_center {\n  text-align: center;\n}\n\n#finkwmcmli .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#finkwmcmli .gt_font_normal {\n  font-weight: normal;\n}\n\n#finkwmcmli .gt_font_bold {\n  font-weight: bold;\n}\n\n#finkwmcmli .gt_font_italic {\n  font-style: italic;\n}\n\n#finkwmcmli .gt_super {\n  font-size: 65%;\n}\n\n#finkwmcmli .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#finkwmcmli .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#finkwmcmli .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#finkwmcmli .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#finkwmcmli .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#finkwmcmli .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#finkwmcmli .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Placebo\">Placebo</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Treatment\">Treatment</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Placebo\" class=\"gt_row gt_right\">2.0</td>\n<td headers=\"Treatment\" class=\"gt_row gt_right\">-3.5</td></tr>\n    <tr><td headers=\"Placebo\" class=\"gt_row gt_right\">-3.1</td>\n<td headers=\"Treatment\" class=\"gt_row gt_right\">-1.6</td></tr>\n    <tr><td headers=\"Placebo\" class=\"gt_row gt_right\">-1.0</td>\n<td headers=\"Treatment\" class=\"gt_row gt_right\">-4.6</td></tr>\n    <tr><td headers=\"Placebo\" class=\"gt_row gt_right\">0.2</td>\n<td headers=\"Treatment\" class=\"gt_row gt_right\">-0.9</td></tr>\n    <tr><td headers=\"Placebo\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"Treatment\" class=\"gt_row gt_right\">-5.1</td></tr>\n    <tr><td headers=\"Placebo\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"Treatment\" class=\"gt_row gt_right\">0.1</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nConduct a Bayesian analysis to compare the means of these two groups. Would you say the treatment is effective? Is your conclusion sensitive to the prior?\n\n---\n\n**Solution:** We use the comparison of two normal means with equal unknown variance from page 123 in the book. The model uses a flat, Jeffreys' prior.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nY1 <- d$Placebo\nY2 <- d$Treatment\n# Y2 is the n2-vector of data for group 2\n# Statistics from group 1\nYbar1 <- mean(Y1)\ns21 <- mean((Y1 - Ybar1)^2)\nn1 <- length(Y1)\n# Statistics from group 2\nYbar2 <- mean(Y2)\ns22 <- mean((Y2 - Ybar2)^2)\nn2 <- length(Y2)\ndelta_hat <- Ybar2 - Ybar1\ns2 <- (n1 * s21 + n2 * s22) / (n1 + n2)\nscale <- sqrt(s2) * sqrt(1 / n1 + 1 / n2)\ndf <- n1 + n2\ncred_int <- delta_hat + scale * qt(c(0.025, 0.975), df = df)\ncred_int\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -4.6058799 -0.1941201\n```\n\n\n:::\n:::\n\n\nThe credible interval does not include 0, so it seems that the treatment is effective. Let's compare to harsher priors.\n\nWe will fit the model\n\n$$\nY_i\\vert\\mu, \\sigma^2 \\sim \\mathrm{Normal}(\\mu,\\sigma^2),\\quad i=1,\\dots,n,\n$$\n\nand\n\n$$\nY_i\\vert\\mu,\\delta, \\sigma^2 \\sim \\mathrm{Normal}(\\mu+\\delta,\\sigma^2),\\quad i=n+1,\\dots,n+m,\n$$\n\nwhere\n\n$$\n\\begin{gathered}\n\\mu,\\delta\\sim\\mathrm{Normal}(0, 100^2) \\\\\n\\sigma^2\\sim\\mathrm{InvGamma}(a, b).\n\\end{gathered}\n$$\n\nwhere we let $a$ and $b$ vary from 0.01 to 10. Below, we create the function `calculate_p_delta()` that allows us to easily compare many different priors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncalculate_p_delta <- function(a, b) {\n    data = list(\n        Y1 = d$Placebo,\n        Y2 = d$Treatment,\n        n = nrow(d),\n        m = nrow(d),\n        a = a,\n        b = b\n    )\n    model_string <- textConnection(\"model{\n    # Likelihood\n    for (i in 1:n) {\n        Y1[i] ~ dnorm(mu, tau)\n    }\n    \n    for (i in 1:m) {\n        Y2[i] ~ dnorm(mu + delta, tau)\n    }\n    # Priors\n    mu ~ dnorm(0, 0.01^2)\n    delta ~ dnorm(0, 0.01^2)\n    tau ~ dgamma(a, b)\n    sigma2 <- 1 / tau\n}\")\n    \n    \n    model <- jags.model(\n        model_string,\n        data = data,\n        n.chains = 4,\n        quiet = TRUE\n    )\n    \n    update(model, 10000, progress.bar = \"none\")\n    \n    params <- c(\"mu\", \"delta\", \"sigma2\")\n    samples <- coda.samples(\n        model,\n        variable.names = params,\n        n.iter = 10000,\n        progress.bar = \"none\"\n    )\n    \n    posterior_jags <- samples |> \n        as_draws_df()\n    \n    p_lower <- posterior_jags |> \n        subset_draws(variable = \"delta\") |> \n        summarise_draws(\"P(delta < 0)\" = function(x) mean(x < 0)) |> \n        pull(`P(delta < 0)`)\n    \n    sigma2 <- posterior_jags |> \n        subset_draws(variable = \"sigma2\") |> \n        summarise_draws(mean) |> \n        pull(mean)\n    tibble(\n        delta_p = p_lower,\n        sigma2 = sigma2\n    )\n}\n\nvalues <- c(0.01, 0.1, 0.3, 1, 3, 5, 7, 10)\n\nresults <- crossing(\n    a = values,\n    b = values\n) |> \n    mutate(\n        results = map2(a, b, calculate_p_delta)\n    ) |> \n    unnest(results)\n```\n:::\n\n\nWe see that for higher values of $a$ and $b$, we become more and more sure that $\\delta < 0$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresults |> \n    ggplot(aes(a, delta_p)) +\n    geom_line(aes(col = b, group = b)) +\n    scale_y_continuous(\n        labels = label_percent()\n    ) +\n    scale_x_continuous(\n        breaks = breaks_pretty()\n    ) +\n    labs(\n        title = expression(paste(P(delta < 0), \" is very sensitive to the priors we put on our variance\")),\n        y = expression(P(delta < 0))\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nThis seems to be because for higher values of $a$ and $b$, we pull the posterior distribution of $\\sigma^2$ towards lower values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresults |> \n    ggplot(aes(sigma2, delta_p)) +\n    geom_line() +\n    scale_y_continuous(\n        labels = label_percent()\n    ) +\n    scale_x_continuous(\n        breaks = breaks_pretty()\n    ) +\n    labs(\n        title = expression(paste()),\n        y = expression(P(delta < 0)),\n        x = expression(paste(\"Posterior mean of \", sigma^2))\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n---\n\n# 2\n\nLoad the classic Boston Housing Data in R:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(Boston, package = \"MASS\")\nd <- Boston |> as_tibble()\n```\n:::\n\n\nThe response variable is `medv`, the median value of owner-occupied homes *(in $1,000s)*, and the other 13 variables are covariates that describe the neighborhood.\n\n\na. Fit a Bayesian linear regression model with uninformative Gaussian priors for the regression coefficients. Verify the MCMC sampler has converged, and summarize the posterior distribution of all regression coefficients.\n\n---\n\n**Solution:** \n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-8_078a321936ed2f77064a5bd560cf103f'}\n\n```{.r .cell-code}\ny <- d$medv |> log()\nX <- d |> select(-medv) |> as.matrix() |> scale()\n\ndata = list(\n    y = y,\n    X = X,\n    n = length(y),\n    p = ncol(X)\n)\nmodel_string <- textConnection(\"model{\n    # Likelihood\n    for (i in 1:n) {\n        y[i] ~ dnorm(mu[i], tau)\n        mu[i] = alpha + inprod(X[i, ], beta)\n    }\n    for (i in 1:p) {\n        beta[i] ~ dnorm(0, 0.00001)\n    }\n    alpha ~ dnorm(0, 0.00001)\n    tau ~ dgamma(0.001, 0.001)\n    sigma2 <- 1 / tau\n}\")\n\n\nmodel <- jags.model(\n    model_string,\n    data = data,\n    n.chains = 4,\n    quiet = TRUE\n)\n\nupdate(model, 10000, progress.bar = \"none\")\n\nparams <- c(\"alpha\", \"beta\", \"sigma2\")\nsamples <- coda.samples(\n    model,\n    variable.names = params,\n    n.iter = 10000,\n    progress.bar = \"none\"\n)\n\nposterior_jags <- samples |> \n    as_draws_df()\n```\n:::\n\n\nWe see from the table and trace plots below that our sampler has converged.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_jags |> \n    summarise_draws() |> \n    gt() |> \n    fmt_number()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"nrcdyzcaup\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#nrcdyzcaup table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#nrcdyzcaup thead, #nrcdyzcaup tbody, #nrcdyzcaup tfoot, #nrcdyzcaup tr, #nrcdyzcaup td, #nrcdyzcaup th {\n  border-style: none;\n}\n\n#nrcdyzcaup p {\n  margin: 0;\n  padding: 0;\n}\n\n#nrcdyzcaup .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#nrcdyzcaup .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#nrcdyzcaup .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#nrcdyzcaup .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#nrcdyzcaup .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nrcdyzcaup .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nrcdyzcaup .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nrcdyzcaup .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#nrcdyzcaup .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#nrcdyzcaup .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#nrcdyzcaup .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#nrcdyzcaup .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#nrcdyzcaup .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#nrcdyzcaup .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#nrcdyzcaup .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#nrcdyzcaup .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#nrcdyzcaup .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#nrcdyzcaup .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#nrcdyzcaup .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nrcdyzcaup .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#nrcdyzcaup .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#nrcdyzcaup .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#nrcdyzcaup .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nrcdyzcaup .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#nrcdyzcaup .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#nrcdyzcaup .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nrcdyzcaup .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nrcdyzcaup .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#nrcdyzcaup .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nrcdyzcaup .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#nrcdyzcaup .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nrcdyzcaup .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nrcdyzcaup .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nrcdyzcaup .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nrcdyzcaup .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nrcdyzcaup .gt_left {\n  text-align: left;\n}\n\n#nrcdyzcaup .gt_center {\n  text-align: center;\n}\n\n#nrcdyzcaup .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#nrcdyzcaup .gt_font_normal {\n  font-weight: normal;\n}\n\n#nrcdyzcaup .gt_font_bold {\n  font-weight: bold;\n}\n\n#nrcdyzcaup .gt_font_italic {\n  font-style: italic;\n}\n\n#nrcdyzcaup .gt_super {\n  font-size: 65%;\n}\n\n#nrcdyzcaup .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#nrcdyzcaup .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#nrcdyzcaup .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#nrcdyzcaup .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#nrcdyzcaup .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#nrcdyzcaup .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#nrcdyzcaup .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mad\">mad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q5\">q5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q95\">q95</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rhat\">rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_bulk\">ess_bulk</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_tail\">ess_tail</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">alpha</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">3.03</td>\n<td headers=\"median\" class=\"gt_row gt_right\">3.03</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">3.02</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">3.05</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">39,701.44</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">38,755.22</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[1]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−0.09</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−0.09</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.11</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−0.07</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">14,560.74</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">23,748.08</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[2]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.05</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">9,752.13</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">18,207.50</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[3]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.01</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.05</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">5,318.65</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">11,686.64</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[4]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">30,897.64</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">37,311.90</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[5]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−0.09</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−0.09</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.12</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−0.06</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">6,543.03</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">11,980.18</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[6]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.06</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.06</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.08</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">10,022.29</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">20,177.68</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[7]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.02</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">8,572.99</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">16,048.64</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[8]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−0.10</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−0.10</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.13</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−0.08</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">6,817.62</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">12,809.13</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[9]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.12</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.12</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.09</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.16</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">2,909.60</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">6,358.69</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[10]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−0.11</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−0.11</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.15</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−0.06</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">2,742.38</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">5,907.06</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[11]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−0.08</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−0.08</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.10</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−0.06</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">13,296.12</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">23,371.60</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[12]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.05</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">24,180.26</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">32,833.75</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[13]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−0.21</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−0.21</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.23</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−0.18</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">8,338.21</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">16,662.67</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">35,405.06</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">38,925.32</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_jags |> \n    mcmc_trace()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n\n---\n\nb. Perform a classic least squares *(e.g. using the `lm` function in `R`)*. Compare the results numerically and conceptually with the Bayesian results.\n\n---\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- lm(y ~ X)\n\nresults_ols <- tidy(m, conf.int = T) |> \n    filter(term != \"(Intercept)\") |> \n    select(\n        term,\n        mean = estimate, \n        lower = conf.low,\n        upper = conf.high\n    ) |> \n    mutate(\n        term = glue(\"beta[{row_number()}]\"),\n        type = \"OLS\"\n    )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nresults_jags <- posterior_jags |>\n    summarise_draws() |> \n    filter(\n        str_detect(variable, \"beta\")\n    ) |> \n    select(\n        term = variable,\n        mean, \n        lower = q5,\n        upper = q95\n    ) |> \n    mutate(\n        type = \"JAGS\"\n    )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nresults_ols |> \n    bind_rows(\n        results_jags\n    ) |> \n    mutate(\n        term = fct_reorder(term, parse_number(term))\n    ) |> \n    ggplot(aes(term, mean, ymin = lower, ymax = upper, col = type)) +\n    geom_pointrange(position = position_dodge(0.7)) +\n    coord_flip() +\n    labs(\n        title = \"Comparing JAGS and OLS results\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nNumerically, we see that the results are nearly identical to the results from our JAGS sampler. This should not come as a surprise as we used nearly flat priors. \n\nConceptually, the Bayesian results let us infer by updating our subjective knowledge of the Boston housing data. A frequentist way of thinking would not let us say anything about these specific results, rather that if we were to repeat this analysis on similarly obtained data an infinite amount of times and based our decisions on those results, we could put bounds on how often our decisions would be wrong.\n\n---\n\n\nc. Refit the Bayesian model with double exponential priors for the regression coefficients, and discuss how the results differ from the analysis with uninformative priors.\n\n---\n\n**Solution:**\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-14_e7d3d7b20654de75c5e19c040aa848ba'}\n\n```{.r .cell-code}\ny <- d$medv |> log()\nX <- d |> select(-medv) |> as.matrix() |> scale()\n\ndata = list(\n    y = y,\n    X = X,\n    n = length(y),\n    p = ncol(X)\n)\nmodel_string <- textConnection(\"model{\n    # Likelihood\n    for (i in 1:n) {\n        y[i] ~ dnorm(mu[i], tau)\n        mu[i] = alpha + inprod(X[i, ], beta)\n    }\n    for (i in 1:p) {\n        beta[i] ~ ddexp(0, tau * tau_beta)\n    }\n    alpha ~ dnorm(0, 0.00001)\n    tau ~ dgamma(0.001, 0.001)\n    tau_beta ~ dgamma(0.001, 0.001)\n    sigma2 <- 1 / tau\n}\")\n\n\nmodel <- jags.model(\n    model_string,\n    data = data,\n    n.chains = 4,\n    quiet = TRUE\n)\n\nupdate(model, 10000, progress.bar = \"none\")\n\nparams <- c(\"alpha\", \"beta\", \"sigma2\", \"tau_beta\")\nsamples <- coda.samples(\n    model,\n    variable.names = params,\n    n.iter = 10000,\n    progress.bar = \"none\"\n)\n\nposterior_laplace <- samples |> \n    as_draws_df()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_jags |> \n    summarise_draws() |> \n    gt() |> \n    fmt_number()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ykaguemcxd\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ykaguemcxd table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ykaguemcxd thead, #ykaguemcxd tbody, #ykaguemcxd tfoot, #ykaguemcxd tr, #ykaguemcxd td, #ykaguemcxd th {\n  border-style: none;\n}\n\n#ykaguemcxd p {\n  margin: 0;\n  padding: 0;\n}\n\n#ykaguemcxd .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ykaguemcxd .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ykaguemcxd .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ykaguemcxd .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ykaguemcxd .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ykaguemcxd .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ykaguemcxd .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ykaguemcxd .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ykaguemcxd .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ykaguemcxd .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ykaguemcxd .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ykaguemcxd .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ykaguemcxd .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ykaguemcxd .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ykaguemcxd .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ykaguemcxd .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ykaguemcxd .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ykaguemcxd .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ykaguemcxd .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ykaguemcxd .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ykaguemcxd .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ykaguemcxd .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ykaguemcxd .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ykaguemcxd .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ykaguemcxd .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ykaguemcxd .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ykaguemcxd .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ykaguemcxd .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ykaguemcxd .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ykaguemcxd .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ykaguemcxd .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ykaguemcxd .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ykaguemcxd .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ykaguemcxd .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ykaguemcxd .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ykaguemcxd .gt_left {\n  text-align: left;\n}\n\n#ykaguemcxd .gt_center {\n  text-align: center;\n}\n\n#ykaguemcxd .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ykaguemcxd .gt_font_normal {\n  font-weight: normal;\n}\n\n#ykaguemcxd .gt_font_bold {\n  font-weight: bold;\n}\n\n#ykaguemcxd .gt_font_italic {\n  font-style: italic;\n}\n\n#ykaguemcxd .gt_super {\n  font-size: 65%;\n}\n\n#ykaguemcxd .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ykaguemcxd .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ykaguemcxd .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ykaguemcxd .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ykaguemcxd .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ykaguemcxd .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ykaguemcxd .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mad\">mad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q5\">q5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q95\">q95</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rhat\">rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_bulk\">ess_bulk</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_tail\">ess_tail</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">alpha</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">3.03</td>\n<td headers=\"median\" class=\"gt_row gt_right\">3.03</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">3.02</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">3.05</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">39,701.44</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">38,755.22</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[1]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−0.09</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−0.09</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.11</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−0.07</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">14,560.74</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">23,748.08</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[2]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.05</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">9,752.13</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">18,207.50</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[3]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.01</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.05</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">5,318.65</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">11,686.64</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[4]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">30,897.64</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">37,311.90</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[5]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−0.09</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−0.09</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.12</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−0.06</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">6,543.03</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">11,980.18</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[6]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.06</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.06</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.08</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">10,022.29</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">20,177.68</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[7]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.02</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">8,572.99</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">16,048.64</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[8]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−0.10</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−0.10</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.13</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−0.08</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">6,817.62</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">12,809.13</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[9]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.12</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.12</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.09</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.16</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">2,909.60</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">6,358.69</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[10]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−0.11</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−0.11</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.15</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−0.06</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">2,742.38</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">5,907.06</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[11]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−0.08</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−0.08</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.10</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−0.06</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">13,296.12</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">23,371.60</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[12]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.02</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.05</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">24,180.26</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">32,833.75</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[13]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−0.21</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−0.21</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−0.23</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−0.18</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">8,338.21</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">16,662.67</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"median\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">0.04</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">35,405.06</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">38,925.32</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_jags |> \n    mcmc_dens()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nThe results are very similar to the ones in *a.* This is not really surprising as we are not really putting very strict priors on the coefficients, and we have a lot of data. The main difference between using double exponential priors vs normal priors comes when we use very tight priors. Double exponential priors are more prone to pull coefficients towards 0, whereas normal priors will never pull a coefficient completely towards zero.\n\n---\n\nd. Fit a Bayesian linear regression model in *a.* using only the first 500 observations and compute the posterior predictive distribution for the final 6 observations. Plot the posterior predictive distribution versus the actual value for these 6 observations and comment on whether the predictions are reasonable.\n\n---\n\n**Solution:**\n\n---\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-17_44b48d98036f078537d2e5fffba59e89'}\n\n```{.r .cell-code}\nX_train <- X[1:500, ]\ny_train <- y[1:500]\n\nn_train <- length(y_train)\n\nX_test <- X[501:506, ]\ny_test <- y[501:506]\n\nn_test <- length(y_test)\n\n\ndata <- list(\n    y_train = y_train,\n    n_train = n_train,\n    n_test = n_test,\n    p = ncol(X_train),\n    X_train = X_train,\n    X_test = X_test\n)\n\nmodel_string <- textConnection(\"model{\n   # Likelihood\n    for(i in 1:n_train){\n      y_train[i] ~ dnorm(mu_train[i],taue)\n      mu_train[i] <- alpha+ inprod(X_train[i,], beta[])\n    }\n    \n    # Prediction\n    for(i in 1:n_test){\n      y_test[i] ~ dnorm(mu_test[i],taue)\n      mu_test[i] <- alpha+ inprod(X_test[i,], beta[])\n    }\n    \n   # Priors\n    for(j in 1:p){\n      beta[j] ~ dnorm(0,0.001)\n    }\n    alpha ~ dnorm(0,0.001)\n    taue  ~ dgamma(0.1, 0.1)\n }\")\n\nmodel <- jags.model(\n    model_string,\n    data = data,\n    quiet = TRUE\n)\n\nupdate(model, 10000, progress.bar = \"none\")\n\nsamples <- coda.samples(\n    model,\n    variable.names = c(\"alpha\", \"beta\", \"y_test\"),\n    n.iter = 50000, progress.bar = \"none\"\n)\n```\n:::\n\n\nWe see on our plot below that our predictions are fairly good. Most of the points (5 ouf of 6) are inside our predictive interval\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples |> \n    as_draws_df() |> \n    subset_draws(variable = \"y_test\") |> \n    mcmc_areas(\n        prob = 0.5,\n        prob_outer = 0.95\n    ) +\n    geom_segment(\n        data = tibble(\n            x = y_test,\n            xend = y_test,\n            y = 6:1,\n            yend = 6:1 + 1\n        ),\n        aes(\n            x = x,\n            xend = xend,\n            y = y,\n            yend = yend\n        )\n    ) +\n    scale_x_continuous(\n        limits = c(2.4, 3.7)\n    ) +\n    labs(\n        title = \"Compering our posterior predictive density to the test data\",\n        subtitle = \"The blue ribbon and white density are respectively 50% and 95% credible intervals.\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}