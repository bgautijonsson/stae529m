{
  "hash": "c1f0166b6d9580135b2b55c4dde3eca2",
  "result": {
    "markdown": "---\ntitle: \"Homework #2 (Solution)\"\nsubtitle: Chapters 2.1, 2.2, 2.3 and 2.4\ndescription: |\n    **Assigned:** Friday, September 1st, 2023 <br>\n    **Due:** Friday, September 8th, 2023\nauthor: \n    -   name: Brynjólfur Gauti Guðrúnar Jónsson\n        email: brynjolfur@hi.is\n        url: https://www.hi.is/staff/brynjolfur\n        affiliation: \n        -   name: School of Engineering and Natural Sciences, University of Iceland\n            city: Reykjavík\n            url: https://english.hi.is/school_of_engineering_and_natural_sciences\n# Change this to pdf if you'd rather work in that format\nformat: html \neditor: source\ntitle-block-banner: true\n#### The setting below makes our HTML document self-contained so that we can turn it in ####\n#### UNCOMMENT THE LONE BELOW SO THAT YOU CAN TURN IN YOUR HTML DOCUMENT ###################\n# embed-resources: true \n---\n\n{{< downloadthis index.qmd dname=\"hw2_solution\" label=\"Download the Quarto document used to render this file\" type=primary class=downloadbutton >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyr)\nlibrary(dplyr, warn.conflicts = FALSE)\nlibrary(ggplot2)\nlibrary(gt)\nlibrary(glue)\ntheme_set(theme_classic())\n```\n:::\n\n\n\n# Chapter 2.4\n\n## Exercise 1\n\nAssume $Y_1, \\dots, Y_n \\vert \\mu \\overset{\\mathrm{iid}}{\\sim}$ where $\\sigma^2$ is fixed and the unknown mean $\\mu$ has prior $\\mu\\sim\\mathrm{Normal}(0, \\sigma^2/m)$\n\na. Give a 95% posterior interval for $\\mu$\n\n-----\n\n**Solution:** From chapter 2.1.3 and derivations in Appendix 3 of the book, we immediately write our posterior as\n\n$$\n\\begin{aligned}\n\\mu\\vert \\mathbf Y &\\sim \\mathrm{N}(w \\bar Y + (1 - w)\\mu_0, \\frac{\\sigma^2}{n + m}) \\\\\n&= \\mathrm{N}(w \\bar Y, \\frac{\\sigma^2}{n + m}), \\quad \\mu_0 = 0,\n\\end{aligned}\n$$\n\nwhere $w = n/(n+m) \\in [0, 1]$. A 95% posterior interval for $\\mu$ is any interval, $(l, u)$ such that\n\n$$\nP(l < \\mu < u) = 0.95\n$$\n\nLet $z_\\alpha$ denote the number such that if $Z \\sim \\mathrm{N}(0, 1)$, then\n\n$$\nP(Z < z_\\alpha) = \\alpha.\n$$\n\nWe can use `R` to find the values of $z_{0.025}$ and $z_{0.975}$\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\nqnorm(0.025)\nqnorm(0.975)\n```\n````\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -1.959964\n[1] 1.959964\n```\n:::\n:::\n\n\n\nSince $\\mu$ is normally distributed with mean $w\\hat Y$ and variance $\\sigma^2/(n+m)$, we know that\n\n$$\n\\frac{\\mu - w\\hat Y}{\\sigma/\\sqrt{n+m}} \\sim \\mathrm{N}(0, 1)\n$$\nWe can thus deduce our interval by writing\n\n$$\n\\begin{aligned}\n&P(-1.96 < \\frac{\\mu - w\\hat Y}{\\sigma/\\sqrt{n+m}} < 1.96) = 0.95 \\\\\n\\rightarrow\\quad &P(-1.96\\frac{\\sigma}{\\sqrt{n+m}} < \\mu - w\\hat Y < 1.96\\frac{\\sigma}{\\sqrt{n+m}}) = 0.95 \\\\\n\\rightarrow\\quad &P(w\\hat Y -1.96\\frac{\\sigma}{\\sqrt{n+m}} < \\mu < w\\hat Y + 1.96\\frac{\\sigma}{\\sqrt{n+m}}) = 0.95.\n\\end{aligned}\n$$\n\nThis gives us the 95% posterior interval\n\n$$\n(w\\hat Y -1.96\\frac{\\sigma}{\\sqrt{n+m}}, w\\hat Y + 1.96\\frac{\\sigma}{\\sqrt{n+m}}).\n$$\n\n-----\n\nb. Select a value of $m$ and argue that for this choice your 95% posterior credible interval has frequentist coverage 0.95 (that is, if you draw many samples of size $n$ and compute the 95% interval following the formula in *a.* for each sample, in the long run 95% of the intervals will contain the true value of $\\mu$).\n\n-----\n\n**Solution:** If we let $m\\rightarrow 0$, our prior variance increases to $\\infty$ and the posterior mean becomes the sample mean, with 95% posterior credibility interval \n\n$$\n(\\hat Y -1.96\\frac{\\sigma}{\\sqrt{n}}, \\hat Y + 1.96\\frac{\\sigma}{\\sqrt{n}}).\n$$\n\nSince we assume a normal distribution, and the variance $\\sigma^2$ is constant and assumed known, then the above interval is exactly the same as the confidence interval for $\\mu$. Thus, according to our chosen model and using the frequentist way of thinking, the true value of mu will fall inside an interval computed according to this formula in 95% of trials (in the long run) in a repeated sampling setup.\n\n\n-----\n\n## Exercise 2\n\nThe Major League Baseball player Reggie Jackson is known as \"Mr October\" for his outstanding performances in the World Series (which takes place in October). Over his long career he played in 2820 regular-season games and hit 563 home runs in these games (a player can hit 0, 1, 2, ... home runs in a game). He also played in 27 world series games and hit 10 home runs in these games. \n\nAssuming uninformative conjugate priors, summarize the posterior distribution of his home-run rate in the regular season and World Series. Is there sufficient evidence to claim that he performs better in the World Series?\n\n-----\n\n**Solution:** We are dealing with numbers of events over fixed periods of time, so the Poisson-gamma model is the logical choice.\n\nOur Poisson likelihood with rate $\\lambda$ over a period of time $T$ is\n\n$$\nf(Y\\vert \\lambda) = \\frac{(T\\lambda)^Y}{Y!} \\exp(-T\\lambda),\n$$\n\nand our Gamma prior is\n\n$$\n\\pi(\\lambda \\vert a, b) = \\frac{b^a}{\\Gamma(a)}\\lambda^{a-1}\\exp\\left(-\\lambda b\\right).\n$$\n\nChapter 2.1.2 in the book tells us that our posterior will take the form of a Gamma(A, B) distribution where $A = Y + a$ and $B = T + b$. We want to use a non-informative prior, so we choose $a=0.01$ and $b=0.01$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nT1 <- 2820\nY1 <- 563\n\nT2 <- 27\nY2 <- 10\n\na <- 0.01\nb <- 0.01\n\n\nA1 <- Y1 + a\nB1 <- T1 + b\nA2 <- Y2 + a\nB2 <- T2 + b\n```\n:::\n\n\nThe means for the two posterior distributions are\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresults <- tibble(\n    Type = c(\"Regular-season\", \"World series\"),\n    A = c(A1, A2),\n    B = c(B1, B2),\n    Mean = A / B,\n    Lower = qgamma(0.025, shape = A, rate = B),\n    Upper = qgamma(0.975, shape = A, rate = B)\n) \n\n# Table\nresults |> \n    gt() |> \n    tab_spanner(columns = c(Lower, Upper), label = \"95% Posterior Interval\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ncyxmjgcxg\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ncyxmjgcxg table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ncyxmjgcxg thead, #ncyxmjgcxg tbody, #ncyxmjgcxg tfoot, #ncyxmjgcxg tr, #ncyxmjgcxg td, #ncyxmjgcxg th {\n  border-style: none;\n}\n\n#ncyxmjgcxg p {\n  margin: 0;\n  padding: 0;\n}\n\n#ncyxmjgcxg .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ncyxmjgcxg .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ncyxmjgcxg .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ncyxmjgcxg .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ncyxmjgcxg .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ncyxmjgcxg .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ncyxmjgcxg .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ncyxmjgcxg .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ncyxmjgcxg .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ncyxmjgcxg .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ncyxmjgcxg .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ncyxmjgcxg .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ncyxmjgcxg .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ncyxmjgcxg .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ncyxmjgcxg .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ncyxmjgcxg .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ncyxmjgcxg .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ncyxmjgcxg .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ncyxmjgcxg .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ncyxmjgcxg .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ncyxmjgcxg .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ncyxmjgcxg .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ncyxmjgcxg .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ncyxmjgcxg .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ncyxmjgcxg .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ncyxmjgcxg .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ncyxmjgcxg .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ncyxmjgcxg .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ncyxmjgcxg .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ncyxmjgcxg .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ncyxmjgcxg .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ncyxmjgcxg .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ncyxmjgcxg .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ncyxmjgcxg .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ncyxmjgcxg .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ncyxmjgcxg .gt_left {\n  text-align: left;\n}\n\n#ncyxmjgcxg .gt_center {\n  text-align: center;\n}\n\n#ncyxmjgcxg .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ncyxmjgcxg .gt_font_normal {\n  font-weight: normal;\n}\n\n#ncyxmjgcxg .gt_font_bold {\n  font-weight: bold;\n}\n\n#ncyxmjgcxg .gt_font_italic {\n  font-style: italic;\n}\n\n#ncyxmjgcxg .gt_super {\n  font-size: 65%;\n}\n\n#ncyxmjgcxg .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ncyxmjgcxg .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ncyxmjgcxg .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ncyxmjgcxg .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ncyxmjgcxg .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ncyxmjgcxg .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ncyxmjgcxg .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"Type\">Type</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"A\">A</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"B\">B</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"Mean\">Mean</th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"95% Posterior Interval\">\n        <span class=\"gt_column_spanner\">95% Posterior Interval</span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Lower\">Lower</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Upper\">Upper</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Type\" class=\"gt_row gt_left\">Regular-season</td>\n<td headers=\"A\" class=\"gt_row gt_right\">563.01</td>\n<td headers=\"B\" class=\"gt_row gt_right\">2820.01</td>\n<td headers=\"Mean\" class=\"gt_row gt_right\">0.1996482</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">0.1834953</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">0.2164728</td></tr>\n    <tr><td headers=\"Type\" class=\"gt_row gt_left\">World series</td>\n<td headers=\"A\" class=\"gt_row gt_right\">10.01</td>\n<td headers=\"B\" class=\"gt_row gt_right\">27.01</td>\n<td headers=\"Mean\" class=\"gt_row gt_right\">0.3706035</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">0.1777961</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">0.6330224</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\nWe could also sample from the two distributions and use those samples to summarize the difference between the two distributions\n\n\n::: {.cell}\n\n```{.r .cell-code}\nX1 <- rgamma(n = 1e5, shape = A1, rate = B1)\nX2 <- rgamma(n = 1e5, shape = A2, rate = B2)\n\np_greater <- mean(X2 > X1)\n\ntibble(\n    Regular = X1,\n    Worldseries = X2,\n    Difference = X2 - X1\n) |> \n    ggplot(aes(x = Difference)) +\n    geom_histogram(\n        alpha = 0.5,\n        color = \"black\"\n    ) +\n    geom_vline(\n        xintercept = 0, \n        lty = 2\n    ) +\n    coord_cartesian(expand = FALSE) +\n    labs(\n        x = expression(theta[2]-theta[1]),\n        y = NULL,\n        title = \"How much better is Reggie Jackson's home run rate during the World Series?\",\n        subtitle = \"The evidence heavily favors the claim that Reggie Jackson does better in the World Series\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nFinally, we calculate the probability that Reggie Jackson's performance is better in the World Series than in the regular season (assuming our chosen model and priors).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(X2 > X1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.95189\n```\n:::\n:::\n\n\n\n\n-----\n\n## Exercise 4\n\nAssume that $Y\\vert\\theta \\sim \\mathrm{NegBinomial}(\\theta, m)$ and $\\theta\\sim\\mathrm{Beta}(a, b)$.\n\na. Derive the posterior of $\\theta$\n\n-----\n\n**Solution:** Our Negative Binomial likelihood can be written\n\n$$\n\\begin{aligned}\nf(Y\\vert m, \\theta) &= \\binom{Y+m-1}{Y}\\theta^m(1-\\theta)^Y \\\\\n&\\propto \\theta^m(1-\\theta)^Y.\n\\end{aligned}\n$$\n\nThe beta prior is written\n\n$$\n\\begin{aligned}\n\\pi(\\theta \\vert a, b) \\propto \\theta^{a-1}(1-\\theta)^{b-1}.\n\\end{aligned}\n$$\n\nWe see that when we multiply these two together, our posterior will become\n\n$$\n\\begin{aligned}\np(\\theta \\vert Y) &\\propto f(Y\\vert\\theta)\\pi(\\theta) \\\\\n&\\propto \\theta^m(1-\\theta)^Y \\cdot \\theta^{a-1}(1 - \\theta)^{b-1} \\\\\n&= \\theta^{m + a - 1}(1 - \\theta)^{Y + b - 1},\n\\end{aligned}\n$$\n\nwhich is the kernel of a Beta(m + a, Y + b) distribution.\n\n-----\n\nb. Plot the posterior of $\\theta$ and give its 95% credible interval assuming $m = 5$, $Y = 10$, and $a=b=1$.\n\n-----\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nm <- 5\nY <- 10\na <- 1\nb <- 1\n\nA <- m + a\nB <- Y + b\n\nlower <- qbeta(0.025, shape1 = A, shape2 = B)\nupper <- qbeta(0.975, shape1 = A, shape2 = B)\n\nggplot() +\n    stat_function(\n        geom = \"area\",\n        fun = dbeta,\n        args = list(shape1 = A, shape2 = B),\n        alpha = 0.5,\n        xlim = c(lower, upper)\n    ) +\n    stat_function(\n        geom = \"area\",\n        fun = dbeta,\n        args = list(shape1 = A, shape2 = B),\n        alpha = 0.2,\n        xlim = c(0, lower)\n    ) +\n    stat_function(\n        geom = \"area\",\n        fun = dbeta,\n        args = list(shape1 = A, shape2 = B),\n        alpha = 0.2,\n        xlim = c(upper, 1)\n    ) +\n    geom_vline(\n        xintercept = lower,\n        lty = 2\n    ) +\n    geom_vline(\n        xintercept = upper,\n        lty = 2\n    ) +\n    coord_cartesian(expand = FALSE) +\n    labs(\n        x = expression(theta),\n        y = expression(paste(p, \"(\", theta, \"|\", Y, \")\")),\n        title = expression(paste(\"The posterior distribution of \", theta, \" after observing the data Y\")),\n        subtitle = glue(\"The posterior mean is {round(A/(A+B), 3)} and the 95% credible interval is [{round(lower, 3)}, {round(upper, 3)}]\")\n    ) +\n    theme(\n        plot.margin = margin(t = 5, r = 15, b = 5, l = 15)\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n-----\n\n## Exercise 5\n\nOver the past 50 years California has experienced an average of $\\lambda_0=75$ large wildfires per year. For the next 10 years you will record the number of large fires in California and then fit a Poisson/gamma model to these data. Let the rate of large fires in this future period, $\\lambda$, have prior $\\lambda\\sim\\mathrm{Gamma}(a,b)$. Select $a$ and $b$ so that the prior is uninformative with prior variance around 100 and gives prior probability approximately $\\mathrm{Prob}(\\lambda > \\lambda_0) = 0.5$ so that the prior places equal probability on both hypotheses in the test for a change in the rate.\n\n-----\n\n**Solution:**\n\nThe variance of the Gamma(a, b) distribution is $a/b^2$. To find the correct values for $a$ and $b$ we can create a sequence of values with variance 100 and find which pair is closes to giving us $P(\\lambda > \\lambda_0) = 0.5$.\n\nWe first use the equation for the variance to find how $a$ and $b$ must relate to each other.\n\n$$\n\\begin{aligned}\n\\frac{a}{b^2} &= 100 \\\\\n\\rightarrow \\quad a &= 100b^2 \\\\\n\\rightarrow \\quad b &= \\sqrt{a}/10.\n\\end{aligned}\n$$\n\nWe then find a pair that satisfies the second condition by performing the following:\n\n1. Create a grid of values for $a$\n2. Use the fact that $b = \\sqrt a/10$ to calculate the corresponding values for $b$\n3. Use the `R` function `pgamma` to calculate $P(\\lambda > \\lambda_0)$\n4. Find the pair of values for which this probability is closest to 0.5\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_variance <- 100\n\ntibble(\n    a = seq(0, 100, length.out = 1e4),\n    b = sqrt(a) / 10\n) |> \n    mutate(\n        # Calculate the probability\n        prob_greater = pgamma(75, shape = a, rate = b),\n        # Calculate how close probability is to 0.5\n        prob_diff = abs(prob_greater - 0.5)\n    ) |> \n    arrange(prob_diff) |> \n    slice(1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 4\n      a     b prob_greater prob_diff\n  <dbl> <dbl>        <dbl>     <dbl>\n1  56.9 0.754        0.500 0.0000446\n```\n:::\n:::\n\n\nWe see that if we choose $a = 57$ and $b = 0.75$ we get an approximate prior variance of 100 and $P(\\lambda > \\lambda_0) \\approx 0.5$.\n\n-----\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}