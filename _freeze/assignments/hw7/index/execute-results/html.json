{
  "hash": "09da943acc9815fb9403985959495f5a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Homework #7\"\nsubtitle: \"Exercises from Chapter 5.7: 2, 4 and 10\"\ndescription: |\n    **Assigned:** Friday, October 20th, 2023 <br>\n    **Due:** Friday, November 3rd, 2023\nauthor: \n    -   name: Brynjólfur Gauti Guðrúnar Jónsson\n        email: brynjolfur@hi.is\n        url: https://www.hi.is/staff/brynjolfur\n        affiliation: \n        -   name: School of Engineering and Natural Sciences, University of Iceland\n            city: Reykjavík\n            url: https://english.hi.is/school_of_engineering_and_natural_sciences\n# Change this to pdf if you'd rather work in that format\nformat: html \neditor: source\ntitle-block-banner: true\n#### The setting below makes our HTML document self-contained so that we can turn it in ####\n#### UNCOMMENT THE LONE BELOW SO THAT YOU CAN TURN IN YOUR HTML DOCUMENT ###################\n# embed-resources: true \n---\n\n{{< downloadthis index.qmd dname=\"hw7\" label=\"Download the Quarto document used to render this file\" type=primary class=downloadbutton >}}\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| output: hide\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(rjags)\nlibrary(posterior)\nlibrary(bayesplot)\nlibrary(gt)\ntheme_set(theme_classic())\n```\n````\n:::\n\n\n# 2\n\n---\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- na.omit(airquality)\nozone <- d$Ozone\nX <- d[ , c(\"Solar.R\", \"Wind\", \"Temp\")] |> as.matrix() |> scale()\n\ndata <- list(\n    ozone = ozone,\n    X = X,\n    n = nrow(X),\n    p = ncol(X)\n)\n\nmodel_string <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:n) {\n        ozone[i] ~ dnorm(mu[i], tau)\n        mu[i] = alpha + inprod(X[i, ], beta[])\n        Y_rep[i] ~ dnorm(mu[i], tau)\n    }\n    \n    for (i in 1:p) {\n        beta[i] ~ dnorm(0, 0.001)\n    }\n    \n    alpha ~ dnorm(0, 0.001)\n    tau ~ dgamma(0.01, 0.01)\n    sigma2 = 1 / tau;\n    \n}\")\n\nmodel <- jags.model(\n    model_string,\n    data = data,\n    n.chains = 4,\n    quiet = TRUE\n)\n\nupdate(model, 10000)\n\nparams <- c(\"alpha\", \"beta\", \"sigma2\", \"Y_rep\")\nsamples <- coda.samples(\n    model,\n    variable.names = params,\n    n.iter = 10000\n)\n\nposterior_jags <- samples |> \n    as_draws_df()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_jags |> \n    subset_draws(variable = c(\"alpha\", \"beta\", \"sigma2\")) |> \n    summarise_draws() |> \n    gt() |> \n    fmt_number()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"bwpsdznbrm\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#bwpsdznbrm table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#bwpsdznbrm thead, #bwpsdznbrm tbody, #bwpsdznbrm tfoot, #bwpsdznbrm tr, #bwpsdznbrm td, #bwpsdznbrm th {\n  border-style: none;\n}\n\n#bwpsdznbrm p {\n  margin: 0;\n  padding: 0;\n}\n\n#bwpsdznbrm .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bwpsdznbrm .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#bwpsdznbrm .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bwpsdznbrm .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bwpsdznbrm .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bwpsdznbrm .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bwpsdznbrm .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bwpsdznbrm .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bwpsdznbrm .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bwpsdznbrm .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bwpsdznbrm .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bwpsdznbrm .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bwpsdznbrm .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#bwpsdznbrm .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#bwpsdznbrm .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bwpsdznbrm .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bwpsdznbrm .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bwpsdznbrm .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bwpsdznbrm .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bwpsdznbrm .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bwpsdznbrm .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bwpsdznbrm .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#bwpsdznbrm .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bwpsdznbrm .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bwpsdznbrm .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bwpsdznbrm .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bwpsdznbrm .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bwpsdznbrm .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bwpsdznbrm .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bwpsdznbrm .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bwpsdznbrm .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bwpsdznbrm .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bwpsdznbrm .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bwpsdznbrm .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bwpsdznbrm .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bwpsdznbrm .gt_left {\n  text-align: left;\n}\n\n#bwpsdznbrm .gt_center {\n  text-align: center;\n}\n\n#bwpsdznbrm .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bwpsdznbrm .gt_font_normal {\n  font-weight: normal;\n}\n\n#bwpsdznbrm .gt_font_bold {\n  font-weight: bold;\n}\n\n#bwpsdznbrm .gt_font_italic {\n  font-style: italic;\n}\n\n#bwpsdznbrm .gt_super {\n  font-size: 65%;\n}\n\n#bwpsdznbrm .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#bwpsdznbrm .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bwpsdznbrm .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bwpsdznbrm .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bwpsdznbrm .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bwpsdznbrm .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bwpsdznbrm .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mad\">mad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q5\">q5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q95\">q95</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rhat\">rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_bulk\">ess_bulk</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_tail\">ess_tail</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">alpha</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">41.92</td>\n<td headers=\"median\" class=\"gt_row gt_right\">41.94</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.03</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.03</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">38.59</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">45.28</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">40,410.49</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">38,530.47</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[1]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">5.44</td>\n<td headers=\"median\" class=\"gt_row gt_right\">5.44</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.13</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.11</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">1.95</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">8.97</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">33,309.33</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">37,560.25</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[2]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−11.83</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−11.83</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.32</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.32</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−15.64</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−8.03</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">24,745.26</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">33,143.24</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[3]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">15.69</td>\n<td headers=\"median\" class=\"gt_row gt_right\">15.68</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.42</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.41</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">11.69</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">19.64</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">22,000.58</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">31,453.62</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">456.77</td>\n<td headers=\"median\" class=\"gt_row gt_right\">451.10</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">63.54</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">61.07</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">362.89</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">570.20</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">35,198.46</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">37,944.23</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ny_rep <- posterior_jags |> \n    subset_draws(variable = \"Y_rep\") |> \n    resample_draws(ndraws = 200) |> \n    as_draws_matrix()\n\nppc_dens_overlay(ozone, y_rep)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nppc_stat(ozone, y_rep, stat = max)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_jags |> \n    subset_draws(variable = c(\"alpha\", \"beta\")) |> \n    thin_draws(thin = 100)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A draws_df: 100 iterations, 4 chains, and 4 variables\n   alpha beta[1] beta[2] beta[3]\n1     41     6.5     -14      13\n2     41     8.9     -13      14\n3     41     8.6     -16      15\n4     42     5.7     -12      15\n5     41     4.0     -10      15\n6     45     4.7     -12      15\n7     41     3.5     -12      13\n8     43     6.2     -14      16\n9     43     2.3     -14      16\n10    40     4.3     -12      15\n# ... with 390 more draws\n# ... hidden reserved variables {'.chain', '.iteration', '.draw'}\n```\n\n\n:::\n:::\n\n\n\n\n---\n\n# 4\n\n---\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_model <- function(c) {\n    Y <- c(563, 10)\n    N <- c(2820, 27)\n    \n    data <- list(\n        Y = Y,\n        N = N,\n        c = c\n    )\n    \n    model_string1 <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:2) {\n        Y[i] ~ dpois(N[i] * lambda[i])\n        lambda[i] ~ dunif(0, c)\n        like[i] <- dpois(Y[i], lambda[i] * N[i])\n    }\n}\")\n    \n    model_string2 <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:2) {\n        Y[i] ~ dpois(N[i] * lambda)\n        like[i] <- dpois(Y[i], lambda * N[i])\n    }\n    lambda ~ dunif(0, c)\n}\")\n    \n    model1 <- jags.model(\n        model_string1,\n        data = data,\n        n.chains = 4,\n        quiet = TRUE\n    )\n    \n    model2 <- jags.model(\n        model_string2,\n        data = data,\n        n.chains = 4,\n        quiet = TRUE\n    )\n    \n    update(model1, 10000, progress.bar = \"none\")\n    update(model2, 10000, progress.bar = \"none\")\n    \n    params <- c( \"like\")\n    samples <- coda.samples(\n        model1,\n        variable.names = params,\n        n.iter = 10000,\n        progress.bar = \"none\"\n    )\n    \n    DIC1 <- dic.samples(model1, n.iter = 50000, progress.bar = \"none\")\n    DIC1 <- sum(DIC1$deviance + DIC1$penalty)\n    \n    like <- rbind(samples[[1]], samples[[2]], samples[[3]], samples[[4]])\n    fbar <- colMeans(like)\n    Pw <- sum(apply(log(like), 2, var))\n    WAIC1 <- -2 * sum(log(fbar)) + 2 * Pw\n    \n    \n    samples <- coda.samples(\n        model2,\n        variable.names = params,\n        n.iter = 10000\n    )\n    \n    DIC2 <- dic.samples(model2, n.iter = 50000, progress.bar = \"none\")\n    DIC2 <- sum(DIC2$deviance + DIC2$penalty)\n    \n    like <- rbind(samples[[1]], samples[[2]], samples[[3]], samples[[4]])\n    fbar <- colMeans(like)\n    Pw <- sum(apply(log(like), 2, var))\n    WAIC2 <- -2 * sum(log(fbar)) + 2 * Pw\n    \n    tibble(\n        model = c(\"Two lambdas\", \"One lambda\"),\n        DIC = c(DIC1, DIC2),\n        WAIC = c(WAIC1, WAIC2)\n    )\n}\n\nresults <- tibble(\n    c = c(0.1, 1, 10)\n) |> \n    mutate(\n        results = map(c, fit_model)\n    )\n\nresults |> \n    unnest(results) |> \n    mutate(\n        c = str_c(\"c = \", c)\n    ) |> \n    group_by(c) |> \n    gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"uoirppsuus\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#uoirppsuus table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#uoirppsuus thead, #uoirppsuus tbody, #uoirppsuus tfoot, #uoirppsuus tr, #uoirppsuus td, #uoirppsuus th {\n  border-style: none;\n}\n\n#uoirppsuus p {\n  margin: 0;\n  padding: 0;\n}\n\n#uoirppsuus .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#uoirppsuus .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#uoirppsuus .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#uoirppsuus .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#uoirppsuus .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#uoirppsuus .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uoirppsuus .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#uoirppsuus .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#uoirppsuus .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#uoirppsuus .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#uoirppsuus .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#uoirppsuus .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#uoirppsuus .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#uoirppsuus .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#uoirppsuus .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#uoirppsuus .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#uoirppsuus .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#uoirppsuus .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#uoirppsuus .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uoirppsuus .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#uoirppsuus .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#uoirppsuus .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#uoirppsuus .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uoirppsuus .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#uoirppsuus .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#uoirppsuus .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uoirppsuus .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uoirppsuus .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#uoirppsuus .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uoirppsuus .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#uoirppsuus .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uoirppsuus .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#uoirppsuus .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uoirppsuus .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#uoirppsuus .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uoirppsuus .gt_left {\n  text-align: left;\n}\n\n#uoirppsuus .gt_center {\n  text-align: center;\n}\n\n#uoirppsuus .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#uoirppsuus .gt_font_normal {\n  font-weight: normal;\n}\n\n#uoirppsuus .gt_font_bold {\n  font-weight: bold;\n}\n\n#uoirppsuus .gt_font_italic {\n  font-style: italic;\n}\n\n#uoirppsuus .gt_super {\n  font-size: 65%;\n}\n\n#uoirppsuus .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#uoirppsuus .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#uoirppsuus .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#uoirppsuus .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#uoirppsuus .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#uoirppsuus .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#uoirppsuus .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"model\">model</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DIC\">DIC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"WAIC\">WAIC</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"3\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"c = 0.1\">c = 0.1</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"c = 0.1  model\" class=\"gt_row gt_left\">Two lambdas</td>\n<td headers=\"c = 0.1  DIC\" class=\"gt_row gt_right\">244.14174</td>\n<td headers=\"c = 0.1  WAIC\" class=\"gt_row gt_right\">246.60847</td></tr>\n    <tr><td headers=\"c = 0.1  model\" class=\"gt_row gt_left\">One lambda</td>\n<td headers=\"c = 0.1  DIC\" class=\"gt_row gt_right\">242.37652</td>\n<td headers=\"c = 0.1  WAIC\" class=\"gt_row gt_right\">243.64517</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"3\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"c = 1\">c = 1</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"c = 1  model\" class=\"gt_row gt_left\">Two lambdas</td>\n<td headers=\"c = 1  DIC\" class=\"gt_row gt_right\">16.35504</td>\n<td headers=\"c = 1  WAIC\" class=\"gt_row gt_right\">15.68273</td></tr>\n    <tr><td headers=\"c = 1  model\" class=\"gt_row gt_left\">One lambda</td>\n<td headers=\"c = 1  DIC\" class=\"gt_row gt_right\">17.44449</td>\n<td headers=\"c = 1  WAIC\" class=\"gt_row gt_right\">17.20816</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"3\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"c = 10\">c = 10</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"c = 10  model\" class=\"gt_row gt_left\">Two lambdas</td>\n<td headers=\"c = 10  DIC\" class=\"gt_row gt_right\">16.35298</td>\n<td headers=\"c = 10  WAIC\" class=\"gt_row gt_right\">15.79282</td></tr>\n    <tr><td headers=\"c = 10  model\" class=\"gt_row gt_left\">One lambda</td>\n<td headers=\"c = 10  DIC\" class=\"gt_row gt_right\">17.42569</td>\n<td headers=\"c = 10  WAIC\" class=\"gt_row gt_right\">17.23066</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n---\n\n\n# 10\n\n---\n\n**Solution:**\n\n---\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}