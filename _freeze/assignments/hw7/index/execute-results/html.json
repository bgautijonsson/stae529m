{
  "hash": "09da943acc9815fb9403985959495f5a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Homework #7\"\nsubtitle: \"Exercises from Chapter 5.7: 2, 4 and 10\"\ndescription: |\n    **Assigned:** Friday, October 20th, 2023 <br>\n    **Due:** Friday, November 3rd, 2023\nauthor: \n    -   name: Brynjólfur Gauti Guðrúnar Jónsson\n        email: brynjolfur@hi.is\n        url: https://www.hi.is/staff/brynjolfur\n        affiliation: \n        -   name: School of Engineering and Natural Sciences, University of Iceland\n            city: Reykjavík\n            url: https://english.hi.is/school_of_engineering_and_natural_sciences\n# Change this to pdf if you'd rather work in that format\nformat: html \neditor: source\ntitle-block-banner: true\n#### The setting below makes our HTML document self-contained so that we can turn it in ####\n#### UNCOMMENT THE LONE BELOW SO THAT YOU CAN TURN IN YOUR HTML DOCUMENT ###################\n# embed-resources: true \n---\n\n{{< downloadthis index.qmd dname=\"hw7\" label=\"Download the Quarto document used to render this file\" type=primary class=downloadbutton >}}\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| output: hide\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(rjags)\nlibrary(posterior)\nlibrary(bayesplot)\nlibrary(gt)\ntheme_set(theme_classic())\n```\n````\n:::\n\n\n# 2\n\n---\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- na.omit(airquality)\nozone <- d$Ozone\nX <- d[ , c(\"Solar.R\", \"Wind\", \"Temp\")] |> as.matrix() |> scale()\n\ndata <- list(\n    ozone = ozone,\n    X = X,\n    n = nrow(X),\n    p = ncol(X)\n)\n\nmodel_string <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:n) {\n        ozone[i] ~ dnorm(mu[i], tau)\n        mu[i] = alpha + inprod(X[i, ], beta[])\n        Y_rep[i] ~ dnorm(mu[i], tau)\n    }\n    \n    for (i in 1:p) {\n        beta[i] ~ dnorm(0, 0.001)\n    }\n    \n    alpha ~ dnorm(0, 0.001)\n    tau ~ dgamma(0.01, 0.01)\n    sigma2 = 1 / tau;\n    \n}\")\n\nmodel <- jags.model(\n    model_string,\n    data = data,\n    n.chains = 4,\n    quiet = TRUE\n)\n\nupdate(model, 10000)\n\nparams <- c(\"alpha\", \"beta\", \"sigma2\", \"Y_rep\")\nsamples <- coda.samples(\n    model,\n    variable.names = params,\n    n.iter = 10000\n)\n\nposterior_jags <- samples |> \n    as_draws_df()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_jags |> \n    subset_draws(variable = c(\"alpha\", \"beta\", \"sigma2\")) |> \n    summarise_draws() |> \n    gt() |> \n    fmt_number()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"vyrqvqditb\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#vyrqvqditb table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#vyrqvqditb thead, #vyrqvqditb tbody, #vyrqvqditb tfoot, #vyrqvqditb tr, #vyrqvqditb td, #vyrqvqditb th {\n  border-style: none;\n}\n\n#vyrqvqditb p {\n  margin: 0;\n  padding: 0;\n}\n\n#vyrqvqditb .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#vyrqvqditb .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#vyrqvqditb .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#vyrqvqditb .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#vyrqvqditb .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vyrqvqditb .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vyrqvqditb .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#vyrqvqditb .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#vyrqvqditb .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#vyrqvqditb .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#vyrqvqditb .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#vyrqvqditb .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#vyrqvqditb .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#vyrqvqditb .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#vyrqvqditb .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#vyrqvqditb .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#vyrqvqditb .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#vyrqvqditb .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#vyrqvqditb .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vyrqvqditb .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#vyrqvqditb .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#vyrqvqditb .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#vyrqvqditb .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vyrqvqditb .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#vyrqvqditb .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#vyrqvqditb .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vyrqvqditb .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vyrqvqditb .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#vyrqvqditb .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vyrqvqditb .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#vyrqvqditb .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#vyrqvqditb .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vyrqvqditb .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vyrqvqditb .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#vyrqvqditb .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#vyrqvqditb .gt_left {\n  text-align: left;\n}\n\n#vyrqvqditb .gt_center {\n  text-align: center;\n}\n\n#vyrqvqditb .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#vyrqvqditb .gt_font_normal {\n  font-weight: normal;\n}\n\n#vyrqvqditb .gt_font_bold {\n  font-weight: bold;\n}\n\n#vyrqvqditb .gt_font_italic {\n  font-style: italic;\n}\n\n#vyrqvqditb .gt_super {\n  font-size: 65%;\n}\n\n#vyrqvqditb .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#vyrqvqditb .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#vyrqvqditb .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#vyrqvqditb .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#vyrqvqditb .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#vyrqvqditb .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#vyrqvqditb .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mad\">mad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q5\">q5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q95\">q95</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rhat\">rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_bulk\">ess_bulk</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_tail\">ess_tail</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">alpha</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">41.92</td>\n<td headers=\"median\" class=\"gt_row gt_right\">41.92</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.02</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">38.62</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">45.26</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">40,031.89</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">39,473.90</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[1]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">5.45</td>\n<td headers=\"median\" class=\"gt_row gt_right\">5.46</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.13</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.12</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">1.96</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">8.93</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">34,237.81</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">38,242.58</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[2]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−11.84</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−11.84</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.35</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.35</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−15.71</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−8.00</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">24,658.13</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">32,588.06</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[3]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">15.70</td>\n<td headers=\"median\" class=\"gt_row gt_right\">15.70</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.42</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.42</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">11.71</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">19.64</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">22,962.77</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">32,959.03</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">457.05</td>\n<td headers=\"median\" class=\"gt_row gt_right\">451.17</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">64.15</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">62.02</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">363.00</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">571.18</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">37,124.89</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">38,317.18</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ny_rep <- posterior_jags |> \n    subset_draws(variable = \"Y_rep\") |> \n    resample_draws(ndraws = 200) |> \n    as_draws_matrix()\n\nppc_dens_overlay(ozone, y_rep)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nppc_stat(ozone, y_rep, stat = max)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_jags |> \n    subset_draws(variable = c(\"alpha\", \"beta\")) |> \n    thin_draws(thin = 100)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A draws_df: 100 iterations, 4 chains, and 4 variables\n   alpha beta[1] beta[2] beta[3]\n1     45    6.96   -11.6      14\n2     44    4.62   -11.1      15\n3     42    6.90    -9.3      18\n4     41    1.44   -13.0      14\n5     46    0.91    -9.8      15\n6     40    4.74   -10.9      17\n7     41    4.55   -12.3      19\n8     43    3.45    -9.7      15\n9     42    2.18   -10.4      15\n10    34    3.56    -9.4      18\n# ... with 390 more draws\n# ... hidden reserved variables {'.chain', '.iteration', '.draw'}\n```\n\n\n:::\n:::\n\n\n\n\n---\n\n# 4\n\n---\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_model <- function(c) {\n    Y <- c(563, 10)\n    N <- c(2820, 27)\n    \n    data <- list(\n        Y = Y,\n        N = N,\n        c = c\n    )\n    \n    model_string1 <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:2) {\n        Y[i] ~ dpois(N[i] * lambda[i])\n        lambda[i] ~ dunif(0, c)\n        like[i] <- dpois(Y[i], lambda[i] * N[i])\n    }\n}\")\n    \n    model_string2 <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:2) {\n        Y[i] ~ dpois(N[i] * lambda)\n        like[i] <- dpois(Y[i], lambda * N[i])\n    }\n    lambda ~ dunif(0, c)\n}\")\n    \n    model1 <- jags.model(\n        model_string1,\n        data = data,\n        n.chains = 4,\n        quiet = TRUE\n    )\n    \n    model2 <- jags.model(\n        model_string2,\n        data = data,\n        n.chains = 4,\n        quiet = TRUE\n    )\n    \n    update(model1, 10000, progress.bar = \"none\")\n    update(model2, 10000, progress.bar = \"none\")\n    \n    params <- c( \"like\")\n    samples <- coda.samples(\n        model1,\n        variable.names = params,\n        n.iter = 10000,\n        progress.bar = \"none\"\n    )\n    \n    DIC1 <- dic.samples(model1, n.iter = 50000, progress.bar = \"none\")\n    DIC1 <- sum(DIC1$deviance + DIC1$penalty)\n    \n    like <- rbind(samples[[1]], samples[[2]], samples[[3]], samples[[4]])\n    fbar <- colMeans(like)\n    Pw <- sum(apply(log(like), 2, var))\n    WAIC1 <- -2 * sum(log(fbar)) + 2 * Pw\n    \n    \n    samples <- coda.samples(\n        model2,\n        variable.names = params,\n        n.iter = 10000\n    )\n    \n    DIC2 <- dic.samples(model2, n.iter = 50000, progress.bar = \"none\")\n    DIC2 <- sum(DIC2$deviance + DIC2$penalty)\n    \n    like <- rbind(samples[[1]], samples[[2]], samples[[3]], samples[[4]])\n    fbar <- colMeans(like)\n    Pw <- sum(apply(log(like), 2, var))\n    WAIC2 <- -2 * sum(log(fbar)) + 2 * Pw\n    \n    tibble(\n        model = c(\"Two lambdas\", \"One lambda\"),\n        DIC = c(DIC1, DIC2),\n        WAIC = c(WAIC1, WAIC2)\n    )\n}\n\nresults <- tibble(\n    c = c(0.1, 1, 10)\n) |> \n    mutate(\n        results = map(c, fit_model)\n    )\n\nresults |> \n    unnest(results) |> \n    mutate(\n        c = str_c(\"c = \", c)\n    ) |> \n    group_by(c) |> \n    gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"poqkuyksvg\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#poqkuyksvg table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#poqkuyksvg thead, #poqkuyksvg tbody, #poqkuyksvg tfoot, #poqkuyksvg tr, #poqkuyksvg td, #poqkuyksvg th {\n  border-style: none;\n}\n\n#poqkuyksvg p {\n  margin: 0;\n  padding: 0;\n}\n\n#poqkuyksvg .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#poqkuyksvg .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#poqkuyksvg .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#poqkuyksvg .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#poqkuyksvg .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#poqkuyksvg .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#poqkuyksvg .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#poqkuyksvg .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#poqkuyksvg .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#poqkuyksvg .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#poqkuyksvg .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#poqkuyksvg .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#poqkuyksvg .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#poqkuyksvg .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#poqkuyksvg .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#poqkuyksvg .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#poqkuyksvg .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#poqkuyksvg .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#poqkuyksvg .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#poqkuyksvg .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#poqkuyksvg .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#poqkuyksvg .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#poqkuyksvg .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#poqkuyksvg .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#poqkuyksvg .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#poqkuyksvg .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#poqkuyksvg .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#poqkuyksvg .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#poqkuyksvg .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#poqkuyksvg .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#poqkuyksvg .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#poqkuyksvg .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#poqkuyksvg .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#poqkuyksvg .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#poqkuyksvg .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#poqkuyksvg .gt_left {\n  text-align: left;\n}\n\n#poqkuyksvg .gt_center {\n  text-align: center;\n}\n\n#poqkuyksvg .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#poqkuyksvg .gt_font_normal {\n  font-weight: normal;\n}\n\n#poqkuyksvg .gt_font_bold {\n  font-weight: bold;\n}\n\n#poqkuyksvg .gt_font_italic {\n  font-style: italic;\n}\n\n#poqkuyksvg .gt_super {\n  font-size: 65%;\n}\n\n#poqkuyksvg .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#poqkuyksvg .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#poqkuyksvg .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#poqkuyksvg .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#poqkuyksvg .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#poqkuyksvg .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#poqkuyksvg .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"model\">model</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DIC\">DIC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"WAIC\">WAIC</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"3\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"c = 0.1\">c = 0.1</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"c = 0.1  model\" class=\"gt_row gt_left\">Two lambdas</td>\n<td headers=\"c = 0.1  DIC\" class=\"gt_row gt_right\">244.14329</td>\n<td headers=\"c = 0.1  WAIC\" class=\"gt_row gt_right\">246.51837</td></tr>\n    <tr><td headers=\"c = 0.1  model\" class=\"gt_row gt_left\">One lambda</td>\n<td headers=\"c = 0.1  DIC\" class=\"gt_row gt_right\">242.38127</td>\n<td headers=\"c = 0.1  WAIC\" class=\"gt_row gt_right\">243.67494</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"3\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"c = 1\">c = 1</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"c = 1  model\" class=\"gt_row gt_left\">Two lambdas</td>\n<td headers=\"c = 1  DIC\" class=\"gt_row gt_right\">16.34454</td>\n<td headers=\"c = 1  WAIC\" class=\"gt_row gt_right\">15.79799</td></tr>\n    <tr><td headers=\"c = 1  model\" class=\"gt_row gt_left\">One lambda</td>\n<td headers=\"c = 1  DIC\" class=\"gt_row gt_right\">17.44168</td>\n<td headers=\"c = 1  WAIC\" class=\"gt_row gt_right\">17.21637</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"3\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"c = 10\">c = 10</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"c = 10  model\" class=\"gt_row gt_left\">Two lambdas</td>\n<td headers=\"c = 10  DIC\" class=\"gt_row gt_right\">16.33515</td>\n<td headers=\"c = 10  WAIC\" class=\"gt_row gt_right\">15.80346</td></tr>\n    <tr><td headers=\"c = 10  model\" class=\"gt_row gt_left\">One lambda</td>\n<td headers=\"c = 10  DIC\" class=\"gt_row gt_right\">17.42901</td>\n<td headers=\"c = 10  WAIC\" class=\"gt_row gt_right\">17.28064</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n---\n\n\n# 10\n\n---\n\n**Solution:**\n\n---\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}