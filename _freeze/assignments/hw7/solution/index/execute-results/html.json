{
  "hash": "a8a341ce5c25c06a617b6ebb93be3352",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Homework #7\"\nsubtitle: \"Exercises from Chapter 5.7: 2, 4 and 10\"\ndescription: |\n    **Assigned:** Friday, October 20th, 2023 <br>\n    **Due:** Friday, November 3rd, 2023\nauthor: \n    -   name: Brynjólfur Gauti Guðrúnar Jónsson\n        email: brynjolfur@hi.is\n        url: https://www.hi.is/staff/brynjolfur\n        affiliation: \n        -   name: School of Engineering and Natural Sciences, University of Iceland\n            city: Reykjavík\n            url: https://english.hi.is/school_of_engineering_and_natural_sciences\n# Change this to pdf if you'd rather work in that format\nformat: html \neditor: source\ntitle-block-banner: true\n#### The setting below makes our HTML document self-contained so that we can turn it in ####\n#### UNCOMMENT THE LONE BELOW SO THAT YOU CAN TURN IN YOUR HTML DOCUMENT ###################\n# embed-resources: true \n---\n\n{{< downloadthis index.qmd dname=\"hw7\" label=\"Download the Quarto document used to render this file\" type=primary class=downloadbutton >}}\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| output: hide\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(rjags)\nlibrary(posterior)\nlibrary(bayesplot)\nlibrary(gt)\ntheme_set(theme_classic())\n```\n````\n:::\n\n\n# 2 \n\nDownload the `airquality` dataset in R. Fit the following model to the data\n\n$$\n\\mathrm{ozone_i} \\sim \\mathrm{Normal}(\\beta_1 + \\beta_2\\mathrm{solar.R_i} + \\beta_3\\mathrm{temp_i} + \\beta_4\\mathrm{wind_i}, \\sigma^2)\n$$\n\n---\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- na.omit(airquality)\nozone <- d$Ozone\nX <- d[ , c(\"Solar.R\", \"Wind\", \"Temp\")] |> as.matrix() |> scale()\n\ndata <- list(\n    ozone = ozone,\n    X = X,\n    n = nrow(X),\n    p = ncol(X)\n)\n\nmodel_string <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:n) {\n        ozone[i] ~ dnorm(mu[i], tau)\n        mu[i] = alpha + inprod(X[i, ], beta[])\n        Y_rep[i] ~ dnorm(mu[i], tau)\n    }\n    \n    for (i in 1:p) {\n        beta[i] ~ dnorm(0, 0.001)\n    }\n    \n    alpha ~ dnorm(0, 0.001)\n    tau ~ dgamma(0.01, 0.01)\n    sigma2 = 1 / tau;\n    \n}\")\n\nmodel <- jags.model(\n    model_string,\n    data = data,\n    n.chains = 4,\n    quiet = TRUE\n)\n\nupdate(model, 10000)\n\nparams <- c(\"alpha\", \"beta\", \"sigma2\", \"Y_rep\")\nsamples <- coda.samples(\n    model,\n    variable.names = params,\n    n.iter = 10000\n)\n\nposterior_jags <- samples |> \n    as_draws_df()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_jags |> \n    subset_draws(variable = c(\"alpha\", \"beta\", \"sigma2\")) |> \n    summarise_draws() |> \n    gt() |> \n    fmt_number()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"aumpwkvrwi\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#aumpwkvrwi table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#aumpwkvrwi thead, #aumpwkvrwi tbody, #aumpwkvrwi tfoot, #aumpwkvrwi tr, #aumpwkvrwi td, #aumpwkvrwi th {\n  border-style: none;\n}\n\n#aumpwkvrwi p {\n  margin: 0;\n  padding: 0;\n}\n\n#aumpwkvrwi .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#aumpwkvrwi .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#aumpwkvrwi .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#aumpwkvrwi .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#aumpwkvrwi .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#aumpwkvrwi .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#aumpwkvrwi .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#aumpwkvrwi .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#aumpwkvrwi .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#aumpwkvrwi .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#aumpwkvrwi .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#aumpwkvrwi .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#aumpwkvrwi .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#aumpwkvrwi .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#aumpwkvrwi .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#aumpwkvrwi .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#aumpwkvrwi .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#aumpwkvrwi .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#aumpwkvrwi .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#aumpwkvrwi .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#aumpwkvrwi .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#aumpwkvrwi .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#aumpwkvrwi .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#aumpwkvrwi .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#aumpwkvrwi .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#aumpwkvrwi .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#aumpwkvrwi .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#aumpwkvrwi .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#aumpwkvrwi .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#aumpwkvrwi .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#aumpwkvrwi .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#aumpwkvrwi .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#aumpwkvrwi .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#aumpwkvrwi .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#aumpwkvrwi .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#aumpwkvrwi .gt_left {\n  text-align: left;\n}\n\n#aumpwkvrwi .gt_center {\n  text-align: center;\n}\n\n#aumpwkvrwi .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#aumpwkvrwi .gt_font_normal {\n  font-weight: normal;\n}\n\n#aumpwkvrwi .gt_font_bold {\n  font-weight: bold;\n}\n\n#aumpwkvrwi .gt_font_italic {\n  font-style: italic;\n}\n\n#aumpwkvrwi .gt_super {\n  font-size: 65%;\n}\n\n#aumpwkvrwi .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#aumpwkvrwi .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#aumpwkvrwi .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#aumpwkvrwi .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#aumpwkvrwi .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#aumpwkvrwi .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#aumpwkvrwi .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mad\">mad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q5\">q5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q95\">q95</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rhat\">rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_bulk\">ess_bulk</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_tail\">ess_tail</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">alpha</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">41.92</td>\n<td headers=\"median\" class=\"gt_row gt_right\">41.91</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.02</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">38.60</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">45.24</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">39,444.91</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">39,044.63</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[1]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">5.45</td>\n<td headers=\"median\" class=\"gt_row gt_right\">5.44</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.11</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.09</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">1.99</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">8.93</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">33,513.67</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">37,413.72</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[2]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−11.82</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−11.81</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.34</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.32</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−15.70</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−7.99</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">24,318.56</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">31,726.24</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[3]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">15.72</td>\n<td headers=\"median\" class=\"gt_row gt_right\">15.72</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.43</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.43</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">11.72</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">19.72</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">22,613.21</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">31,380.94</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">456.66</td>\n<td headers=\"median\" class=\"gt_row gt_right\">450.98</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">63.64</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">61.42</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">362.69</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">570.81</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">37,090.44</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">38,377.83</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ny_rep <- posterior_jags |> \n    subset_draws(variable = \"Y_rep\") |> \n    resample_draws(ndraws = 200) |> \n    as_draws_matrix()\n\nppc_dens_overlay(ozone, y_rep)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nppc_stat(ozone, y_rep, stat = max)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n---\n\n# 4\n\nUse the \"Mr. October\" data. Compare the two models:\n\n![](fig1.png)\n\nusing Bayes factors, DIC and WAIC. Assume the Uniform(0, c) prior for all $\\lambda_j$ and compare the results for $c = 1$ and $c = 10$.\n\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nY <- c(563, 10)\nN <- c(2820, 27)\n\ndata <- list(\n    Y = Y,\n    N = N,\n    c = 1\n)\n\nmodel_string <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:2) {\n        Y[i] ~ dpois(N[i] * ifelse(z_0 == 1, lambda_0, lambda[i]))\n        lambda[i] ~ dunif(0, c)\n        like[i] <- dpois(Y[i], lambda[i] * N[i])\n    }\n    \n    z_0 ~ dbern(0.5)\n    lambda_0 ~ dunif(0, c)\n}\")\n\n\nmodel <- jags.model(\n    model_string,\n    data = data,\n    n.chains = 4,\n    quiet = TRUE\n)\n\nupdate(model, 10000, progress.bar = \"none\")\n\nparams <- c( \"z_0\", \"lambda\", \"lambda_0\")\nsamples <- coda.samples(\n    model,\n    variable.names = params,\n    n.iter = 10000,\n    progress.bar = \"none\"\n)\n\nsamples |> \n    summarise_draws()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 10\n  variable   mean median    sd    mad     q5   q95  rhat ess_bulk ess_tail\n  <chr>     <num>  <num> <num>  <num>  <num> <num> <num>    <num>    <num>\n1 lambda[1] 0.329  0.205 0.239 0.0210 0.127  0.880  1.05     74.9     440.\n2 lambda[2] 0.446  0.414 0.214 0.182  0.119  0.880  1.01  14225.     3663.\n3 lambda_0  0.371  0.212 0.263 0.0931 0.0871 0.914  1.03   1261.     7580.\n4 z_0       0.426  0     0.495 0      0      1      1.05    117.       NA \n```\n\n\n:::\n\n```{.r .cell-code}\n    samples |> \n    mcmc_trace()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_model <- function(c) {\n    Y <- c(563, 10)\n    N <- c(2820, 27)\n    \n    data <- list(\n        Y = Y,\n        N = N,\n        c = c\n    )\n    \n    model_string1 <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:2) {\n        Y[i] ~ dpois(N[i] * lambda[i])\n        lambda[i] ~ dunif(0, c)\n        like[i] <- dpois(Y[i], lambda[i] * N[i])\n    }\n}\")\n    \n    model_string2 <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:2) {\n        Y[i] ~ dpois(N[i] * lambda)\n        like[i] <- dpois(Y[i], lambda * N[i])\n    }\n    lambda ~ dunif(0, c)\n}\")\n    \n    model1 <- jags.model(\n        model_string1,\n        data = data,\n        n.chains = 4,\n        quiet = TRUE\n    )\n    \n    model2 <- jags.model(\n        model_string2,\n        data = data,\n        n.chains = 4,\n        quiet = TRUE\n    )\n    \n    update(model1, 10000, progress.bar = \"none\")\n    update(model2, 10000, progress.bar = \"none\")\n    \n    params <- c( \"like\")\n    samples <- coda.samples(\n        model1,\n        variable.names = params,\n        n.iter = 10000,\n        progress.bar = \"none\"\n    )\n    \n    DIC1 <- dic.samples(model1, n.iter = 50000, progress.bar = \"none\")\n    DIC1 <- sum(DIC1$deviance + DIC1$penalty)\n    \n    like <- rbind(samples[[1]], samples[[2]], samples[[3]], samples[[4]])\n    fbar <- colMeans(like)\n    Pw <- sum(apply(log(like), 2, var))\n    WAIC1 <- -2 * sum(log(fbar)) + 2 * Pw\n    \n    lpp <- \n        \n        \n        samples <- coda.samples(\n            model2,\n            variable.names = params,\n            n.iter = 10000\n        )\n    \n    DIC2 <- dic.samples(model2, n.iter = 50000, progress.bar = \"none\")\n    DIC2 <- sum(DIC2$deviance + DIC2$penalty)\n    \n    like <- rbind(samples[[1]], samples[[2]], samples[[3]], samples[[4]])\n    fbar <- colMeans(like)\n    Pw <- sum(apply(log(like), 2, var))\n    WAIC2 <- -2 * sum(log(fbar)) + 2 * Pw\n    \n    tibble(\n        model = c(\"Two lambdas\", \"One lambda\"),\n        DIC = c(DIC1, DIC2),\n        WAIC = c(WAIC1, WAIC2)\n    )\n}\n\nresults <- tibble(\n    c = c(1, 10)\n) |> \n    mutate(\n        results = map(c, fit_model)\n    )\n\nresults |> \n    unnest(results) |> \n    mutate(\n        c = str_c(\"c = \", c)\n    ) |> \n    group_by(c) |> \n    gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"cxsriaigyo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#cxsriaigyo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#cxsriaigyo thead, #cxsriaigyo tbody, #cxsriaigyo tfoot, #cxsriaigyo tr, #cxsriaigyo td, #cxsriaigyo th {\n  border-style: none;\n}\n\n#cxsriaigyo p {\n  margin: 0;\n  padding: 0;\n}\n\n#cxsriaigyo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#cxsriaigyo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#cxsriaigyo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#cxsriaigyo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#cxsriaigyo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cxsriaigyo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cxsriaigyo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cxsriaigyo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#cxsriaigyo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#cxsriaigyo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#cxsriaigyo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#cxsriaigyo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#cxsriaigyo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#cxsriaigyo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#cxsriaigyo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#cxsriaigyo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#cxsriaigyo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#cxsriaigyo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#cxsriaigyo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cxsriaigyo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#cxsriaigyo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#cxsriaigyo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#cxsriaigyo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cxsriaigyo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#cxsriaigyo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#cxsriaigyo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cxsriaigyo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cxsriaigyo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#cxsriaigyo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cxsriaigyo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#cxsriaigyo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cxsriaigyo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cxsriaigyo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cxsriaigyo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cxsriaigyo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cxsriaigyo .gt_left {\n  text-align: left;\n}\n\n#cxsriaigyo .gt_center {\n  text-align: center;\n}\n\n#cxsriaigyo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#cxsriaigyo .gt_font_normal {\n  font-weight: normal;\n}\n\n#cxsriaigyo .gt_font_bold {\n  font-weight: bold;\n}\n\n#cxsriaigyo .gt_font_italic {\n  font-style: italic;\n}\n\n#cxsriaigyo .gt_super {\n  font-size: 65%;\n}\n\n#cxsriaigyo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#cxsriaigyo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#cxsriaigyo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#cxsriaigyo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#cxsriaigyo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#cxsriaigyo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#cxsriaigyo .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"model\">model</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DIC\">DIC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"WAIC\">WAIC</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"3\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"c = 1\">c = 1</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"c = 1  model\" class=\"gt_row gt_left\">Two lambdas</td>\n<td headers=\"c = 1  DIC\" class=\"gt_row gt_right\">16.34278</td>\n<td headers=\"c = 1  WAIC\" class=\"gt_row gt_right\">15.63520</td></tr>\n    <tr><td headers=\"c = 1  model\" class=\"gt_row gt_left\">One lambda</td>\n<td headers=\"c = 1  DIC\" class=\"gt_row gt_right\">17.42441</td>\n<td headers=\"c = 1  WAIC\" class=\"gt_row gt_right\">17.22397</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"3\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"c = 10\">c = 10</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"c = 10  model\" class=\"gt_row gt_left\">Two lambdas</td>\n<td headers=\"c = 10  DIC\" class=\"gt_row gt_right\">16.35970</td>\n<td headers=\"c = 10  WAIC\" class=\"gt_row gt_right\">15.80339</td></tr>\n    <tr><td headers=\"c = 10  model\" class=\"gt_row gt_left\">One lambda</td>\n<td headers=\"c = 10  DIC\" class=\"gt_row gt_right\">17.43124</td>\n<td headers=\"c = 10  WAIC\" class=\"gt_row gt_right\">17.21943</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n---\n\n\n# 10\n\nDownload the `WWWusage` dataset in R. Using data from times $t = 5, \\dots, 100$ as outcomes, fit the autoregressive model\n\n$$\nY_t \\vert Y_{t-1}, \\dots, Y_1 \\sim \\mathrm{Normal}(\\beta_0 + \\beta_1 Y_{t-1} + \\dots + \\beta_L Y_{t-L}, \\sigma^2),\n$$\n\nwhere $Y_t$ is the WWW usage at time $t$. Compare the models with $L = 1, 2, 3, 4$ and select the best time lag L.\n\n\n---\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_ar_model <- function(L) {\n    Y <- WWWusage\n    \n    data <- list(\n        Y = Y,\n        L = L\n    )\n    \n    model_string <- textConnection(\"model{\n    #Likelihood\n    for (t in 5:100) {\n        Y[t] ~ dnorm(mu[t], tau)\n        mu[t] <- alpha + inprod(Y[(t-L):(t-1)], beta[])\n        like[t] <- dnorm(Y[t], mu[t], tau)\n    }\n    \n    for (i in 1:L) {\n        beta[i] ~ dnorm(0, 0.001)\n    }\n    \n    alpha ~ dnorm(0, 0.001)\n    tau ~ dgamma(0.01, 0.01)\n    sigma2 <- 1 / tau\n}\")\n    \n    model <- jags.model(\n        model_string,\n        data = data,\n        n.chains = 4,\n        quiet = TRUE\n    )\n    update(model, 10000, progress.bar = \"none\")\n    \n    \n    params <- c(\"like\")\n    \n    samples <- coda.samples(\n        model,\n        variable.names = params,\n        n.iter = 10000,\n        progress.bar = \"none\"\n    )\n    \n    DIC <- dic.samples(model, n.iter = 50000, progress.bar = \"none\")\n    DIC <- sum(DIC$deviance + DIC$penalty)\n    \n    like <- rbind(samples[[1]], samples[[2]], samples[[3]], samples[[4]])\n    fbar <- colMeans(like)\n    Pw <- sum(apply(log(like), 2, var))\n    WAIC <- -2 * sum(log(fbar)) + 2 * Pw\n    \n    tibble(\n        L = L,\n        DIC = DIC,\n        WAIC = WAIC\n    )\n}\n\nresults <- map_dfr(1:4, fit_ar_model)\n\nresults |>\n    gt() |> \n    fmt_number()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"nenvgfqgzr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#nenvgfqgzr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#nenvgfqgzr thead, #nenvgfqgzr tbody, #nenvgfqgzr tfoot, #nenvgfqgzr tr, #nenvgfqgzr td, #nenvgfqgzr th {\n  border-style: none;\n}\n\n#nenvgfqgzr p {\n  margin: 0;\n  padding: 0;\n}\n\n#nenvgfqgzr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#nenvgfqgzr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#nenvgfqgzr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#nenvgfqgzr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#nenvgfqgzr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nenvgfqgzr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nenvgfqgzr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nenvgfqgzr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#nenvgfqgzr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#nenvgfqgzr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#nenvgfqgzr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#nenvgfqgzr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#nenvgfqgzr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#nenvgfqgzr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#nenvgfqgzr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#nenvgfqgzr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#nenvgfqgzr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#nenvgfqgzr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#nenvgfqgzr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nenvgfqgzr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#nenvgfqgzr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#nenvgfqgzr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#nenvgfqgzr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nenvgfqgzr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#nenvgfqgzr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#nenvgfqgzr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nenvgfqgzr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nenvgfqgzr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#nenvgfqgzr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nenvgfqgzr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#nenvgfqgzr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nenvgfqgzr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nenvgfqgzr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nenvgfqgzr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nenvgfqgzr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nenvgfqgzr .gt_left {\n  text-align: left;\n}\n\n#nenvgfqgzr .gt_center {\n  text-align: center;\n}\n\n#nenvgfqgzr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#nenvgfqgzr .gt_font_normal {\n  font-weight: normal;\n}\n\n#nenvgfqgzr .gt_font_bold {\n  font-weight: bold;\n}\n\n#nenvgfqgzr .gt_font_italic {\n  font-style: italic;\n}\n\n#nenvgfqgzr .gt_super {\n  font-size: 65%;\n}\n\n#nenvgfqgzr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#nenvgfqgzr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#nenvgfqgzr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#nenvgfqgzr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#nenvgfqgzr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#nenvgfqgzr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#nenvgfqgzr .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"L\">L</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DIC\">DIC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"WAIC\">WAIC</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"L\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"DIC\" class=\"gt_row gt_right\">612.81</td>\n<td headers=\"WAIC\" class=\"gt_row gt_right\">612.37</td></tr>\n    <tr><td headers=\"L\" class=\"gt_row gt_right\">2.00</td>\n<td headers=\"DIC\" class=\"gt_row gt_right\">512.16</td>\n<td headers=\"WAIC\" class=\"gt_row gt_right\">511.98</td></tr>\n    <tr><td headers=\"L\" class=\"gt_row gt_right\">3.00</td>\n<td headers=\"DIC\" class=\"gt_row gt_right\">508.51</td>\n<td headers=\"WAIC\" class=\"gt_row gt_right\">506.52</td></tr>\n    <tr><td headers=\"L\" class=\"gt_row gt_right\">4.00</td>\n<td headers=\"DIC\" class=\"gt_row gt_right\">493.57</td>\n<td headers=\"WAIC\" class=\"gt_row gt_right\">496.12</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n---\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}