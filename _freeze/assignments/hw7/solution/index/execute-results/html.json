{
  "hash": "70e4c29faa25aebea3e5cd7006e0afab",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Homework #7 (Solution)\"\nsubtitle: \"Exercises from Chapter 5.7: 2, 4 and 10\"\ndescription: |\n    **Assigned:** Friday, October 20th, 2023 <br>\n    **Due:** Friday, November 3rd, 2023\nauthor: \n    -   name: Brynjólfur Gauti Guðrúnar Jónsson\n        email: brynjolfur@hi.is\n        url: https://www.hi.is/staff/brynjolfur\n        affiliation: \n        -   name: School of Engineering and Natural Sciences, University of Iceland\n            city: Reykjavík\n            url: https://english.hi.is/school_of_engineering_and_natural_sciences\n# Change this to pdf if you'd rather work in that format\nformat: html \neditor: source\ntitle-block-banner: true\nexecute:\n    warning: false\n    message: false\n#### The setting below makes our HTML document self-contained so that we can turn it in ####\n#### UNCOMMENT THE LONE BELOW SO THAT YOU CAN TURN IN YOUR HTML DOCUMENT ###################\n# embed-resources: true \n---\n\n{{< downloadthis index.qmd dname=\"hw7_solution\" label=\"Download the Quarto document used to render this file\" type=primary class=downloadbutton >}}\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r setup}}\n#| output: hide\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(rjags)\nlibrary(posterior)\nlibrary(bayesplot)\nlibrary(gt)\nlibrary(purrr)\nlibrary(patchwork)\nlibrary(psych, include.only = c(\"kurtosi\", \"skew\"))\ntheme_set(theme_classic())\n```\n````\n:::\n\n\n# 2 \n\nDownload the `airquality` dataset in R. Fit the following model to the data\n\n$$\n\\mathrm{ozone_i} \\sim \\mathrm{Normal}(\\beta_1 + \\beta_2\\mathrm{solar.R_i} + \\beta_3\\mathrm{temp_i} + \\beta_4\\mathrm{wind_i}, \\sigma^2)\n$$\n\nUse posterior predictive checks to verify that the model fits well. If you find model misspecification, suggest (but do not fit) alternatives.\n\n---\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- na.omit(airquality)\nozone <- d$Ozone\nX <- d[ , c(\"Solar.R\", \"Wind\", \"Temp\")] |> as.matrix() |> scale()\n\ndata <- list(\n    ozone = ozone,\n    X = X,\n    n = nrow(X),\n    p = ncol(X)\n)\n\nmodel_string <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:n) {\n        ozone[i] ~ dnorm(mu[i], tau)\n        mu[i] = alpha + inprod(X[i, ], beta[])\n        Y_rep[i] ~ dnorm(mu[i], tau)\n    }\n    \n    for (i in 1:p) {\n        beta[i] ~ dnorm(0, 0.001)\n    }\n    \n    alpha ~ dnorm(0, 0.001)\n    tau ~ dgamma(0.01, 0.01)\n    sigma2 = 1 / tau;\n    \n}\")\n\nmodel <- jags.model(\n    model_string,\n    data = data,\n    n.chains = 4,\n    quiet = TRUE\n)\n\nupdate(model, 5000)\n\nparams <- c(\"alpha\", \"beta\", \"sigma2\", \"Y_rep\")\nsamples <- coda.samples(\n    model,\n    variable.names = params,\n    n.iter = 5000\n)\n\nposterior_jags <- samples |> \n    as_draws_df()\n```\n:::\n\n\nWe first look at summary statistics and trace plots and see that our chains seem to have converged well.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_jags |> \n    subset_draws(variable = c(\"alpha\", \"beta\", \"sigma2\")) |> \n    summarise_draws() |> \n    gt() |> \n    fmt_number()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hbnwpodsdt\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hbnwpodsdt table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hbnwpodsdt thead, #hbnwpodsdt tbody, #hbnwpodsdt tfoot, #hbnwpodsdt tr, #hbnwpodsdt td, #hbnwpodsdt th {\n  border-style: none;\n}\n\n#hbnwpodsdt p {\n  margin: 0;\n  padding: 0;\n}\n\n#hbnwpodsdt .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hbnwpodsdt .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hbnwpodsdt .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hbnwpodsdt .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hbnwpodsdt .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hbnwpodsdt .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hbnwpodsdt .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hbnwpodsdt .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hbnwpodsdt .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hbnwpodsdt .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hbnwpodsdt .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hbnwpodsdt .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hbnwpodsdt .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hbnwpodsdt .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hbnwpodsdt .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hbnwpodsdt .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hbnwpodsdt .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hbnwpodsdt .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hbnwpodsdt .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hbnwpodsdt .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hbnwpodsdt .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hbnwpodsdt .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hbnwpodsdt .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hbnwpodsdt .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hbnwpodsdt .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hbnwpodsdt .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hbnwpodsdt .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hbnwpodsdt .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hbnwpodsdt .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hbnwpodsdt .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hbnwpodsdt .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hbnwpodsdt .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hbnwpodsdt .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hbnwpodsdt .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hbnwpodsdt .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hbnwpodsdt .gt_left {\n  text-align: left;\n}\n\n#hbnwpodsdt .gt_center {\n  text-align: center;\n}\n\n#hbnwpodsdt .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hbnwpodsdt .gt_font_normal {\n  font-weight: normal;\n}\n\n#hbnwpodsdt .gt_font_bold {\n  font-weight: bold;\n}\n\n#hbnwpodsdt .gt_font_italic {\n  font-style: italic;\n}\n\n#hbnwpodsdt .gt_super {\n  font-size: 65%;\n}\n\n#hbnwpodsdt .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hbnwpodsdt .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hbnwpodsdt .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hbnwpodsdt .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hbnwpodsdt .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hbnwpodsdt .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hbnwpodsdt .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"median\">median</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mad\">mad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q5\">q5</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"q95\">q95</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rhat\">rhat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_bulk\">ess_bulk</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ess_tail\">ess_tail</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">alpha</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">41.94</td>\n<td headers=\"median\" class=\"gt_row gt_right\">41.93</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.02</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.01</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">38.60</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">45.25</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">20,159.44</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">19,338.89</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[1]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">5.44</td>\n<td headers=\"median\" class=\"gt_row gt_right\">5.44</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.12</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.11</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">1.96</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">8.88</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">16,722.06</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">18,731.63</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[2]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">−11.85</td>\n<td headers=\"median\" class=\"gt_row gt_right\">−11.84</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.37</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.34</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">−15.73</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">−8.00</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">12,208.76</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">16,756.11</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">beta[3]</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">15.68</td>\n<td headers=\"median\" class=\"gt_row gt_right\">15.68</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">2.43</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">2.40</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">11.68</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">19.66</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">10,986.35</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">15,293.66</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">sigma2</td>\n<td headers=\"mean\" class=\"gt_row gt_right\">457.39</td>\n<td headers=\"median\" class=\"gt_row gt_right\">451.49</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">63.67</td>\n<td headers=\"mad\" class=\"gt_row gt_right\">61.61</td>\n<td headers=\"q5\" class=\"gt_row gt_right\">363.05</td>\n<td headers=\"q95\" class=\"gt_row gt_right\">572.01</td>\n<td headers=\"rhat\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"ess_bulk\" class=\"gt_row gt_right\">18,232.60</td>\n<td headers=\"ess_tail\" class=\"gt_row gt_right\">18,525.99</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples |> \n    mcmc_trace(\n        regex_pars = c(\"alpha\", \"beta\", \"sigma\")\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\nThen we can use the `bayesplot` package for easy posterior predictive checks. To do this we first create a matrix `y_rep` containing some of the draws from our posterior predictive distribution (PPD) we sampled using JAGS above. We choose to use only a subset of the posterior draws in order to make our plotting go faster.\n\nFirst we look at the whole distribution of our predictions and compare it to the observed distribution in our data. We notice the observed distribution is right-skewed. This does not necessarily mean we should use a non-normal likelihood. It could also mean we simply didn't capture enough of the variance in the data with the predictor variable available to us.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ny_rep <- posterior_jags |> \n    subset_draws(variable = \"Y_rep\") |> \n    resample_draws(ndraws = 200) |> \n    as_draws_matrix()\n\nppc_dens_overlay(ozone, y_rep) +\n    labs(\n        title = \"Our PPD is less skewed than the observed data\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nThe plots below tell us that the range and standard deviation of predictions are adequate but our model performs very badly on max, min, skew and kurtosis. Kurtosis is a measure of heavy the tails of a distribution is, a higher kurtosis means that the distribution has longer tails (think student-t versus normal). A large positive value of skew means that a distribution slopes longer to the right, a large negative value means it slopes longer to the right and a value of 0 means symmetry. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrange <- function(x) max(x) - min(x)\nmy_stats <- list(\"max\", \"min\", \"range\", \"sd\", \"skew\", \"kurtosi\")\nplot_gof_check <- function(check) {\n    ppc_stat(ozone, y_rep, stat = check) +\n        labs(\n            title = check\n        )\n}\n\nmy_stats |> \n    map(plot_gof_check) |> \n    wrap_plots()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nThese goodness of fit checks imply that we might need to use a likelihood that has longer tails and is positively skewed. One way to model the data in that way is to model it on the log scale (since all the observed values are > 0) and maybe using a student-t instead of a normal distribution.\n\nSuch a model might look something like this in JAGS code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_string <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:n) {\n        ##### New likelihood #####\n        ozone[i] ~ dt(mu[i], tau, k)\n        ##### Log link function ##\n        log(mu[i]) = alpha + inprod(X[i, ], beta[])\n        Y_rep[i] ~ dnorm(mu[i], tau)\n    }\n    \n    for (i in 1:p) {\n        beta[i] ~ dnorm(0, 0.001)\n    }\n    \n    alpha ~ dnorm(0, 0.001)\n    tau ~ dgamma(0.01, 0.01)\n    sigma2 = 1 / tau;\n    ##### Prior for k, the degrees of freedom ######\n    k ~ dgamma(0.01, 0.01);\n    \n}\")\n```\n:::\n\n\n---\n\n# 4\n\nUse the \"Mr. October\" data. Compare the two models:\n\n![](fig1.png)\n\nusing Bayes factors, DIC and WAIC. Assume the Uniform(0, c) prior for all $\\lambda_j$ and compare the results for $c = 1$ and $c = 10$.\n\n---\n\n\n\n\n**Solution:**\n\nThere are two ways of calculating the Bayes factors in this assignment: \n\n1. Since this is a comparison of relatively simple models we can write out the equations for $P(\\mathcal M_1 \\vert Y)$ and $P(\\mathcal M_2 \\vert Y)$\n\n$$\n\\begin{aligned}\nP(\\mathcal M_2 \\vert Y) &= \\frac{P(Y\\vert\\mathcal M_2) P(\\mathcal M_2)}{P(Y)} \\\\\n&\\propto P(Y\\vert \\mathcal M_2)P(\\mathcal M_2) \\\\\n&= P(\\mathcal M_2)\\int_0^c \\prod_{i=1}^2f(Y_i \\vert \\lambda_0)\\pi(\\lambda_0)d\\lambda_0 \\\\\n&= P(\\mathcal M_2)\\int_0^c \\prod_{i=1}^2f(Y_i \\vert \\lambda_0)\\frac{1}{c} d\\lambda_0 \\\\\n&= \\frac{1}{c}P(\\mathcal M_2)\\int_0^c \\prod_{i=1}^2 \\frac{(N_i\\lambda_0)^{Y_i}e^{-N_i\\lambda_0}}{Y_i!} d\\lambda_0 \\\\\n&= \\frac1c P(\\mathcal M_2) \\int_0^c \\frac{N_1^{Y_1}N_2^{Y_2}}{Y_1!Y_2!}\\lambda_0^{Y_1+Y_2}e^{-(N_1+N_2)\\lambda_0}d\\lambda_0 \\\\\n&= \\frac1c P(\\mathcal M_2) \\frac{N_1^{Y_1}N_2^{Y_2}}{Y_1!Y_2!}\\int_0^c \\lambda_0^{Y_1+Y_2}e^{-(N_1+N_2)\\lambda_0}d\\lambda_0 \n\\end{aligned}\n$$\n\nThis looks like the kernel of a Gamma(A, B) distribution with $A = Y_1 + Y_2 + 1$ and $B = N_1 + N_2$. \n\n$$\n\\begin{aligned}\nP(\\mathcal M_2 \\vert Y) &= \\frac1c P(\\mathcal M_2) \\frac{N_1^{Y_1}N_2^{Y_2}}{Y_1!Y_2!} \\frac{\\Gamma(A)}{B^A} \\int_0^c \\frac{B^A}{\\Gamma(A)} \\lambda_0^{A - 1}e^{-B\\lambda_0}d\\lambda_0 \\\\\n&= \\frac1c P(\\mathcal M_2) \\frac{N_1^{Y_1}N_2^{Y_2}}{Y_1!Y_2!} \\frac{(Y_1 + Y_2)!}{(N_1 + N_2)^{Y_1 + Y_2 + 1}} P(\\lambda_0 < c \\vert Y),\n\\end{aligned}\n$$\n\nwhere $\\lambda_0 \\sim \\mathrm{Gamma}(Y_1 + Y_2 + 1, N_1 + N_2)$.\n\nIn a similar way we end up getting\n\n$$\n\\begin{aligned}\nP(\\mathcal M_1 \\vert Y) &= \\frac{1}{c^2} P(\\mathcal M_1) \\frac{1}{N_1N_2} \\int_0^c \\frac{N_1^{Y_1+1}}{\\Gamma(Y_1+1)} \\lambda_1^{Y_1 + 1 - 1}e^{-N_1\\lambda_1}d\\lambda_1 \\int_0^c \\frac{N_2^{Y_2+1}}{\\Gamma(Y_2+1)} \\lambda_2^{Y_2 + 1 - 1}e^{-N_2\\lambda_2}d\\lambda_2 \\\\\n&= \\frac{1}{c^2} P(\\mathcal M_1)\\frac{1}{N_1N_2} P(\\lambda_1 < c \\vert Y) P(\\lambda_2 < c \\vert Y),\n\\end{aligned}\n$$\n\nwhere $\\lambda_1 \\sim \\mathrm{Gamma}(Y_1 + 1, N_1)$ and $\\lambda_2 \\sim \\mathrm{Gamma}(Y_2 + 1, N_2)$. Writing up the ratio of these two, we get\n\n$$\n\\begin{aligned}\nBF &= \\frac{P(Y\\vert \\mathcal M_1)}{P(Y \\vert \\mathcal M_2)} \\\\\n&= \\frac{P(\\mathcal M_1 \\vert Y) / P(\\mathcal M_1)}{P(\\mathcal M_2 \\vert Y) / P(\\mathcal M_2)} \\\\\n&= \\frac{\\frac{1}{c^2} \\frac{1}{N_1N_2} P(\\lambda_1 < c \\vert Y) P(\\lambda_2 < c \\vert Y)}{\\frac1c \\frac{N_1^{Y_1}N_2^{Y_2}}{Y_1!Y_2!} \\frac{\\Gamma(A)}{B^A} P(\\lambda_0 < c \\vert Y)} \\\\\n&= \\frac1c \\frac{Y_1!Y_2!}{N_1^{Y_1+1}N_2^{Y_2+1}} \\frac{B^A}{\\Gamma(A)} \\frac{P(\\lambda_1 < c \\vert Y) P(\\lambda_2 < c \\vert Y)}{P(\\lambda_0 < c \\vert Y)} \\\\\n&= \\frac1c \\frac{Y_1!Y_2!}{(Y_1+Y_2)!} \\frac{(N_1+N_2)^{Y_1+Y_2+1}}{N_1^{Y_1+1}N_2^{Y_2+1}} \\frac{P(\\lambda_1 < c \\vert Y) P(\\lambda_2 < c \\vert Y)}{P(\\lambda_0 < c \\vert Y)},\n\\end{aligned}\n$$\n\nwhere $\\lambda_0 \\sim \\mathrm{Gamma}(Y_1 + Y_2 + 1, N_1 + N_2)$, $\\lambda_1 \\sim \\mathrm{Gamma}(Y_1 + 1, N_1)$ and $\\lambda_2 \\sim \\mathrm{Gamma}(Y_2 + 1, N_2)$\n\nWriting this as an R function, we get\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\nbf <- function(C, Y = c(563, 10), N = c(2820, 27)) {\n    \n    out <- lfactorial(Y[1]) + lfactorial(Y[2]) - lfactorial(sum(Y))\n    out <- out + (sum(Y) + 1) * log(sum(N)) - sum((Y + 1) * log(N))\n    out <- out + pgamma(C, shape = Y[1] + 1, rate = N[1], log.p = TRUE)\n    out <- out + pgamma(C, shape = Y[2] + 1, rate = N[2], log.p = TRUE)\n    out <- out - pgamma(C, shape = sum(Y) + 1, rate = sum(N), log.p = TRUE)\n    out <- out - log(C)\n    \n    exp(out)\n}\n\nbf(C = 1)\nbf(C = 10)\n```\n````\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.397494\n[1] 0.1397724\n```\n\n\n:::\n:::\n\n\n2. The other possibility is to use JAGS to calculate the posterior probability of each model for us and then calculate the Bayes factor based on the posterior distribution. To do this, we add an auxiliary variable, $z$, to our sampler and write the two models into the same sampler as below. For each sample in our posterior where $z=1$, our sampler will sample from $\\mathcal M_2$ and otherwise sample from $\\mathcal M_2$. If our sampler converges, we can then calculate the posterior mean of $z$ as a close approximation to the Bayes factor.\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| eval: false\nmodel_string_bf <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:2) {\n        Y[i] ~ dpois(N[i] * ifelse(z == 1, lambda_0, lambda[i]))\n        lambda[i] ~ dunif(0, C)\n        like[i] <- dpois(Y[i], lambda[i] * N[i])\n    }\n    \n    z ~ dbern(0.5)\n    lambda_0 ~ dunif(0, C)\n}\")\n```\n````\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nbf_jags <- function(C, Y = c(563, 10), N = c(2820, 27)) {\n    Y <- c(563, 10)\n    N <- c(2820, 27)\n    \n    data <- list(\n        Y = Y,\n        N = N,\n        C = C\n    )\n    \n    model_string_bf <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:2) {\n        Y[i] ~ dpois(N[i] * ifelse(z == 1, lambda_0, lambda[i]))\n        lambda[i] ~ dunif(0, C)\n        like[i] <- dpois(Y[i], lambda[i] * N[i])\n    }\n    \n    z ~ dbern(0.5)\n    lambda_0 ~ dunif(0, C)\n}\")\n    \n    \n    model_bf <- jags.model(\n        model_string_bf,\n        data = data,\n        n.chains = 4,\n        quiet = TRUE\n    )\n    \n    update(model_bf, 100000, progress.bar = \"none\")\n    \n    samples_bf <- coda.samples(\n        model_bf,\n        variable.names = c(\"z\"),\n        n.iter = 100000,\n        progress.bar = \"none\"\n    )\n    \n    p_m2 <- samples_bf |> \n        as_draws_df() |> \n        subset_draws(variable = \"z\") |> \n        summarise_draws(mean) |> \n        pull(mean)\n    \n    p_m1 <- 1 - p_m2\n    \n    p_m1 / (1 - p_m1)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nfit_model <- function(C, Y = c(563, 10), N = c(2820, 27)) {\n    data <- list(\n        Y = Y,\n        N = N,\n        C = C\n    )\n    \n    model_string1 <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:2) {\n        Y[i] ~ dpois(N[i] * lambda[i])\n        lambda[i] ~ dunif(0, C)\n        like[i] <- dpois(Y[i], lambda[i] * N[i])\n    }\n}\")\n    \n    model_string2 <- textConnection(\"model{\n    #Likelihood\n    for (i in 1:2) {\n        Y[i] ~ dpois(N[i] * lambda)\n        like[i] <- dpois(Y[i], lambda * N[i])\n    }\n    lambda ~ dunif(0, C)\n}\")\n    \n    model1 <- jags.model(\n        model_string1,\n        data = data,\n        n.chains = 4,\n        quiet = TRUE\n    )\n    \n    model2 <- jags.model(\n        model_string2,\n        data = data,\n        n.chains = 4,\n        quiet = TRUE\n    )\n    \n    update(model1, 10000, progress.bar = \"none\")\n    update(model2, 10000, progress.bar = \"none\")\n    \n    params <- c( \"like\")\n    samples <- coda.samples(\n        model1,\n        variable.names = params,\n        n.iter = 10000,\n        progress.bar = \"none\"\n    )\n    \n    DIC1 <- dic.samples(model1, n.iter = 50000, progress.bar = \"none\")\n    DIC1 <- sum(DIC1$deviance + DIC1$penalty)\n    \n    like <- rbind(samples[[1]], samples[[2]], samples[[3]], samples[[4]])\n    fbar <- colMeans(like)\n    Pw <- sum(apply(log(like), 2, var))\n    WAIC1 <- -2 * sum(log(fbar)) + 2 * Pw\n    \n    \n    samples <- coda.samples(\n        model2,\n        variable.names = params,\n        n.iter = 10000,\n        progress.bar = \"none\"\n    )\n    \n    DIC2 <- dic.samples(model2, n.iter = 50000, progress.bar = \"none\")\n    DIC2 <- sum(DIC2$deviance + DIC2$penalty)\n    \n    like <- rbind(samples[[1]], samples[[2]], samples[[3]], samples[[4]])\n    fbar <- colMeans(like)\n    Pw <- sum(apply(log(like), 2, var))\n    WAIC2 <- -2 * sum(log(fbar)) + 2 * Pw\n    \n    bf <- bf_jags(C, Y, N)\n    \n    tibble(\n        model = c(\"Two lambdas\", \"One lambda\"),\n        BF = c(bf, 1 / bf),\n        DIC = c(DIC1, DIC2),\n        WAIC = c(WAIC1, WAIC2)\n    )\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nresults <- tibble(\n    C = c(1, 10)\n) |> \n    mutate(\n        results = map(C, fit_model)\n    )\n\nresults |> \n    unnest(results) |> \n    mutate(\n        C = str_c(\"c = \", C)\n    ) |> \n    group_by(C) |> \n    gt() |> \n    fmt_number(decimals = 3) |> \n    cols_label(\n        BF = \"Bayes Factor\",\n        model = \"Model\"\n    )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"gafwfjgfvt\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#gafwfjgfvt table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#gafwfjgfvt thead, #gafwfjgfvt tbody, #gafwfjgfvt tfoot, #gafwfjgfvt tr, #gafwfjgfvt td, #gafwfjgfvt th {\n  border-style: none;\n}\n\n#gafwfjgfvt p {\n  margin: 0;\n  padding: 0;\n}\n\n#gafwfjgfvt .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#gafwfjgfvt .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#gafwfjgfvt .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#gafwfjgfvt .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#gafwfjgfvt .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gafwfjgfvt .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gafwfjgfvt .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gafwfjgfvt .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#gafwfjgfvt .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#gafwfjgfvt .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#gafwfjgfvt .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#gafwfjgfvt .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#gafwfjgfvt .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#gafwfjgfvt .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#gafwfjgfvt .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#gafwfjgfvt .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#gafwfjgfvt .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#gafwfjgfvt .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#gafwfjgfvt .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gafwfjgfvt .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#gafwfjgfvt .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#gafwfjgfvt .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#gafwfjgfvt .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gafwfjgfvt .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#gafwfjgfvt .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#gafwfjgfvt .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gafwfjgfvt .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gafwfjgfvt .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#gafwfjgfvt .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gafwfjgfvt .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#gafwfjgfvt .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gafwfjgfvt .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gafwfjgfvt .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gafwfjgfvt .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gafwfjgfvt .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gafwfjgfvt .gt_left {\n  text-align: left;\n}\n\n#gafwfjgfvt .gt_center {\n  text-align: center;\n}\n\n#gafwfjgfvt .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#gafwfjgfvt .gt_font_normal {\n  font-weight: normal;\n}\n\n#gafwfjgfvt .gt_font_bold {\n  font-weight: bold;\n}\n\n#gafwfjgfvt .gt_font_italic {\n  font-style: italic;\n}\n\n#gafwfjgfvt .gt_super {\n  font-size: 65%;\n}\n\n#gafwfjgfvt .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#gafwfjgfvt .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#gafwfjgfvt .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#gafwfjgfvt .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#gafwfjgfvt .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#gafwfjgfvt .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#gafwfjgfvt .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Model\">Model</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Bayes Factor\">Bayes Factor</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DIC\">DIC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"WAIC\">WAIC</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"4\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"c = 1\">c = 1</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"c = 1  model\" class=\"gt_row gt_left\">Two lambdas</td>\n<td headers=\"c = 1  BF\" class=\"gt_row gt_right\">1.490</td>\n<td headers=\"c = 1  DIC\" class=\"gt_row gt_right\">16.323</td>\n<td headers=\"c = 1  WAIC\" class=\"gt_row gt_right\">15.742</td></tr>\n    <tr><td headers=\"c = 1  model\" class=\"gt_row gt_left\">One lambda</td>\n<td headers=\"c = 1  BF\" class=\"gt_row gt_right\">0.671</td>\n<td headers=\"c = 1  DIC\" class=\"gt_row gt_right\">17.437</td>\n<td headers=\"c = 1  WAIC\" class=\"gt_row gt_right\">17.134</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"4\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"c = 10\">c = 10</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"c = 10  model\" class=\"gt_row gt_left\">Two lambdas</td>\n<td headers=\"c = 10  BF\" class=\"gt_row gt_right\">0.159</td>\n<td headers=\"c = 10  DIC\" class=\"gt_row gt_right\">16.345</td>\n<td headers=\"c = 10  WAIC\" class=\"gt_row gt_right\">15.845</td></tr>\n    <tr><td headers=\"c = 10  model\" class=\"gt_row gt_left\">One lambda</td>\n<td headers=\"c = 10  BF\" class=\"gt_row gt_right\">6.270</td>\n<td headers=\"c = 10  DIC\" class=\"gt_row gt_right\">17.426</td>\n<td headers=\"c = 10  WAIC\" class=\"gt_row gt_right\">17.221</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# sampling_distribution <- crossing(\n#     iter = 1:500,\n#     C = c(1, 10),\n#     N = c(2820, 27),\n# ) |> \n#     mutate(\n#         Y = rpois(2, 0.2 * N),\n#         .by = c(iter, C)\n#     ) |> \n#     group_by(iter, C) |> \n#     reframe(\n#         results = fit_model(unique(C), Y, N)\n#     ) \n# \n# sampling_distribution |> write_rds(\"sampling_distribution.rds\")\n\nread_rds(\"sampling_distribution.rds\") |> \n    unnest(results) |> \n    filter(model == \"Two lambdas\") |> \n    select(iter, C, simul = BF) |> \n    inner_join(\n        results |> \n            unnest(results) |> \n            filter(model == \"Two lambdas\") |> \n            select(C, obs = BF),\n        by = join_by(C)\n    ) |> \n    mutate(\n        C = str_c(\"c = \", C)\n    ) |> \n    ggplot() +\n    geom_histogram(aes(x = simul), alpha = 0.5) +\n    geom_vline(\n        aes(xintercept = obs),\n        lty = 2,\n        linewidth = 0.5,\n        alpha = 0.5\n    ) +\n    facet_grid(cols = vars(C), scales = \"free\") +\n    labs(\n        title = \"Sampling distribution of the Bayes Factor for Model 1\",\n        subtitle = \"Calculated by sampling data from Model 2 and rerunning our analysis many times.\",\n        x = \"Distribution of simulated Bayes Factors (histogram)\\nand observed Bayes Factors (broken lines)\",\n        y = NULL\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n---\n\n\n# 10\n\nDownload the `WWWusage` dataset in R. Using data from times $t = 5, \\dots, 100$ as outcomes, fit the autoregressive model\n\n$$\nY_t \\vert Y_{t-1}, \\dots, Y_1 \\sim \\mathrm{Normal}(\\beta_0 + \\beta_1 Y_{t-1} + \\dots + \\beta_L Y_{t-L}, \\sigma^2),\n$$\n\nwhere $Y_t$ is the WWW usage at time $t$. Compare the models with $L = 1, 2, 3, 4$ and select the best time lag L.\n\n\n---\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_ar_model <- function(L) {\n    Y <- WWWusage\n    \n    data <- list(\n        Y = Y,\n        L = L\n    )\n    \n    model_string <- textConnection(\"model{\n    #Likelihood\n    for (t in 5:100) {\n        Y[t] ~ dnorm(mu[t], tau)\n        mu[t] <- alpha + inprod(Y[(t-L):(t-1)], beta[])\n        like[t] <- dnorm(Y[t], mu[t], tau)\n    }\n    \n    for (i in 1:L) {\n        beta[i] ~ dnorm(0, 0.001)\n    }\n    \n    alpha ~ dnorm(0, 0.001)\n    tau ~ dgamma(0.01, 0.01)\n    sigma2 <- 1 / tau\n}\")\n    \n    model <- jags.model(\n        model_string,\n        data = data,\n        n.chains = 4,\n        quiet = TRUE\n    )\n    update(model, 10000, progress.bar = \"none\")\n    \n    \n    params <- c(\"like\")\n    \n    samples <- coda.samples(\n        model,\n        variable.names = params,\n        n.iter = 10000,\n        progress.bar = \"none\"\n    )\n    \n    DIC <- dic.samples(model, n.iter = 50000, progress.bar = \"none\")\n    DIC <- sum(DIC$deviance + DIC$penalty)\n    \n    like <- rbind(samples[[1]], samples[[2]], samples[[3]], samples[[4]])\n    fbar <- colMeans(like)\n    Pw <- sum(apply(log(like), 2, var))\n    WAIC <- -2 * sum(log(fbar)) + 2 * Pw\n    \n    tibble(\n        L = L,\n        DIC = DIC,\n        WAIC = WAIC\n    )\n}\n\nresults <- map_dfr(1:4, fit_ar_model)\n\nresults |>\n    gt() |> \n    fmt_number()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"gahyalssmk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#gahyalssmk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#gahyalssmk thead, #gahyalssmk tbody, #gahyalssmk tfoot, #gahyalssmk tr, #gahyalssmk td, #gahyalssmk th {\n  border-style: none;\n}\n\n#gahyalssmk p {\n  margin: 0;\n  padding: 0;\n}\n\n#gahyalssmk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#gahyalssmk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#gahyalssmk .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#gahyalssmk .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#gahyalssmk .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gahyalssmk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gahyalssmk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gahyalssmk .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#gahyalssmk .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#gahyalssmk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#gahyalssmk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#gahyalssmk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#gahyalssmk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#gahyalssmk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#gahyalssmk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#gahyalssmk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#gahyalssmk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#gahyalssmk .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#gahyalssmk .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gahyalssmk .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#gahyalssmk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#gahyalssmk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#gahyalssmk .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gahyalssmk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#gahyalssmk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#gahyalssmk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gahyalssmk .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gahyalssmk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#gahyalssmk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gahyalssmk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#gahyalssmk .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gahyalssmk .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gahyalssmk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gahyalssmk .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gahyalssmk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gahyalssmk .gt_left {\n  text-align: left;\n}\n\n#gahyalssmk .gt_center {\n  text-align: center;\n}\n\n#gahyalssmk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#gahyalssmk .gt_font_normal {\n  font-weight: normal;\n}\n\n#gahyalssmk .gt_font_bold {\n  font-weight: bold;\n}\n\n#gahyalssmk .gt_font_italic {\n  font-style: italic;\n}\n\n#gahyalssmk .gt_super {\n  font-size: 65%;\n}\n\n#gahyalssmk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#gahyalssmk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#gahyalssmk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#gahyalssmk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#gahyalssmk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#gahyalssmk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#gahyalssmk .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"L\">L</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DIC\">DIC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"WAIC\">WAIC</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"L\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"DIC\" class=\"gt_row gt_right\">612.83</td>\n<td headers=\"WAIC\" class=\"gt_row gt_right\">612.40</td></tr>\n    <tr><td headers=\"L\" class=\"gt_row gt_right\">2.00</td>\n<td headers=\"DIC\" class=\"gt_row gt_right\">512.15</td>\n<td headers=\"WAIC\" class=\"gt_row gt_right\">512.02</td></tr>\n    <tr><td headers=\"L\" class=\"gt_row gt_right\">3.00</td>\n<td headers=\"DIC\" class=\"gt_row gt_right\">507.32</td>\n<td headers=\"WAIC\" class=\"gt_row gt_right\">507.45</td></tr>\n    <tr><td headers=\"L\" class=\"gt_row gt_right\">4.00</td>\n<td headers=\"DIC\" class=\"gt_row gt_right\">493.48</td>\n<td headers=\"WAIC\" class=\"gt_row gt_right\">494.46</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n---\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}