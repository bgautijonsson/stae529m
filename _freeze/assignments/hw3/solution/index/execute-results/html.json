{
  "hash": "9eb4e042b6a272ab75aff1dd171bf033",
  "result": {
    "markdown": "---\ntitle: \"Homework #3 (Solution)\"\nsubtitle: Chapters 2.1, 2.2, 2.3 and 2.4\ndescription: |\n    **Assigned:** Friday, September 8th, 2023 <br>\n    **Due:** Friday, September 15th, 2023\nauthor: \n    -   name: Brynjólfur Gauti Guðrúnar Jónsson\n        email: brynjolfur@hi.is\n        url: https://www.hi.is/staff/brynjolfur\n        affiliation: \n        -   name: School of Engineering and Natural Sciences, University of Iceland\n            city: Reykjavík\n            url: https://english.hi.is/school_of_engineering_and_natural_sciences\n# Change this to pdf if you'd rather work in that format\nformat: html \neditor: source\ntitle-block-banner: true\n#### The setting below makes our HTML document self-contained so that we can turn it in ####\n#### UNCOMMENT THE LONE BELOW SO THAT YOU CAN TURN IN YOUR HTML DOCUMENT ###################\n# embed-resources: true \n---\n\n{{< downloadthis index.qmd dname=\"hw3_solution\" label=\"Download the Quarto document used to render this file\" type=primary class=downloadbutton >}}\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| output: hide\n\nlibrary(tidyr)\nlibrary(dplyr, warn.conflicts = FALSE)\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(gt)\nlibrary(invgamma)\ntheme_set(theme_classic())\n```\n````\n:::\n\n\n# Chapter 2.4\n\n## Exercise 6\n\nAn assembly line relies on accurate measurements from an image-recognition algorithm at the first stage of the process. It is known that the algorithm is unbiased, so assume that measurements follow a normal distribution with mean zero, \n\n$$\nY_i\\vert \\sigma^2\\overset{\\mathrm{iid}}{\\sim}\\mathrm{Normal}(0, \\sigma^2).\n$$\n\nSome errors are permissible, but if $\\sigma$ exceeds the threshold $c$ then the algorithm must be replaced. \n\nYou make $n = 20$ measurements and observe \n\n$$\n\\sum_{i=1}^n Y_i = -2 \\quad \\mathrm{and} \\quad \\sum_{i=1}^n Y_i^2 = 15,\n$$ \n\nand conduct a Bayesian analysis with $\\mathrm{InvGamma}(a,b)$ prior. compute the posterior probability that $\\sigma > c$ for:\n\na. $c=1$ and $a=b=0.1$\n\n-----\n\n**Solution:**\n\nOur likelihood is\n\n$$\n\\begin{aligned}\nf(\\mathbf Y\\vert \\sigma^2) &\\propto \\prod_{i=1}^n \\frac1\\sigma \\exp\\left[-\\frac{(Y_i - \\mu)^2}{2\\sigma^2}\\right] \\\\\n&\\propto (\\sigma^2)^{-n/2}\\exp\\left(-\\frac{\\mathrm{SSE}}{2\\sigma^2}\n\\right).\n\\end{aligned}\n$$\n\nIn our case, we can write out SSE as\n\n$$\n\\begin{aligned}\n\\mathrm{SSE} &= \\sum_{i=1}^n (Y_i - \\mu)^2 \\\\\n&= \\sum_{i=1}^n Y_i^2 - 2 Y_i\\mu + \\mu^2 \\\\\n&= \\sum_{i=1}^n Y_i^2, \\quad\\quad \\mu = 0.\n\\end{aligned}\n$$\n\nOur inverse gamma prior is\n\n$$\n\\pi(\\sigma^2) \\propto (\\sigma^2)^{-(a+1)}\\exp\\left(- \\frac{b}{\\sigma^2}\\right).\n$$\n\nCombining our likelihood and prior we get the posterior\n\n$$\n\\begin{aligned}\np(\\sigma^2\\vert\\mathbf Y) &\\propto f(\\mathbf Y\\vert \\sigma^2)\\pi(\\sigma^2) \\\\\n&\\propto (\\sigma^2)^{-(A+1)}\\exp\\left(- \\frac{B}{\\sigma^2}\\right),\n\\end{aligned}\n$$\n\nwhere $A = n/2 + a$ and $B = \\mathrm{SSE}/2 + b$, and we therefore see that\n\n$$\n\\sigma^2 \\vert \\mathbf Y \\sim \\mathrm{InvGamma}(A, B).\n$$\n\nBy using the right values for $n$, SSE, $a$, $b$, and $c$ we can easily use `R`'s inbuilt `pgamma` function to answer the question. To use the `pgamma` function, we just need to remember that if \n\n$$\nX \\sim \\mathrm{Gamma}(\\alpha, \\beta),\n$$\n\nthen \n\n$$\n\\frac1X \\sim \\mathrm{InvGamma}(\\alpha, \\beta).\n$$\n\nThus, since $\\sigma^2$ is assumed to follow an inverse gamma distribution we can answer the question by calculating\n\n$$\nP\\left(\\frac1{\\sigma^2} < \\frac 1{c^2}\\right).\n$$\n\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\nn <- 20\nSSE <- 15\nc <- 1\na <- 0.1\nb <- 0.1\n\nA <- n/2 + a\nB <- SSE/2 + b\n\npgamma(1/c^2, shape = A, rate = B)\n```\n````\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2249838\n```\n:::\n:::\n\n\nWe could also use the `pinvgamma` function from the `invgamma` package\n\n\n::: {.cell}\n\n```{.r .cell-code}\n1 - pinvgamma(c^2, shape = A, rate = B)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2249838\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nplot_solution <- function(A, B, c) {\n    p1 <- ggplot() +\n        stat_function(\n            geom = \"area\",\n            fun = dinvgamma,\n            xlim = c(0, c^2),\n            args = list(shape = A, rate = B),\n            alpha = 0.4\n        ) +\n        stat_function(\n            geom = \"area\",\n            fun = dinvgamma,\n            xlim = c(c^2, qinvgamma(0.99999, shape = A, rate = B)),\n            args = list(shape = A, rate = B)\n        ) +\n        annotate(\n            geom = \"text\",\n            x = 1.1 * c^2 + 0.1,\n            y = dgamma(1/c^2, shape = A, rate = B) + 0.05,\n            label = expression(sigma^2>c^2)\n        ) +\n        coord_cartesian(expand = FALSE) +\n        labs(\n            subtitle = \"Inverse gamma\",\n            x = expression(sigma^2)\n        )\n    \n    p2 <- ggplot() +\n        stat_function(\n            geom = \"area\",\n            fun = dgamma,\n            xlim = c(0, 1/c^2),\n            args = list(shape = A, rate = B)\n        ) +\n        stat_function(\n            geom = \"area\",\n            fun = dgamma,\n            xlim = c(1/c^2, qgamma(0.99999, shape = A , rate = B)),\n            args = list(shape = A, rate = B),\n            alpha = 0.4\n        ) +\n        annotate(\n            geom = \"text\",\n            x = 1/ (c^2 * 1.3) - 0.1,\n            y = dgamma(1/c^2, shape = A, rate = B) + 0.05,\n            label = expression(frac(1,sigma^2)<frac(1,c^2))\n        ) +\n        coord_cartesian(expand = FALSE, clip = \"off\") +\n        labs(\n            subtitle = \"Gamma\",\n            x = expression(frac(1,sigma^2))\n        )\n    \n    p1 + p2 +\n        plot_annotation(\n            title = \"Comparing solutions using the Gamma or Inverse Gamma\"\n        ) &\n        theme(\n            axis.text.y = element_blank(),\n            axis.ticks.y = element_blank(),\n            axis.title.y = element_blank(),\n            axis.line.y = element_blank()\n        )\n    \n}\n\nplot_solution(A, B, c)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n-----\n\nb. $c=1$ and $a=b=1.0$\n\n-----\n\n**Solution:** \n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\nn <- 20\nSSE <- 15\nc <- 1\na <- 1\nb <- 1\n\nA <- n/2 + a\nB <- SSE/2 + b\n\npgamma(1/c^2, shape = A, rate = B)\n```\n````\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.236638\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n1 - pinvgamma(c^2, shape = A, rate = B)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.236638\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nplot_solution(A, B, c)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n-----\n\nc. $c=2$ and $a=b=0.1$\n\n-----\n\n**Solution:**\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\nn <- 20\nSSE <- 15\nc <- 2\na <- 0.1\nb <- 0.1\n\nA <- n/2 + a\nB <- SSE/2 + b\n\npgamma(1/c^2, shape = A, rate = B)\n```\n````\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.560058e-05\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n1 - pinvgamma(c^2, shape = A, rate = B)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.560058e-05\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nplot_solution(A, B, c)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n-----\n\nd. $c=2$ and $a=b=1.0$\n\n-----\n\n**Solution:**\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\nn <- 20\nSSE <- 15\nc <- 2\na <- 1\nb <- 1\n\nA <- n/2 + a\nB <- SSE/2 + b\n\npgamma(1/c^2, shape = A, rate = B)\n```\n````\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.44581e-05\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n1 - pinvgamma(c^2, shape = A, rate = B)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.44581e-05\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nplot_solution(A, B, c)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n-----\n\nFor each $c$, compute the ratio of probabilities for the two priors. Which, if any of the results are sensitive to the prior?\n\n-----\n\n**Solution:** In the table below, we compare the two choices of priors for each value of $c$. We see that the ration between the two probabilities is close to $1$ for $c=1$, so it is relatively insensitive to the priors. On the other hand the ratio is $0.56$ for $c=2$ which tells us that our inference is sensitive to the choice of prior distribution when $c=2$.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncrossing(\n    c = c(1, 2),\n    ab = c(0.1, 1)\n) |> \n    mutate(\n        A = n/2 + ab,\n        B = SSE/2 + ab,\n        prob = 1 - pinvgamma(c^2, shape = A, rate = B)\n    ) |> \n    select(c, ab, prob) |> \n    pivot_wider(names_from = ab, values_from = prob) |> \n    mutate(\n        ratio = `1` / `0.1`\n    ) |> \n    gt() |> \n    tab_spanner(\n        label = \"Probability for each prior\",\n        columns = c(`0.1`, `1`)\n    ) |> \n    cols_label(\n        `0.1` = \"a,b=0.1\",\n        `1` = \"a,b=1\"\n    ) |> \n    fmt_number(\n        decimals = 5, rows = 2\n    ) |> \n    fmt_number(\n        decimals = 3, rows = 1\n    ) |> \n    fmt_number(decimals = 0, columns = 1)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"bpbntisxwl\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#bpbntisxwl table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#bpbntisxwl thead, #bpbntisxwl tbody, #bpbntisxwl tfoot, #bpbntisxwl tr, #bpbntisxwl td, #bpbntisxwl th {\n  border-style: none;\n}\n\n#bpbntisxwl p {\n  margin: 0;\n  padding: 0;\n}\n\n#bpbntisxwl .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bpbntisxwl .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#bpbntisxwl .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bpbntisxwl .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bpbntisxwl .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bpbntisxwl .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bpbntisxwl .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bpbntisxwl .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bpbntisxwl .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bpbntisxwl .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bpbntisxwl .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bpbntisxwl .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bpbntisxwl .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#bpbntisxwl .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#bpbntisxwl .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bpbntisxwl .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bpbntisxwl .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bpbntisxwl .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bpbntisxwl .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bpbntisxwl .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bpbntisxwl .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bpbntisxwl .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#bpbntisxwl .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bpbntisxwl .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bpbntisxwl .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bpbntisxwl .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bpbntisxwl .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bpbntisxwl .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bpbntisxwl .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bpbntisxwl .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bpbntisxwl .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bpbntisxwl .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bpbntisxwl .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bpbntisxwl .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bpbntisxwl .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bpbntisxwl .gt_left {\n  text-align: left;\n}\n\n#bpbntisxwl .gt_center {\n  text-align: center;\n}\n\n#bpbntisxwl .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bpbntisxwl .gt_font_normal {\n  font-weight: normal;\n}\n\n#bpbntisxwl .gt_font_bold {\n  font-weight: bold;\n}\n\n#bpbntisxwl .gt_font_italic {\n  font-style: italic;\n}\n\n#bpbntisxwl .gt_super {\n  font-size: 65%;\n}\n\n#bpbntisxwl .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#bpbntisxwl .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bpbntisxwl .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bpbntisxwl .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bpbntisxwl .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bpbntisxwl .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bpbntisxwl .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"c\">c</th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Probability for each prior\">\n        <span class=\"gt_column_spanner\">Probability for each prior</span>\n      </th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"ratio\">ratio</th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a,b=0.1\">a,b=0.1</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a,b=1\">a,b=1</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"c\" class=\"gt_row gt_right\">1</td>\n<td headers=\"0.1\" class=\"gt_row gt_right\">0.225</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.237</td>\n<td headers=\"ratio\" class=\"gt_row gt_right\">1.052</td></tr>\n    <tr><td headers=\"c\" class=\"gt_row gt_right\">2</td>\n<td headers=\"0.1\" class=\"gt_row gt_right\">0.00003</td>\n<td headers=\"1\" class=\"gt_row gt_right\">0.00001</td>\n<td headers=\"ratio\" class=\"gt_row gt_right\">0.56476</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n---\n\n## Exercise 16\n\nSay $Y\\vert\\lambda \\sim \\mathrm{Gamma}(1, \\lambda).$\n\na. Derive and plot the Jeffreys' prior for $\\lambda$\n\n-----\n\n**Solution:** Jeffreys' prior is\n\n$$\n\\pi(\\theta) \\propto \\sqrt{I(\\theta)},\n$$\n\nwhere $I(\\theta)$ is the expected Fisher information, defined as\n\n$$\nI(\\theta) = -E\\left( \\frac{d^2\\log f(Y\\vert \\theta)}{d\\theta^2}\\right).\n$$\n\nThe PDF of the Gamma distribution can be written\n\n$$\nf(x \\vert a, b) = \\frac{b^a}{\\Gamma(a)}x^{a-1}\\exp\\left(-xb\\right).\n$$\n\nIn our case, $a=1$ and $b=\\lambda$\n\n$$\n\\begin{aligned}\nf(Y\\vert \\lambda) &= \\frac{\\lambda^1}{\\Gamma(1)}Y^0\\exp(-\\lambda Y) \\\\\n&= \\lambda \\exp(-\\lambda Y).\n\\end{aligned}\n$$\n\nTaking the log we get\n\n$$\n\\begin{aligned}\nl(Y\\vert\\theta) &=\\log f(Y\\vert\\lambda) \\\\\n&= \\log\\lambda - \\lambda Y \\\\\n\\frac{dl}{d\\lambda} &= \\frac1\\lambda - Y \\\\\n\\frac{dl^2}{d\\lambda^2} &= -\\frac{1}{\\lambda^2} \\\\\n&= -I(\\lambda).\n\\end{aligned}\n$$\n\nWe thus see that\n\n$$\n\\begin{aligned}\n\\pi(\\theta) &= \\sqrt{I(\\theta)} \\\\\n&= \\sqrt{\\frac{1}{\\lambda^2}} \\\\\n&= \\frac1\\lambda\n\\end{aligned}\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n    stat_function(\n        geom = \"area\",\n        fun = function(x) 1 / x,\n        xlim = c(0, 20),\n        col = \"black\",\n        alpha = 0.5\n    ) +\n    coord_cartesian(expand = FALSE) +\n    labs(\n        x = expression(lambda),\n        y = expression(paste(pi, \"(\", lambda, \")\"))\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n-----\n\nb. Is this prior proper?\n\n-----\n\n**Solution:** This is not a proper prior since it does not integrate to one.\n\n-----\n\nc. Derive the posterior and give conditions on $Y$ to ensure it is proper.\n\n-----\n\n**Solution:**\n\nOur posterior is\n\n$$\n\\begin{aligned}\np(\\lambda\\vert Y) &= \\frac{f(\\mathbf y\\vert \\lambda)\\pi(\\lambda)}{\\int_0^\\infty f(\\mathbf y\\vert \\lambda)\\pi(\\lambda)d\\lambda} \\\\\n&= \\frac{\\lambda \\exp(-\\lambda Y) \\cdot \\frac1\\lambda}{\\int_0^\\infty \\lambda \\exp(-\\lambda Y) \\cdot \\frac1\\lambda d\\lambda} \\\\\n&= \\frac{\\exp(-\\lambda Y)}{\\int_0^\\infty \\exp(-\\lambda Y) d\\lambda}\n\\end{aligned}\n$$\n\nThe indefinite integral of $\\exp(-\\lambda Y)$ is\n\n$$\n\\int_0^\\infty \\exp(-\\lambda Y)d\\lambda =-\\frac1Y \\exp(-\\lambda Y).\n$$\n\nIf $Y>0$, then this becomes $\\frac1Y$, giving us the posterior distribution\n\n$$\np(\\lambda\\vert Y) = Y \\exp(-Y\\lambda),\n$$\n\nwhich is proper, since we assumed that $Y>0$.\n\nIf $Y = 0$, then our posterior distribution will not integrate to one and thus will not be proper. We therefore require that $Y > 0$. Luckily $Y=0$ with probability 0 as Y is a continuous variable.\n\n-----\n\n## Exercise 18\n\nThe data in the table below are the result of a survey of commuters in 10 counties likely to be affected by a proposed addition of a high occupancy vehicle (HOV) lane.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- tribble(\n    ~County, ~Approve, ~Disapprove,\n    1, 12, 50,\n    2, 90, 150,\n    3, 80, 63,\n    4, 5, 10,\n    5, 63, 63,\n    6, 15, 8,\n    7, 67, 56,\n    8, 22, 19,\n    9, 56, 63,\n    10, 33, 19\n)\n\nd |> \n    gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"muwdrasirz\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#muwdrasirz table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#muwdrasirz thead, #muwdrasirz tbody, #muwdrasirz tfoot, #muwdrasirz tr, #muwdrasirz td, #muwdrasirz th {\n  border-style: none;\n}\n\n#muwdrasirz p {\n  margin: 0;\n  padding: 0;\n}\n\n#muwdrasirz .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#muwdrasirz .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#muwdrasirz .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#muwdrasirz .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#muwdrasirz .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#muwdrasirz .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#muwdrasirz .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#muwdrasirz .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#muwdrasirz .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#muwdrasirz .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#muwdrasirz .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#muwdrasirz .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#muwdrasirz .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#muwdrasirz .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#muwdrasirz .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#muwdrasirz .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#muwdrasirz .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#muwdrasirz .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#muwdrasirz .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#muwdrasirz .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#muwdrasirz .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#muwdrasirz .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#muwdrasirz .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#muwdrasirz .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#muwdrasirz .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#muwdrasirz .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#muwdrasirz .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#muwdrasirz .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#muwdrasirz .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#muwdrasirz .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#muwdrasirz .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#muwdrasirz .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#muwdrasirz .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#muwdrasirz .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#muwdrasirz .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#muwdrasirz .gt_left {\n  text-align: left;\n}\n\n#muwdrasirz .gt_center {\n  text-align: center;\n}\n\n#muwdrasirz .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#muwdrasirz .gt_font_normal {\n  font-weight: normal;\n}\n\n#muwdrasirz .gt_font_bold {\n  font-weight: bold;\n}\n\n#muwdrasirz .gt_font_italic {\n  font-style: italic;\n}\n\n#muwdrasirz .gt_super {\n  font-size: 65%;\n}\n\n#muwdrasirz .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#muwdrasirz .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#muwdrasirz .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#muwdrasirz .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#muwdrasirz .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#muwdrasirz .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#muwdrasirz .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"County\">County</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Approve\">Approve</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Disapprove\">Disapprove</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Approve\" class=\"gt_row gt_right\">12</td>\n<td headers=\"Disapprove\" class=\"gt_row gt_right\">50</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Approve\" class=\"gt_row gt_right\">90</td>\n<td headers=\"Disapprove\" class=\"gt_row gt_right\">150</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Approve\" class=\"gt_row gt_right\">80</td>\n<td headers=\"Disapprove\" class=\"gt_row gt_right\">63</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Approve\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Disapprove\" class=\"gt_row gt_right\">10</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Approve\" class=\"gt_row gt_right\">63</td>\n<td headers=\"Disapprove\" class=\"gt_row gt_right\">63</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Approve\" class=\"gt_row gt_right\">15</td>\n<td headers=\"Disapprove\" class=\"gt_row gt_right\">8</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Approve\" class=\"gt_row gt_right\">67</td>\n<td headers=\"Disapprove\" class=\"gt_row gt_right\">56</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">8</td>\n<td headers=\"Approve\" class=\"gt_row gt_right\">22</td>\n<td headers=\"Disapprove\" class=\"gt_row gt_right\">19</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">9</td>\n<td headers=\"Approve\" class=\"gt_row gt_right\">56</td>\n<td headers=\"Disapprove\" class=\"gt_row gt_right\">63</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">10</td>\n<td headers=\"Approve\" class=\"gt_row gt_right\">33</td>\n<td headers=\"Disapprove\" class=\"gt_row gt_right\">19</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\na. Analyze the data in each county separately using the Jeffreys' prior distribution and report the posterior 95% credible set for each county.\n\n-----\n\n**Solution:** We assume the data follow a binomial distribution\n\n$$\nf(Y\\vert p) = \\binom{N}{Y}p^Y(1-p)^{N-Y}.\n$$\n\nTo derive Jeffreys' prior we first find the expected Fisher information\n\n$$\n\\begin{aligned}\nl(Y\\vert p) &= \\log f(Y\\vert p) \\\\\n&= \\log\\binom{N}{Y} + Y\\log p + (N - Y)\\log(1 - p) \\\\\n\\frac{dl}{dp} &= \\frac Yp + \\frac{N-Y}{1-p} \\\\\n\\frac{dl^2}{dp^2} &= -\\frac{Y}{p^2} - \\frac{N - Y}{(1 - p)^2}.\n\\end{aligned}\n$$\n\nThe expected value of $Y$ is $Np$ and the expected value of $N - Y$ is $N - Np$.\n\n$$\n\\begin{aligned}\nI(p) &= \\frac{Np}{p^2} + \\frac{N - Np}{(1 - p)^2} \\\\\n&= \\frac{N}{p} + \\frac{N}{1 - p} \\\\\n&= \\frac{N}{p(1 - p)}.\n\\end{aligned}\n$$\n\nJeffreys' prior is therefore\n\n$$\n\\pi(p) \\propto \\sqrt{\\frac{n}{p(1 - p)}} \\propto p^{1/2-1}(1-p)^{1/2-1},\n$$\n\nwhich is the kernel of a $\\mathrm{Beta}(0.5, 0.5)$ PDF. We can thus see that Jeffreys' prior for a binomial proportion is a $\\mathrm{Beta}(0.5, 0.5)$ distribution, and the posterior will be a $\\mathrm{Beta}(0.5 + Y, 0.5 + (N - Y))$ distribution.\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\njeffreys_results <- d |> \n    mutate(\n        A = Approve + 0.5,\n        B = Disapprove + 0.5,\n        Lower = qbeta(0.025, A, B),\n        Upper = qbeta(0.975, A, B)\n    ) \n\njeffreys_results |> \n    gt() |> \n    cols_hide(\n        columns = c(Approve, Disapprove, A, B)\n    ) |> \n    tab_spanner(\n        label = \"95% Credible Interval\", \n        columns = c(Lower, Upper)\n    ) |> \n    fmt_percent(\n        columns = c(Lower, Upper)\n    )\n```\n````\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"bdjsuqbpqc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#bdjsuqbpqc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#bdjsuqbpqc thead, #bdjsuqbpqc tbody, #bdjsuqbpqc tfoot, #bdjsuqbpqc tr, #bdjsuqbpqc td, #bdjsuqbpqc th {\n  border-style: none;\n}\n\n#bdjsuqbpqc p {\n  margin: 0;\n  padding: 0;\n}\n\n#bdjsuqbpqc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bdjsuqbpqc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#bdjsuqbpqc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bdjsuqbpqc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bdjsuqbpqc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bdjsuqbpqc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bdjsuqbpqc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bdjsuqbpqc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bdjsuqbpqc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bdjsuqbpqc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bdjsuqbpqc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bdjsuqbpqc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bdjsuqbpqc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#bdjsuqbpqc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#bdjsuqbpqc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bdjsuqbpqc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bdjsuqbpqc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bdjsuqbpqc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bdjsuqbpqc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bdjsuqbpqc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bdjsuqbpqc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bdjsuqbpqc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#bdjsuqbpqc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bdjsuqbpqc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bdjsuqbpqc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bdjsuqbpqc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bdjsuqbpqc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bdjsuqbpqc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bdjsuqbpqc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bdjsuqbpqc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bdjsuqbpqc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bdjsuqbpqc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bdjsuqbpqc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bdjsuqbpqc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bdjsuqbpqc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bdjsuqbpqc .gt_left {\n  text-align: left;\n}\n\n#bdjsuqbpqc .gt_center {\n  text-align: center;\n}\n\n#bdjsuqbpqc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bdjsuqbpqc .gt_font_normal {\n  font-weight: normal;\n}\n\n#bdjsuqbpqc .gt_font_bold {\n  font-weight: bold;\n}\n\n#bdjsuqbpqc .gt_font_italic {\n  font-style: italic;\n}\n\n#bdjsuqbpqc .gt_super {\n  font-size: 65%;\n}\n\n#bdjsuqbpqc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#bdjsuqbpqc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bdjsuqbpqc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bdjsuqbpqc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bdjsuqbpqc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bdjsuqbpqc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bdjsuqbpqc .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"County\">County</th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"95% Credible Interval\">\n        <span class=\"gt_column_spanner\">95% Credible Interval</span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Lower\">Lower</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Upper\">Upper</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">11.04%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">30.45%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">31.55%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">43.74%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">47.76%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">63.89%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">14.03%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">58.42%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">41.35%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">58.65%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">44.89%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">81.98%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">45.65%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">63.08%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">8</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">38.58%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">68.24%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">9</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">38.25%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">56.01%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">10</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">49.93%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">75.54%</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n-----\n\nb. Let $\\hat p_i$ be the sample proportion of commuters in county $i$ that approve of the HIV lane (e.g. $\\hat p_1 = 12/(12+50)=0.194$). Select $a$ abd $b$ so that the mean and variance of the $\\mathrm{Beta}(a,b)$ distribution match the mean and variance of the sample proportions $\\hat p_1, \\dots, \\hat p_{10}$.\n\n-----\n\n**Solution:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd |> \n    mutate(\n        p = Approve / (Approve + Disapprove)\n    ) |> \n    summarise(\n        mean = mean(p),\n        var = var(p)\n    ) |> \n    gt() |> \n    cols_label(\n        mean = \"Mean\",\n        var = \"Variance\"\n    )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"kbfnfjhevt\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#kbfnfjhevt table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#kbfnfjhevt thead, #kbfnfjhevt tbody, #kbfnfjhevt tfoot, #kbfnfjhevt tr, #kbfnfjhevt td, #kbfnfjhevt th {\n  border-style: none;\n}\n\n#kbfnfjhevt p {\n  margin: 0;\n  padding: 0;\n}\n\n#kbfnfjhevt .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#kbfnfjhevt .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#kbfnfjhevt .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#kbfnfjhevt .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#kbfnfjhevt .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kbfnfjhevt .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kbfnfjhevt .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kbfnfjhevt .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#kbfnfjhevt .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#kbfnfjhevt .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#kbfnfjhevt .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#kbfnfjhevt .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#kbfnfjhevt .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#kbfnfjhevt .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#kbfnfjhevt .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#kbfnfjhevt .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#kbfnfjhevt .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#kbfnfjhevt .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#kbfnfjhevt .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kbfnfjhevt .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#kbfnfjhevt .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#kbfnfjhevt .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#kbfnfjhevt .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kbfnfjhevt .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#kbfnfjhevt .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#kbfnfjhevt .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kbfnfjhevt .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kbfnfjhevt .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#kbfnfjhevt .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kbfnfjhevt .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#kbfnfjhevt .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kbfnfjhevt .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kbfnfjhevt .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kbfnfjhevt .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kbfnfjhevt .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kbfnfjhevt .gt_left {\n  text-align: left;\n}\n\n#kbfnfjhevt .gt_center {\n  text-align: center;\n}\n\n#kbfnfjhevt .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#kbfnfjhevt .gt_font_normal {\n  font-weight: normal;\n}\n\n#kbfnfjhevt .gt_font_bold {\n  font-weight: bold;\n}\n\n#kbfnfjhevt .gt_font_italic {\n  font-style: italic;\n}\n\n#kbfnfjhevt .gt_super {\n  font-size: 65%;\n}\n\n#kbfnfjhevt .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#kbfnfjhevt .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#kbfnfjhevt .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#kbfnfjhevt .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#kbfnfjhevt .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#kbfnfjhevt .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#kbfnfjhevt .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mean\">Mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Variance\">Variance</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"mean\" class=\"gt_row gt_right\">0.4800001</td>\n<td headers=\"var\" class=\"gt_row gt_right\">0.02025887</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nSo we want the following to be approximately true\n\n$$\n\\frac{\\alpha}{\\beta} = 0.48 \\qquad \\frac{\\alpha\\beta}{(\\alpha + \\beta)^2(\\alpha + \\beta + 1)} =0.02\n$$\n\nWe can solve this simply by creating a target function and using `R`'s built-in `optim` function\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\nmy_fun <- function(pars) {\n    \n    alpha <- pars[1]\n    beta <- pars[2]\n    \n    # Calculate difference between current mean and desired mean\n    diff_mean <- alpha / (alpha + beta) - 0.48\n    \n    # Calculate difference between current variance and desired variance\n    diff_var <- (alpha * beta) / ((alpha + beta)^2 * (alpha + beta + 1)) - 0.02\n    \n    # Return the squared differences of both\n    diff_mean^2 + diff_var^2\n}\n\nresults <- optim(c(1, 1), fn = my_fun)\n\nalpha <- results$par[1]\nbeta <- results$par[2]\n\nalpha\nbeta\n```\n````\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5.51061\n[1] 5.96976\n```\n:::\n:::\n\n\n-----\n\nc. Conduct an empirical Bayesian analysis by computing the 95% posterior credible sets that results from analyzing each county separately using the $\\mathrm{Beta}(a,b)$ prior you computed in *b.*\n\n-----\n\n**Solution:**\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\nemp_bayes_results <- d |> \n    mutate(\n        A = Approve + alpha,\n        B = Disapprove + beta,\n        Lower = qbeta(0.025, A, B),\n        Upper = qbeta(0.975, A, B)\n    ) \n\nemp_bayes_results |> \n    gt() |> \n    cols_hide(\n        columns = c(Approve, Disapprove, A, B)\n    ) |> \n    tab_spanner(\n        label = \"95% Credible Interval\", \n        columns = c(Lower, Upper)\n    ) |> \n    fmt_percent(\n        columns = c(Lower, Upper)\n    )\n```\n````\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"quktxiwbod\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#quktxiwbod table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#quktxiwbod thead, #quktxiwbod tbody, #quktxiwbod tfoot, #quktxiwbod tr, #quktxiwbod td, #quktxiwbod th {\n  border-style: none;\n}\n\n#quktxiwbod p {\n  margin: 0;\n  padding: 0;\n}\n\n#quktxiwbod .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#quktxiwbod .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#quktxiwbod .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#quktxiwbod .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#quktxiwbod .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#quktxiwbod .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#quktxiwbod .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#quktxiwbod .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#quktxiwbod .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#quktxiwbod .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#quktxiwbod .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#quktxiwbod .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#quktxiwbod .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#quktxiwbod .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#quktxiwbod .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#quktxiwbod .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#quktxiwbod .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#quktxiwbod .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#quktxiwbod .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#quktxiwbod .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#quktxiwbod .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#quktxiwbod .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#quktxiwbod .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#quktxiwbod .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#quktxiwbod .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#quktxiwbod .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#quktxiwbod .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#quktxiwbod .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#quktxiwbod .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#quktxiwbod .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#quktxiwbod .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#quktxiwbod .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#quktxiwbod .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#quktxiwbod .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#quktxiwbod .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#quktxiwbod .gt_left {\n  text-align: left;\n}\n\n#quktxiwbod .gt_center {\n  text-align: center;\n}\n\n#quktxiwbod .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#quktxiwbod .gt_font_normal {\n  font-weight: normal;\n}\n\n#quktxiwbod .gt_font_bold {\n  font-weight: bold;\n}\n\n#quktxiwbod .gt_font_italic {\n  font-style: italic;\n}\n\n#quktxiwbod .gt_super {\n  font-size: 65%;\n}\n\n#quktxiwbod .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#quktxiwbod .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#quktxiwbod .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#quktxiwbod .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#quktxiwbod .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#quktxiwbod .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#quktxiwbod .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"County\">County</th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"95% Credible Interval\">\n        <span class=\"gt_column_spanner\">95% Credible Interval</span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Lower\">Lower</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Upper\">Upper</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">14.87%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">34.13%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">32.09%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">44.05%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">47.48%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">63.09%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">22.30%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">58.56%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">41.52%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">58.15%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">42.92%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">75.01%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">45.48%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">62.24%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">8</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">39.00%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">65.66%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">9</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">38.66%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">55.70%</td></tr>\n    <tr><td headers=\"County\" class=\"gt_row gt_right\">10</td>\n<td headers=\"Lower\" class=\"gt_row gt_right\">48.47%</td>\n<td headers=\"Upper\" class=\"gt_row gt_right\">72.23%</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n-----\n\nd. How do the results from *a.* and *c.* differ? What are the advantages and disadvantages of these two analyses?\n\n\n-----\n\n**Solution:** The Empirical Bayes (EB) prior pulls each individual proportion slightly towards the overall mean. Since each county gets the same EB prior the effect is that counties with fewer votes get pulled more towards the overall mean, thus stabilizing the inferences in smaller counties by *\"borrowing\"* information from other counties. \n\nThe downside to using the EB prior is that the inference for each county is slightly biased to wards the overall mean. \n\nThis is an example of the bias/variance trade-off in statistics. We often want to reduce the variance in our statistical inference at the cost of increasing the bias in our inferences.\n\n\n::: {.cell}\n\n````{.cell-code  code-fold=\"true\"}\n```{{r}}\n#| code-fold: true\n\nemp_bayes_results |> \n    mutate(\n        type = \"Empirical Bayes\"\n    ) |> \n    bind_rows(\n        jeffreys_results |> \n            mutate(\n                type = \"Jeffreys\"\n            )\n    ) |> \n    ggplot(aes(x = County, ymin = Lower, ymax = Upper, col = type)) +\n    geom_hline(\n        yintercept = 0.48,\n        lty = 2,\n        linewidth = 0.5\n    ) +\n    geom_linerange(\n        linewidth = 1,\n        position = position_dodge(width = 0.3)\n        ) +\n    scale_x_continuous(\n        breaks = 1:10\n    ) +\n    scale_y_continuous(\n        limits = c(0, 1),\n        labels = scales::label_percent(),\n        expand = expansion()\n    ) +\n    annotate(\n        geom = \"text\",\n        x = 1.5,\n        y = 0.51,\n        label = \"Overall Mean\"\n    ) +\n    theme(legend.position = c(0.15, 0.9)) +\n    labs(\n        x = \"County\",\n        y = expression(hat(p)),\n        col = NULL,\n        title = \"Comparing the Jeffreys and Empirical Bayes intervals\",\n        subtitle = \"Empirical Bayes pulls the intervalls slightly towards the overall mean\"\n    )\n```\n````\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n-----\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}